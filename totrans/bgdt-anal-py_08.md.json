["```py\n    import os\n    import pandas as pd\n    import numpy as np\n    import collections\n    from sklearn.base import TransformerMixin\n    import random\n    import pandas_profiling\n    ```", "```py\n    import seaborn as sns\n    import time\n    import re\n    import os\n    import matplotlib.pyplot as plt\n    ```", "```py\nsns.set(style=\"ticks\")\n```", "```py\n    os.chdir(\"/Users/svk/Desktop/packt_exercises\")\n    ```", "```py\n    from pyspark.sql import SparkSession\n    spark = SparkSession.builder.appName('ml-bank').getOrCreate()\n    ```", "```py\n    df_csv = spark.read.csv('bank.csv', sep=';', header = True, inferSchema = True)\n    ```", "```py\n    df_csv.printSchema()\n    ```", "```py\n    import os\n    import pandas as pd\n    import numpy as np\n    ```", "```py\n    os.chdir(\"/Users/svk/Desktop/packt_exercises\")\n    ```", "```py\n    from pyspark.sql import SparkSession\n    spark = SparkSession.builder.appName('ml-bank').getOrCreate()\n    ```", "```py\n    spark_df = spark.read.csv('bank.csv', sep=';', header = True, inferSchema = True)\n    ```", "```py\n    spark_df.head(5)\n    ```", "```py\n    spark_df.printSchema()\n    ```", "```py\n    spark_df.count()\n    ```", "```py\n    4521\n    len(spark_df.columns), spark_df.columns\n    ```", "```py\n    spark_df.describe().show()\n    ```", "```py\n    spark_df.select('balance','y').show(5)\n    ```", "```py\n    spark_df.crosstab('y', 'marital').show()\n    ```", "```py\n    # sample sets\n    sample1 = spark_df.sample(False, 0.2, 42)\n    sample2 = spark_df.sample(False, 0.2, 43)\n    # train set\n    train = spark_df.sample(False, 0.8, 44)\n    train.withColumn('balance_new', train.balance /2.0).select('balance','balance_new').show(5)\n    ```", "```py\n    train.drop('balance_new)\n    ```", "```py\n    import os\n    import pandas as pd\n    import numpy as np\n    import pyspark\n    ```", "```py\n    os.chdir(\"/Users/svk/Desktop/packt_exercises\")\n    ```", "```py\n    from pyspark.sql import SparkSession\n    spark = SparkSession.builder.appName('ml-bank').getOrCreate()\n    ```", "```py\n    spark_df = spark.read.csv('bank.csv', sep=';', header = True, inferSchema = True)\n    ```", "```py\n    spark_df.head(5)\n    ```", "```py\n    from pyspark.sql.functions import monotonically_increasing_id\n    train_with_id = spark_df.withColumn(\"ID\", monotonically_increasing_id())\n    ```", "```py\n    train_with_id = train_with_id.withColumn('ID2', train_with_id.ID)\n    ```", "```py\n    train_with_id1 = train_with_id.drop('balance', \"ID2\")\n    train_with_id2 = train_with_id.select('balance', \"ID2\")\n    ```", "```py\n    train_with_id2 = train_with_id2.withColumnRenamed(\"ID2\", \"ID\")\n    ```", "```py\n    train_merged = train_with_id1.join(train_with_id2, on=['ID'], how='left_outer')\n    ```", "```py\n    import os\n    import pandas as pd\n    import numpy as np\n    import pyspark\n    ```", "```py\n    os.chdir(\"/Users/svk/Desktop/packt_exercises\")\n    ```", "```py\n    from pyspark.sql import SparkSession\n    spark = SparkSession.builder.appName('ml-bank').getOrCreate()\n    ```", "```py\n    spark_df = spark.read.csv('bank.csv', sep=';', header = True, inferSchema = True)\n    ```", "```py\n    train_subsetted = spark_df.filter(spark_df.balance > 0.0)\n    pd.DataFrame(train_subsetted.head(5))\n    ```", "```py\n    import plotly.graph_objs as go\n    from plotly.plotly import iplot\n    import plotly as py\n    ```", "```py\n    from plotly import __version__\n    from plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot\n    print(__version__) # requires version >= 1.9.0\n    ```", "```py\n    3.7.1\n    ```", "```py\n    import plotly.plotly as py\n    import plotly.graph_objs as go\n    from plotly.plotly import iplot\n    init_notebook_mode(connected=True)\n    ```", "```py\n    plotly.tools.set_credentials_file(username='Your_Username', api_key='Your_API_Key')\n    ```"]
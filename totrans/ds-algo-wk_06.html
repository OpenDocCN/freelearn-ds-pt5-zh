<html><head></head><body><div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Regression</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Regression analysis is the process of estimating the relationship between dependent variables. For example, if a variable <em class="calibre18">y</em> is linearly dependent on variable <em class="calibre18">x</em>, then regression analysis tries to estimate the constants <em class="calibre18">a</em> and <em class="calibre18">b</em> in the equation <img class="fm-editor-equation145" src="Images/2dccd9f3-8947-4b52-80fd-556c55181b55.png" width="850" height="200"/>, which  expresses the linear relationship between the variables <em class="calibre18">y</em> and <em class="calibre18">x</em>.</p>
<p class="mce-root">In this chapter, you will learn about the following topics:</p>
<ul class="calibre14">
<li class="calibre15">The core idea of regression by performing a simple linear regression on the perfect data from first principles in a Fahrenheit and Celsius conversion <span class="calibre4">example </span></li>
<li class="calibre15">Performing linear regression analysis by using the <strong class="calibre3">least squares method</strong> from the  <kbd class="calibre17">scipy.linalg</kbd> Python library on perfect and real-world data in the examples of Fahrenheit and Celsius conversion, weight prediction based on height, and flight time duration prediction based on distance</li>
<li class="calibre15">The <em class="calibre5">gradient descent algorithm</em> in order to find a regression model with the best fit (using the least mean squares rule) and how to implement it in Python</li>
<li class="calibre15">The establishment of a non-linear regression model using the least squares method in a ballistic flight analysis example and <em class="calibre5">Problem 4</em>, <em class="calibre5">Bacteria population prediction</em></li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Fahrenheit and Celsius conversion – linear regression on perfect data</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Fahrenheit and Celsius degrees are related in a linear way. Given a table with pairs of both Fahrenheit and Celsius degrees, we can estimate the constants to devise a conversion formula from degrees Fahrenheit to degrees Celsius, or vice versa:</p>
<table class="msotablegrid" border="1">
<tbody class="calibre23">
<tr class="calibre24">
<td class="calibre53">
<p class="calibre26"><strong class="calibre8">⁰F</strong></p>
</td>
<td class="calibre54">
<p class="calibre26"><strong class="calibre8">⁰C</strong></p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre53">
<p class="calibre26">5</p>
</td>
<td class="calibre54">
<p class="calibre26">-15</p>
</td>
</tr>
<tr class="calibre24">
<td class="calibre53">
<p class="calibre26">14</p>
</td>
<td class="calibre54">
<p class="calibre26">-10</p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre53">
<p class="calibre26">23</p>
</td>
<td class="calibre54">
<p class="calibre26">-5</p>
</td>
</tr>
<tr class="calibre24">
<td class="calibre53">
<p class="calibre26">32</p>
</td>
<td class="calibre54">
<p class="calibre26">0</p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre53">
<p class="calibre26">41</p>
</td>
<td class="calibre54">
<p class="calibre26">5</p>
</td>
</tr>
<tr class="calibre28">
<td class="calibre53">
<p class="calibre26">50</p>
</td>
<td class="calibre54">
<p class="calibre26">10</p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Analysis from first principles</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">We would like to derive a formula for converting <em class="calibre18">F</em> (degrees Fahrenheit) to <em class="calibre18">C</em> (degrees Celsius), as follows:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation146" src="Images/e6e06d66-a0f6-4acb-a168-3765aae8af12.png" width="1110" height="170"/></p>
<p class="mce-root">Here, <em class="calibre18">a</em> and <em class="calibre18">b</em> are the constants to be found. A graph of the <img class="fm-editor-equation147" src="Images/0f020fdd-0b0c-4ebc-9bee-9800243b9137.png" width="1110" height="170"/> function is a straight line and, thus, is uniquely determined by two points. Therefore, we actually only need two points from the table, say, pairs <em class="calibre18">(F1,C1)</em> and <em class="calibre18">(F2,C2)</em>. Then, we will have the following:</p>
<p class="mce-root"><img class="fm-editor-equation148" src="Images/86fac300-c064-4ed7-833e-34ee03a495e3.png" width="1250" height="190"/></p>
<p class="mce-root"><img class="fm-editor-equation148" src="Images/f738c092-095b-47bf-8d7f-38aebf40d624.png" width="1250" height="190"/></p>
<p class="mce-root">Now, we have the following:</p>
<p class="cdpaligncenter"> <img class="fm-editor-equation149" src="Images/b1bcf1b4-439f-459c-8d45-a352ea779f93.png" width="4300" height="220"/><span class="calibre9">.</span></p>
<p class="mce-root">Therefore, we have the following:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation150" src="Images/aebfa86b-a45d-4776-bead-fd0025af9103.png" width="2030" height="220"/></p>
<p class="cdpaligncenter"><img class="fm-editor-equation151" src="Images/0f1f0522-7709-49ad-8167-dade292c58c1.png" width="3730" height="220"/></p>
<p class="mce-root">Here, let's take the first two pairs <em class="calibre18">(F1,C1)</em>=<em class="calibre18">(5,-15)</em> and <em class="calibre18">(F2,C2)</em>=<em class="calibre18">(14,-10)</em>. This will give us the following:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation152" src="Images/d51f112b-dcfc-4cb1-9985-f4df4527229b.png" width="2680" height="410"/></p>
<p class="cdpaligncenter"><img class="fm-editor-equation153" src="Images/e3897e5c-fb72-4d97-8ed2-4bb06a4f3d15.png" width="2050" height="410"/></p>
<p class="mce-root">Therefore, the formula to calculate degrees Celsius from degrees Fahrenheit is as follows:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation154" src="Images/1fb314f6-9c9c-4b51-be2d-0940486a49a4.png" width="3500" height="410"/></p>
<p class="mce-root">Let's verify this against the data in the table:</p>
<table class="msotablegrid" border="1">
<tbody class="calibre23">
<tr class="calibre24">
<td class="calibre55">
<p class="calibre26"><strong class="calibre8">⁰F</strong></p>
</td>
<td class="calibre56">
<p class="calibre26"><strong class="calibre8">⁰C</strong></p>
</td>
<td class="calibre57">
<p class="calibre26"><strong class="calibre8">(5/9)*F-160/9</strong></p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre55">
<p class="calibre26">5</p>
</td>
<td class="calibre56">
<p class="calibre26">-15</p>
</td>
<td class="calibre57">
<p class="calibre26">-15</p>
</td>
</tr>
<tr class="calibre24">
<td class="calibre55">
<p class="calibre26">14</p>
</td>
<td class="calibre56">
<p class="calibre26">-10</p>
</td>
<td class="calibre57">
<p class="calibre26">-10</p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre55">
<p class="calibre26">23</p>
</td>
<td class="calibre56">
<p class="calibre26">-5</p>
</td>
<td class="calibre57">
<p class="calibre26">-5</p>
</td>
</tr>
<tr class="calibre24">
<td class="calibre55">
<p class="calibre26">32</p>
</td>
<td class="calibre56">
<p class="calibre26">0</p>
</td>
<td class="calibre57">
<p class="calibre26">0</p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre55">
<p class="calibre26">41</p>
</td>
<td class="calibre56">
<p class="calibre26">5</p>
</td>
<td class="calibre57">
<p class="calibre26">5</p>
</td>
</tr>
<tr class="calibre28">
<td class="calibre55">
<p class="calibre26">50</p>
</td>
<td class="calibre56">
<p class="calibre26">10</p>
</td>
<td class="calibre57">
<p class="calibre26">10</p>
</td>
</tr>
</tbody>
</table>
<p class="mce-root"> </p>
<p class="mce-root">We can see that the formula fits 100% of our input data. The data we worked with was perfect. In later examples, we will see that the formula that we derive doesn't fit the data perfectly. The aim will be to derive a formula that fits the data best so that the difference between the prediction and the actual data is minimized.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Least squares method for linear regression</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Given the input variables <img class="fm-editor-equation155" src="Images/e769f8d4-6c54-43f0-ae05-5eb65ed63e8c.png" width="810" height="140"/><span class="calibre9"> </span>and the output variables <img class="fm-editor-equation156" src="Images/c2ad0f17-b24e-4e95-a031-f404790f46db.png" width="690" height="160"/>,<span class="calibre9"> </span>we would like to find the variables a and b so that <img class="fm-editor-equation157" src="Images/ce5eac9f-5402-4186-8a36-a99bafc0a3e3.png" width="1150" height="200"/> for every value of <em class="calibre18">i</em> from 1 to <em class="calibre18">n</em>. If the data is perfect, this is possible. In real-world data, we want <em class="calibre18">y<sub class="calibre29">i</sub></em> to be as close to <img class="fm-editor-equation158" src="Images/c1e305eb-fbf2-40b1-9f18-d0c9d0a02b90.png" width="750" height="190"/> as possible instead; that is, we want to minimize the absolute value of <img class="fm-editor-equation159" src="Images/7e6b02b2-3444-4227-96f5-9bcb8a55f5c6.png" width="1130" height="200"/><span class="calibre9">. For one specific term, this is equivalent to minimizing  <img class="fm-editor-equation160" src="Images/b54cd9ca-24f3-4bd8-b937-8924134ab6b8.png" width="1360" height="240"/>.</span></p>
<p class="mce-root"><span class="calibre9">A square function instead of an absolute value is often used, as it has more desirable mathematical properties.</span></p>
<p class="mce-root">The least squares method finds a and b so that the following term, called <strong class="calibre8">error</strong>, is minimized:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation161" src="Images/f95f7aee-f91e-47d6-acc1-867aa8cf3e5a.png" width="2530" height="540"/></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Analysis using the least squares method in Python</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">We use the <kbd class="calibre17">lstsq</kbd> least squares method from the <kbd class="calibre17">scipy.linalg</kbd> <span class="calibre9">Python library </span>to calculate the linear dependence relation between the degrees Celsius and degrees Fahrenheit <span class="calibre9">variables</span>.</p>
<p class="mce-root">The <kbd class="calibre17">lstsq</kbd> function is used as <kbd class="calibre17">lstsq(M,y)</kbd>, where <em class="calibre18">M</em> is a matrix of <kbd class="calibre17">M = x[:, np.newaxis]**[0, 1]</kbd>, constructed from the input vector <em class="calibre18">x</em>, and <em class="calibre18">y</em> is the output vector. In other words, <em class="calibre18">y</em> is the variable that's dependent on <em class="calibre18">x</em>.</p>
<p class="mce-root"><strong class="calibre8">Input</strong>:</p>
<pre class="calibre22"><strong class="calibre3"># source_code/6/fahrenheit_celsius.py</strong><br class="calibre2"/>import numpy as np<br class="calibre2"/>from scipy.linalg import lstsq<br class="calibre2"/><br class="calibre2"/>#temperature data<br class="calibre2"/>fahrenheit = np.array([5,14,23,32,41,50])<br class="calibre2"/>celsius = np.array([-15,-10,-5,0,5,10])<br class="calibre2"/><br class="calibre2"/>M = fahrenheit[:, np.newaxis]**[0, 1]<br class="calibre2"/>model, _, _, _ = lstsq(M,celsius)<br class="calibre2"/>print "Intercept =", model[0]<br class="calibre2"/>print "fahrenheit =", model[1] </pre>
<p class="mce-root"><strong class="calibre8">Output</strong>:</p>
<pre class="calibre22"><strong class="calibre3">$ python fahrenheit_celsius.py<br class="calibre2"/></strong>Intercept = -17.777777777777782<br class="calibre2"/>fahrenheit = 0.5555555555555558</pre>
<p class="mce-root">Therefore, we can see the following approximate linear dependence relation between <em class="calibre18">C</em> (degrees Celsius) and <em class="calibre18">F</em> (degrees Fahrenheit):</p>
<p class="cdpaligncenter"><img class="fm-editor-equation162" src="Images/3ae7bcce-d2d6-4dde-99a5-66fe0fc31168.png" width="4530" height="200"/></p>
<p class="mce-root">Note that this corresponds to our previous calculation.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Visualization</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Here is the linear model for predicting degrees Celsius from degrees Fahrenheit via a linear line. Its meaning is that point <em class="calibre18">(F,C)</em> is on the green line if, and only if, <em class="calibre18">F</em> converts to <em class="calibre18">C</em> and vice versa:</p>
<p class="cdpaligncenter"><img class="alignnone16" src="Images/f88d19e6-3645-44d5-a5f2-8220e567b5d1.png" width="725" height="572"/></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Weight prediction from height – linear regression on real-world data</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Here, we are predicting the weight of a man from his height by using linear regression on the following data:</p>
<table class="msotablegrid" border="1">
<tbody class="calibre23">
<tr class="calibre24">
<td class="calibre25">
<p class="calibre26"><strong class="calibre8">Height in cm</strong></p>
</td>
<td class="calibre25">
<p class="calibre26"><strong class="calibre8">Weight in kg</strong></p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre25">
<p class="calibre26">180</p>
</td>
<td class="calibre25">
<p class="calibre26">75</p>
</td>
</tr>
<tr class="calibre24">
<td class="calibre25">
<p class="calibre26">174</p>
</td>
<td class="calibre25">
<p class="calibre26">71</p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre25">
<p class="calibre26">184</p>
</td>
<td class="calibre25">
<p class="calibre26">83</p>
</td>
</tr>
<tr class="calibre24">
<td class="calibre25">
<p class="calibre26">168</p>
</td>
<td class="calibre25">
<p class="calibre26">63</p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre25">
<p class="calibre26">178</p>
</td>
<td class="calibre25">
<p class="calibre26">70</p>
</td>
</tr>
<tr class="calibre28">
<td class="calibre25">
<p class="calibre26">172</p>
</td>
<td class="calibre25">
<p class="calibre26">?</p>
</td>
</tr>
</tbody>
</table>
<p class="mce-root"> </p>
<p class="mce-root">We would like to estimate the weight of a man given that his height is 172 cm.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Analysis</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In the previous example of Fahrenheit and Celsius conversion, the data fitted the linear model perfectly. Thus, we could perform even a simple mathematical analysis (solving basic equations) to gain the conversion formula. Most data in the real world does not fit a model perfectly. For such an analysis, it would be good to find a model that fits the given data with minimal errors. We can use the least squares method to find such a linear model.</p>
<p class="mce-root"><strong class="calibre8">Input</strong>:</p>
<p class="mce-root">We put the data from the preceding table into the vectors and try to fit the linear model:</p>
<pre class="calibre22"><strong class="calibre3"># source_code/6/weight_prediction.py</strong><br class="calibre2"/>import numpy as np<br class="calibre2"/>from scipy.linalg import lstsq<br class="calibre2"/><br class="calibre2"/>height = np.array([180,174,184,168,178])<br class="calibre2"/>weight = np.array([75,71,83,63,70])<br class="calibre2"/><br class="calibre2"/>M = height[:, np.newaxis]**[0, 1]<br class="calibre2"/>model, _, _, _ = lstsq(M,weight)<br class="calibre2"/>print "Intercept =", model[0]<br class="calibre2"/>print "height coefficient =", model[1] </pre>
<p class="mce-root"><strong class="calibre8">Output</strong>:</p>
<pre class="calibre22"><strong class="calibre3">$ python weight_prediction.py<br class="calibre2"/></strong>Intercept = -127.68817204301082<br class="calibre2"/>height coefficient = 1.1317204301075274</pre>
<p class="mce-root">Thus, the formula expressing the linear relationship between weight and height is as follows:  <img class="fm-editor-equation163" src="Images/81cec6b9-0970-4ad3-b255-304c7f8c1399.png" width="2750" height="200"/></p>
<p class="mce-root">Therefore, we estimate that a man with a height of 172 cm would have a weight of <img class="fm-editor-equation164" src="Images/579661d9-3e22-4898-ac48-e45e1e769ff9.png" width="2670" height="200"/>.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Gradient descent algorithm and its implementation</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">To understand how we may be able to predict a value by using linear regression from first principles in an even better way, we need to study the gradient descent algorithm and then implement it in Python.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Gradient descent algorithm</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">A gradient descent algorithm is an iterative algorithm that updates the variables in the model to fit the data, making as few errors as possible. More generally, it finds the minimum of a function.</p>
<p class="mce-root">We would like to express the weight in terms of height by using a linear formula:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation165" src="Images/35d1b776-24ea-4b9f-a743-c1055652655c.png" width="2920" height="220"/></p>
<p class="cdpalignleft1">We estimate the parameter,  <img class="fm-editor-equation166" src="Images/ab3c0555-5e0e-47b7-b37d-46fa6859b84d.png" width="930" height="220"/>, using <em class="calibre18">n</em> data samples <img class="fm-editor-equation167" src="Images/1340e2f8-9993-4f60-a81c-1b5d3238f829.png" width="1420" height="220"/> to minimize the following square error:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation168" src="Images/c65b1094-e420-4ff0-bd8c-c3ef34a5f831.png" width="3570" height="540"/></p>
<p class="mce-root">The gradient descent algorithm does this by updating the <em class="calibre18">p<sub class="calibre29">i</sub></em> parameter in the direction of <em class="calibre18">(∂/∂ p<sub class="calibre29">j</sub>) E(p)</em>, in particular:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation169" src="Images/3074ea29-31f0-44ac-90f1-9021e283b8c4.png" width="3010" height="470"/></p>
<p class="mce-root">Here, <em class="calibre18">learning_rate</em> determines that the speed of the convergence of <em class="calibre18">E(p)</em> is at the minimum. Updating the <em class="calibre18">p</em> parameter will result in the convergence of <em class="calibre18">E(p)</em> to a certain value, providing that <em class="calibre18">learning_rate</em> is sufficiently small. In the Python program, we use a <em class="calibre18">learning_rate</em> of 0.000001. However, the drawback of this update rule is that the minimum of <em class="calibre18">E(p)</em> may only be a local minimum.</p>
<p class="mce-root">To update the <em class="calibre18">p</em> <span class="calibre9">parameter </span>programmatically, we need to unfold the partial derivative on <em class="calibre18">E(p)</em>. Therefore, we update the <em class="calibre18">p</em> parameter as follows:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation170" src="Images/26a3025a-d100-4c83-b85b-33b58699e68b.png" width="4890" height="540"/></p>
<p class="cdpaligncenter"><img class="fm-editor-equation171" src="Images/f3ad7ca4-f5c3-4d2a-bed2-95f42780acfa.png" width="5790" height="540"/></p>
<p class="mce-root">We will keep updating the <em class="calibre18">p</em> parameter until it changes only very slightly; that is, until the change in both <em class="calibre18">p<sub class="calibre29">0</sub></em> and <em class="calibre18">p<sub class="calibre29">1</sub></em> is less than some constant <em class="calibre18">acceptable_error</em>. Once the <em class="calibre18">p</em> parameter stabilizes, we can use it to estimate the weight from the height.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Implementation</h1>
                </header>
            
            <article class="calibre2">
                
<pre class="calibre22"><strong class="calibre3"># source_code/6/regression.py</strong><br class="calibre2"/># Linear regression program to learn a basic linear model.<br class="calibre2"/>import math<br class="calibre2"/>import sys<br class="calibre2"/>sys.path.append('../common')<br class="calibre2"/>import common # noqa<br class="calibre2"/><br class="calibre2"/># Calculate the gradient by which the parameter should be updated.<br class="calibre2"/><strong class="calibre3">def linear_gradient(data, old_parameter):</strong><br class="calibre2"/>    gradient = [0.0, 0.0]<br class="calibre2"/>    for (x, y) in data:<br class="calibre2"/>        term = float(y) - old_parameter[0] - old_parameter[1] * float(x)<br class="calibre2"/>        gradient[0] += term<br class="calibre2"/>        gradient[1] += term * float(x)<br class="calibre2"/>    return gradient<br class="calibre2"/><br class="calibre2"/># This function will apply gradient descent algorithm<br class="calibre2"/># to learn the linear model.<br class="calibre2"/><strong class="calibre3">def learn_linear_parameter(data, learning_rate,</strong><br class="calibre2"/><strong class="calibre3">                           acceptable_error, LIMIT):</strong><br class="calibre2"/>    parameter = [1.0, 1.0]<br class="calibre2"/>    old_parameter = [1.0, 1.0]<br class="calibre2"/>    for i in range(0, LIMIT):<br class="calibre2"/>        gradient = linear_gradient(data, old_parameter)<br class="calibre2"/>        # Update the parameter with the Least Mean Squares rule.<br class="calibre2"/>        parameter[0] = old_parameter[0] + learning_rate * gradient[0]<br class="calibre2"/>        parameter[1] = old_parameter[1] + learning_rate * gradient[1]<br class="calibre2"/>        # Calculate the error between the two parameters to compare with<br class="calibre2"/>        # the permissible error in order to determine if the calculation<br class="calibre2"/>        # is sufficiently accurate.<br class="calibre2"/>        if abs(parameter[0] - old_parameter[0]) &lt;= acceptable_error<br class="calibre2"/>        and abs(parameter[1] - old_parameter[1]) &lt;= acceptable_error:<br class="calibre2"/>            return parameter<br class="calibre2"/>        old_parameter[0] = parameter[0]<br class="calibre2"/>        old_parameter[1] = parameter[1]<br class="calibre2"/>    return parameter<br class="calibre2"/><br class="calibre2"/># Calculate the y coordinate based on the linear model predicted.<br class="calibre2"/><strong class="calibre3">def predict_unknown(data, linear_parameter):</strong><br class="calibre2"/>    for (x, y) in data:<br class="calibre2"/>        print(x, linear_parameter[0] + linear_parameter[1] * float(x))<br class="calibre2"/><br class="calibre2"/><strong class="calibre3"># Program start</strong><br class="calibre2"/>csv_file_name = sys.argv[1]<br class="calibre2"/># The maximum number of the iterations in the batch learning algorithm.<br class="calibre2"/>LIMIT = 100<br class="calibre2"/># Suitable parameters chosen for the problem given.<br class="calibre2"/>learning_rate = 0.0000001<br class="calibre2"/>acceptable_error = 0.001<br class="calibre2"/><br class="calibre2"/>(heading, complete_data, incomplete_data,<br class="calibre2"/> enquired_column) = common.csv_file_to_ordered_data(csv_file_name)<br class="calibre2"/>linear_parameter = learn_linear_parameter(<br class="calibre2"/>    complete_data, learning_rate, acceptable_error, LIMIT)<br class="calibre2"/>print("Linear model:\n(p0,p1)=" + str(linear_parameter) + "\n")<br class="calibre2"/>print("Unknowns based on the linear model:")<br class="calibre2"/>predict_unknown(incomplete_data, linear_parameter)</pre>
<p class="mce-root"><strong class="calibre8">Input</strong>:</p>
<p class="mce-root">We use the data from the table in the preceding example <em class="calibre18">Weight prediction from height</em> and save it in a CSV file:</p>
<pre class="calibre22"><strong class="calibre3"># source_code/6/height_weight.csv</strong><br class="calibre2"/>height,weight<br class="calibre2"/>180,75 
174,71 
184,83 
168,63 
178,70 
172,? </pre>
<p class="mce-root"><strong class="calibre8">Output</strong>:</p>
<pre class="calibre22"><strong class="calibre3">$ python regression.py height_weight.csv<br class="calibre2"/></strong>Linear model:
(p0,p1)=[0.9966468959362077, 0.4096393414704317]
<br class="calibre2"/>Unknowns based on the linear model:
('172', 71.45461362885045)  </pre>
<p class="mce-root">The output for the linear model means that the weight can be expressed in terms of the height as follows:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation68" src="Images/c3a1c56e-580e-4ae1-a1b0-ee064eee9af0.png" width="4990" height="200"/></p>
<p class="mce-root">Therefore, a man with a height of 172 cm is predicted to weigh the following:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation172" src="Images/95a4a9a7-0ef4-4b4d-a4b3-3c89b657d68d.png" width="6480" height="200"/></p>
<p class="mce-root">Note that this prediction of 71.455 kg is slightly different from the prediction of 67.016 kg achieved when using the least squares method. This may be due to the fact that the Python gradient descent algorithm found only a local minimum in the prediction.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Visualization – comparison of the least squares method and the gradient descent algorithm</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">By using weight prediction based on height, we can visualize the linear prediction models of the least squares method and of the gradient descent algorithm that are implemented in Python as follows:</p>
<p class="cdpaligncenter"><img class="alignnone17" src="Images/42ccbc48-8a35-4e86-b4db-d9e3e57050c9.png" width="716" height="563"/></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Flight time duration prediction based on distance</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">Given a table of flights with their origin, destination, and flight time, we would like to estimate the length of a proposed flight from Bratislava, Slovakia, to Amsterdam, the Netherlands:</p>
<table class="msotablegrid" border="1">
<tbody class="calibre23">
<tr class="calibre24">
<td class="calibre25">
<p class="calibre26"><strong class="calibre8">Origin</strong></p>
</td>
<td class="calibre25">
<p class="calibre26"><strong class="calibre8">Destination</strong></p>
</td>
<td class="calibre25">
<p class="calibre26"><strong class="calibre8">Distance in km</strong></p>
</td>
<td class="calibre25">
<p class="calibre26"><strong class="calibre8">Flight duration</strong></p>
</td>
<td class="calibre25">
<p class="calibre26"><strong class="calibre8">Flight duration in hours</strong></p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre25">
<p class="calibre26">London</p>
</td>
<td class="calibre25">
<p class="calibre26">Amsterdam</p>
</td>
<td class="calibre25">
<p class="calibre26">365</p>
</td>
<td class="calibre25">
<p class="calibre26">1 hr 10 m</p>
</td>
<td class="calibre25">
<p class="calibre26">1.167</p>
</td>
</tr>
<tr class="calibre24">
<td class="calibre25">
<p class="calibre26">London</p>
</td>
<td class="calibre25">
<p class="calibre26">Budapest</p>
</td>
<td class="calibre25">
<p class="calibre26">1462</p>
</td>
<td class="calibre25">
<p class="calibre26">2 hr 20 m</p>
</td>
<td class="calibre25">
<p class="calibre26">2.333</p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre25">
<p class="calibre26">London</p>
</td>
<td class="calibre25">
<p class="calibre26">Bratislava</p>
</td>
<td class="calibre25">
<p class="calibre26">1285</p>
</td>
<td class="calibre25">
<p class="calibre26">2 hr 15 m</p>
</td>
<td class="calibre25">
<p class="calibre26">2.250</p>
</td>
</tr>
<tr class="calibre24">
<td class="calibre25">
<p class="calibre26">Bratislava</p>
</td>
<td class="calibre25">
<p class="calibre26">Paris</p>
</td>
<td class="calibre25">
<p class="calibre26">1096</p>
</td>
<td class="calibre25">
<p class="calibre26">2 hr 5 m</p>
</td>
<td class="calibre25">
<p class="calibre26">2.083</p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre25">
<p class="calibre26">Bratislava</p>
</td>
<td class="calibre25">
<p class="calibre26">Berlin</p>
</td>
<td class="calibre25">
<p class="calibre26">517</p>
</td>
<td class="calibre25">
<p class="calibre26">1 hr 15 m</p>
</td>
<td class="calibre25">
<p class="calibre26">2.250</p>
</td>
</tr>
<tr class="calibre24">
<td class="calibre25">
<p class="calibre26">Vienna</p>
</td>
<td class="calibre25">
<p class="calibre26">Dublin</p>
</td>
<td class="calibre25">
<p class="calibre26">1686</p>
</td>
<td class="calibre25">
<p class="calibre26">2 hr 50 m</p>
</td>
<td class="calibre25">
<p class="calibre26">2.833</p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre25">
<p class="calibre26">Vienna</p>
</td>
<td class="calibre25">
<p class="calibre26">Amsterdam</p>
</td>
<td class="calibre25">
<p class="calibre26">932</p>
</td>
<td class="calibre25">
<p class="calibre26">1 hr 55 m</p>
</td>
<td class="calibre25">
<p class="calibre26">1.917</p>
</td>
</tr>
<tr class="calibre24">
<td class="calibre25">
<p class="calibre26">Amsterdam</p>
</td>
<td class="calibre25">
<p class="calibre26">Budapest</p>
</td>
<td class="calibre25">
<p class="calibre26">1160</p>
</td>
<td class="calibre25">
<p class="calibre26">2 hr 10 m</p>
</td>
<td class="calibre25">
<p class="calibre26">2.167</p>
</td>
</tr>
<tr class="calibre33">
<td class="calibre25">
<p class="calibre26">Bratislava</p>
</td>
<td class="calibre25">
<p class="calibre26">Amsterdam</p>
</td>
<td class="calibre25">
<p class="calibre26">978</p>
</td>
<td class="calibre25">
<p class="calibre26">?</p>
</td>
<td class="calibre25">
<p class="calibre26">?</p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Analysis</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">We can reason that the flight duration time consists of two times—the first is the time to take off and the landing time; the second is the time that the airplane moves at a certain speed in the air. The first time is a constant. The second time depends linearly on the speed of the plane, which we assume is similar for all of the flights in the table. Therefore, the flight time can be expressed by using a linear formula in terms of the flight distance.</p>
<p class="mce-root"><strong class="calibre8">Input</strong>:</p>
<pre class="calibre22"><strong class="calibre3">source_code/6/flight_time.py
</strong>import numpy as np<br class="calibre2"/>from scipy.linalg import lstsq<br class="calibre2"/><br class="calibre2"/>distance = np.array([365,1462,1285,1096,517,1686,932,1160])<br class="calibre2"/>time = np.array([1.167,2.333,2.250,2.083,2.250,2.833,1.917,2.167])<br class="calibre2"/><br class="calibre2"/>M = distance[:, np.newaxis]**[0, 1]<br class="calibre2"/>model, _, _, _ = lstsq(M,time)<br class="calibre2"/>print "Intercept =", model[0]<br class="calibre2"/>print "distance coefficient =", model[1]</pre>
<p class="mce-root"><strong class="calibre8">Output</strong>:</p>
<pre class="calibre22"><strong class="calibre3">$ python flight_time.py<br class="calibre2"/></strong>Intercept = 1.2335890147536381<br class="calibre2"/>distance coefficient = 0.0008386790405704925</pre>
<p class="mce-root">According to linear regression, the time between takeoff and landing for an average flight is about 1.2335890 hours. To travel 1 km with the plane takes 0.0008387 hours; in other words, the speed of an airplane is 1,192 km per hour. The actual usual speed of an airplane for short-distance flights, like the ones in the preceding table, is about 850 km per hour. This leaves room for improvement in our estimation (refer to <em class="calibre18">Problem 3</em>).</p>
<p class="mce-root">Therefore, we derived the following formula:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation173" src="Images/ec93fd1d-dfbb-413d-8a23-5883d8de657a.png" width="4440" height="200"/></p>
<p class="mce-root">Using this, we estimate that the flight from Bratislava to Amsterdam, with a distance of 978 km, would take about <em class="calibre18">0.0008387*978 + 1.2335890=2.0538376</em> hours, or about 2 hours and 3 minutes, which is a little longer than from Vienna to Amsterdam (1 hr 55 m), and a little shorter than from Budapest to Amsterdam (2 hr 10 m).</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Ballistic flight analysis – non-linear model</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">An interplanetary spaceship lands on a planet with a negligible atmosphere and fires three projectiles carrying exploratory bots at the planet, but at different initial velocities. After the bots land on the surface, their distances are measured and the data is recorded, as follows:</p>
<table border="1" class="msotablegrid">
<tbody class="calibre23">
<tr class="calibre24">
<td class="calibre25">
<p class="calibre26"><strong class="calibre8">Velocity in m/s</strong></p>
</td>
<td class="calibre25">
<p class="calibre26"><strong class="calibre8">Distance in m</strong></p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre25">
<p class="calibre26">400</p>
</td>
<td class="calibre25">
<p class="calibre26">38,098</p>
</td>
</tr>
<tr class="calibre24">
<td class="calibre25">
<p class="calibre26">600</p>
</td>
<td class="calibre25">
<p class="calibre26">85,692</p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre25">
<p class="calibre26">800</p>
</td>
<td class="calibre25">
<p class="calibre26">152,220</p>
</td>
</tr>
<tr class="calibre28">
<td class="calibre25">
<p class="calibre26">?</p>
</td>
<td class="calibre25">
<p class="calibre26">300,000</p>
</td>
</tr>
</tbody>
</table>
<p class="mce-root"> </p>
<p class="mce-root">At what speed should the projectile carrying the fourth bot be fired in order for it to land 300 km from the spacecraft?</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Analysis</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">For this problem, we need to understand the trajectory of the projectile. Since the atmosphere on the planet is weak, the trajectory is almost equivalent to the ballistic curve without any air drag. The distance, <em class="calibre18">d</em>, traveled by an object fired from a point on the ground, neglecting the curvature of the planet's surface, is given <span class="calibre9">approximately </span>by the following equation:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation174" src="Images/c6236e1c-1fa2-4ae6-95f7-e00ab9bda0db.png" width="1620" height="240"/></p>
<p class="mce-root">Where <em class="calibre18">v</em> is the initial velocity of the object, τ is the angle at which the object was fired, and <em class="calibre18">g</em> is the gravitational force exerted by the planet on the object. Note that the angle, <em class="calibre18">τ</em>, and the gravitational force, <em class="calibre18">g</em>, do not change. Therefore, you can define a constant as <img src="Images/60fa7b3a-76a6-4093-aaf4-7667d2a191d8.png" width="557" height="84" class="calibre58"/>. This means that the distance traveled on the explored planet can be explained in terms of velocity by the following equation:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation175" src="Images/c739c20b-599b-436e-912d-77af2d0b48b8.png" width="780" height="190"/></p>
<p class="mce-root">Although <em class="calibre18">d</em> and <em class="calibre18">v</em> are not in a linear relationship, <em class="calibre18">d</em> and the square of <em class="calibre18">v</em> are. Therefore, we can still apply linear regression to determine the relationship between <em class="calibre18">d</em> and <em class="calibre18">v</em>.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Analysis by using the least squares method in Python</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root"><strong class="calibre8">Input</strong>:</p>
<pre class="calibre22"><strong class="calibre3">source_code/6/speed_distance.py
</strong>import numpy as np<br class="calibre2"/>from scipy.linalg import lstsq<br class="calibre2"/><br class="calibre2"/>distance = np.array([38098, 85692, 152220])<br class="calibre2"/>squared_speed = np.array([160000,360000,640000])<br class="calibre2"/><br class="calibre2"/>M = distance[:, np.newaxis]**[0, 1]<br class="calibre2"/>model, _, _, _ = lstsq(M,squared_speed)<br class="calibre2"/>print "Intercept =", model[0]<br class="calibre2"/>print "distance coefficient =", model[1]</pre>
<p class="mce-root"><strong class="calibre8">Output</strong>:</p>
<pre class="calibre22"><strong class="calibre3">$ python speed_distance.py 
</strong>Intercept = -317.7078806050511<br class="calibre2"/>distance coefficient = 4.206199498720391</pre>
<p class="mce-root">Therefore, the relationship between the squared velocity and the distance is predicted by the regression as follows:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation176" src="Images/6d3bed92-2f2c-4346-a7c9-e81992170df2.png" width="1960" height="190"/></p>
<p class="mce-root">The presence of the intercept term may be caused by errors in the measurements, or by other forces in the equation. Since it is relatively small, the final velocity should be estimated reasonably well. Adding the distance of 300 km into the equation, we get the following:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation177" src="Images/e835a7fc-168f-4465-806f-88237f5f322e.png" width="3650" height="180"/></p>
<div class="cdpaligncenter1"><img class="fm-editor-equation178" src="Images/0e3161f3-da46-4f98-9279-893ea26b801a.png" width="1040" height="160"/></div>
<p class="mce-root">Therefore, for the projectile to reach 300 km from the source, we need to fire it at a speed of approximately 1123.157 m/s.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root">In this chapter, we learned about regression analysis. We can think of variables as being dependent on each other in a functional way. For example, the <em class="calibre18">y</em><span class="calibre9"> variable </span>is a function of<span class="calibre9"> </span><em class="calibre18">x</em><span class="calibre9"> </span>denoted by<span class="calibre9"> </span><em class="calibre18">y=f(x)</em>. The <em class="calibre18">f(x)</em><span class="calibre9"> function </span>has constant parameters. If<span class="calibre9"> </span><em class="calibre18">y</em><span class="calibre9"> </span>depends on<span class="calibre9"> </span><em class="calibre18">x</em><span class="calibre9"> </span>linearly, then<span class="calibre9"> </span><em class="calibre18">f(x)=a*x+b</em>, where<span class="calibre9"> </span><em class="calibre18">a</em><span class="calibre9"> </span>and<span class="calibre9"> </span><em class="calibre18">b</em><span class="calibre9"> </span>are constant parameters in the<span class="calibre9"> </span><em class="calibre18">f(x)</em> function.</p>
<p class="mce-root">We saw that regression is a method to estimate these constant parameters in such a way that the estimated <em class="calibre18">f(x)</em> follows <em class="calibre18">y</em> as closely as possible. This is formally measured by the squared error between<span class="calibre9"> </span><em class="calibre18">f(x)</em><span class="calibre9"> </span>and<span class="calibre9"> </span><em class="calibre18">y</em><span class="calibre9"> </span>for<span class="calibre9"> </span><em class="calibre18">x</em> data samples.</p>
<p class="mce-root">We also covered the gradient descent method, which minimizes this error by updating the constant parameters in the direction of the steepest descent (that is, the partial derivative of the error), ensuring that the parameters converge to the values resulting in minimal errors in the quickest possible way.</p>
<p class="mce-root">Finally, we learned about the <kbd class="calibre17">scipy.linalg</kbd> <span class="calibre9">Python libra</span><span class="calibre9">ry which</span> supports the estimation of linear regression using the <kbd class="calibre17">lstsq</kbd> <span class="calibre9">function</span> based on the least squares method.</p>
<p class="mce-root">In the next chapter, you will apply regression analysis to the analysis of time-dependent data.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Problems</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root"><strong class="calibre8">Problem 1: Cloud storage prediction cost</strong>: Our software application generates data on a monthly basis and stores this data in cloud storage, together with the data from the previous months. We are given the following bills for cloud storage, and would like to estimate the running costs for the first year of using it:</p>
<table class="msotablegrid" border="1">
<tbody class="calibre23">
<tr class="calibre24">
<td class="calibre59">
<p class="calibre26"><strong class="calibre8">Months using cloud storage</strong></p>
</td>
<td class="calibre60">
<p class="calibre26"><strong class="calibre8">Monthly bill in euros</strong></p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre59">
<p class="calibre26">1</p>
</td>
<td class="calibre60">
<p class="calibre26">120.00</p>
</td>
</tr>
<tr class="calibre24">
<td class="calibre59">
<p class="calibre26">2</p>
</td>
<td class="calibre60">
<p class="calibre26">131.20</p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre59">
<p class="calibre26">3</p>
</td>
<td class="calibre60">
<p class="calibre26">142.10</p>
</td>
</tr>
<tr class="calibre24">
<td class="calibre59">
<p class="calibre26">4</p>
</td>
<td class="calibre60">
<p class="calibre26">152.90</p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre59">
<p class="calibre26">5</p>
</td>
<td class="calibre60">
<p class="calibre26">164.30</p>
</td>
</tr>
<tr class="calibre28">
<td class="calibre59">
<p class="calibre26">1 to 12</p>
</td>
<td class="calibre60">
<p class="calibre26">?</p>
</td>
</tr>
</tbody>
</table>
<p class="mce-root"> </p>
<p class="mce-root"><strong class="calibre8">Problem 2: Fahrenheit and Celsius conversion</strong><span class="calibre9">: In the example that we looked at earlier in this chapter, we devised a formula for converting degrees Fahrenheit to degrees Celsius. Devise a formula converting degrees Celsius into degrees Fahrenheit.</span></p>
<p class="mce-root"><strong class="calibre8">Problem 3: Flight time duration prediction based on distance</strong>: <span class="calibre9">Why do you think that a linear regression model resulted in an estimation of the speed of 1,192 km/h, as opposed to the real speed of about 850 km/h? Can you suggest a way to better model the estimation of the flight duration based on flight distances and times?</span></p>
<p class="mce-root"><strong class="calibre8">Problem 4: Bacteria population prediction</strong>: A bact<span class="calibre9">eria, Escherichia coli, has been observed in the laboratory, and the size of its population was estimated by various measurements at 5-minute intervals, as follows:</span></p>
<table border="1" class="msotablegrid">
<tbody class="calibre23">
<tr class="calibre24">
<td class="calibre61">
<p class="calibre26"><strong class="calibre8"><span class="calibre9">Time</span></strong></p>
</td>
<td class="calibre62">
<p class="calibre26"><strong class="calibre8"><span class="calibre9">Size of population in millions</span></strong></p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre61">
<p class="calibre26"><span class="calibre9">10:00</span></p>
</td>
<td class="calibre62">
<p class="calibre26"><span class="calibre9">47.5</span></p>
</td>
</tr>
<tr class="calibre24">
<td class="calibre61">
<p class="calibre26"><span class="calibre9">10:05</span></p>
</td>
<td class="calibre62">
<p class="calibre26"><span class="calibre9">56.5</span></p>
</td>
</tr>
<tr class="calibre27">
<td class="calibre61">
<p class="calibre26"><span class="calibre9">10:10</span></p>
</td>
<td class="calibre62">
<p class="calibre26"><span class="calibre9">67.2</span></p>
</td>
</tr>
<tr class="calibre24">
<td class="calibre61">
<p class="calibre26"><span class="calibre9">10:15</span></p>
</td>
<td class="calibre62">
<p class="calibre26"><span class="calibre9">79.9</span></p>
</td>
</tr>
<tr class="calibre33">
<td class="calibre61">
<p class="calibre26"><span class="calibre9">11:00</span></p>
</td>
<td class="calibre62">
<p class="calibre26"><span class="calibre9">?</span></p>
</td>
</tr>
</tbody>
</table>
<p class="mce-root"> </p>
<p class="mce-root"><span class="calibre9"><span class="calibre9"><span class="calibre9"><span class="calibre9">What is the expected number of bacteria at 11:00, assuming that the bacteria continues to grow at the same rate?</span></span></span></span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content" class="calibre1"><section class="calibre2">

                            <header class="calibre2">
                    <h1 class="header-title">Analysis</h1>
                </header>
            
            <article class="calibre2">
                
<p class="mce-root"><strong class="calibre8">Problem 1</strong>: Every month, we have to pay for the data we have stored in the cloud thus far, plus the new data that is added in that month. We will use linear regression to predict the cost for a general month, and then we will calculate the sum of the first 12 months to calculate the cost for the whole year.</p>
<p class="mce-root"><strong class="calibre8">Input</strong>:</p>
<pre class="calibre22"><strong class="calibre3">source_code/6/cloud_storage.py</strong><br class="calibre2"/>import numpy as np<br class="calibre2"/>from scipy.linalg import lstsq<br class="calibre2"/><br class="calibre2"/>month = np.array([1,2,3,4,5])<br class="calibre2"/>bill = np.array([120.0,131.2,142.1,152.9,164.3])<br class="calibre2"/><br class="calibre2"/>M = month[:, np.newaxis]**[0, 1]<br class="calibre2"/>model, _, _, _ = lstsq(M,bill)<br class="calibre2"/>print "Intercept =", model[0]<br class="calibre2"/>print "month_data =", model[1]</pre>
<p class="mce-root"><strong class="calibre8">Output</strong>:</p>
<pre class="calibre22"><strong class="calibre3">$ python cloud_storage.py<br class="calibre2"/></strong>Intercept = 109.00999999999992<br class="calibre2"/>month_data = 11.030000000000008</pre>
<p class="mce-root">This means that the base cost is <em class="calibre18">base_cost</em>=<em class="calibre18">109.01</em> euros, and then to store the data added in 1 month costs an additional <em class="calibre18">month_data</em>=<em class="calibre18">11.03</em> euros. Therefore, the formula for the <em class="calibre18">n</em><sup class="calibre30">th</sup> monthly bill is as follows:</p>
<p class="mce-root"><img class="fm-editor-equation179" src="Images/17aec100-d2ec-4d1d-9150-bc3be72b6c1d.png" width="8020" height="200"/></p>
<p class="mce-root">Remember that the sum of the first <em class="calibre18">n</em> numbers is <img class="fm-editor-equation180" src="Images/f1df1b67-7715-418a-b818-2acfe72ebb63.png" width="1460" height="220"/>. Thus, the cost for the first <em class="calibre18">n</em> months will be as follows:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation181" src="Images/91de9956-7eb5-4a19-be32-f76d7769b26a.png" width="6030" height="220"/></p>
<p class="cdpaligncenter"><img class="fm-editor-equation182" src="Images/62a1df79-5c3d-4778-9865-4a79243fe601.png" width="3990" height="220"/></p>
<p class="cdpaligncenter"><img class="fm-editor-equation183" src="Images/0d6e8440-a175-4c8a-be88-b39814a308c3.png" width="3110" height="220"/></p>
<p class="cdpaligncenter"><img class="fm-editor-equation184" src="Images/84b305f3-61ed-4281-a942-20f7bf60044c.png" width="2130" height="220"/></p>
<p class="mce-root">For the whole year, the cost will be as follows:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation185" src="Images/c2e56ce0-ad26-4d20-9bba-fb2afcaaddf0.png" width="5430" height="220"/></p>
<p class="mce-root"><strong class="calibre8">Visualization</strong></p>
<ol class="calibre20">
<li class="chapter">In the following graph, we can observe the linearity of the model, which is represented by the blue line. On the other hand, the sum of the points on the linear line is quadratic in nature and is represented by the area beneath the line:</li>
</ol>
<p class="cdpaligncenter"><img class="alignnone18" src="Images/7b1e2ef5-6302-42ed-b800-e1a51869f8b9.png" width="725" height="568"/></p>
<p class="mce-root"><strong class="calibre8">Problem 2</strong>: There are many ways to obtain the formula for converting degrees Celsius into degrees Fahrenheit. We could use the least squares method and, from the initial Python file, take the following lines:</p>
<p class="mce-root"><em class="calibre18">M = fahrenheit[:, np.newaxis]**[0, 1]</em><br class="calibre10"/>
<em class="calibre18">model, _, _, _ = lstsq(M,celsius)</em></p>
<p class="mce-root">We then change them to the following:</p>
<p class="mce-root"><em class="calibre18">M = celsius[:, np.newaxis]**[0, 1]</em><br class="calibre10"/>
<em class="calibre18">model, _, _, _ = lstsq(M,fahrenheit)</em></p>
<p class="mce-root">Then, we would obtain the desired reversed model:</p>
<pre class="calibre22">Intercept = 32.000000000000014<br class="calibre2"/>celsius = 1.7999999999999998</pre>
<p class="mce-root">Therefore, degrees Fahrenheit can be expressed from degrees Celsius as follows:</p>
<p class="mce-root"><img class="fm-editor-equation186" src="Images/2ce39eee-b0db-4233-b64c-7017908266d5.png" width="1350" height="170"/></p>
<p class="mce-root">Alternatively, we may obtain the preceding formula by modifying the following one:</p>
<p class="mce-root"><img class="fm-editor-equation187" src="Images/692d4fcd-e9db-4ff6-9dba-f31ae315a8c3.png" width="1820" height="220"/></p>
<p class="mce-root"><img class="fm-editor-equation188" src="Images/33408aea-deeb-49a1-ba72-b42e9dd5b3fb.png" width="1820" height="220"/></p>
<p class="mce-root"><img class="fm-editor-equation189" src="Images/80aceb80-491b-4cee-bdb0-a363cba685c0.png" width="1570" height="170"/></p>
<p class="mce-root"><strong class="calibre8">Problem 3</strong>: The estimated speed is so high because even flights over a short distance take quite a long time; for example, the flight from London to Amsterdam, where the distance between the two cities is only 365 km, takes about 1.167 hours. But, on the other hand, if the distance changes only slightly, then the flight time changes only slightly as well. This results in us estimating a very long initial setup time. Consequently, the speed has to be very fast because there is only a small amount of time left to travel a certain distance.</p>
<p class="mce-root">If we consider very long flights, where the initial setup time to flight time ratio is much smaller, we could predict the flight speed more accurately.</p>
<p class="mce-root"><span class="calibre9"><strong class="calibre8">Problem 4</strong></span>: The number o<span class="calibre9">f bacteria at the 5-minute intervals is 47.5, 56.5, 67.2, and 79.9 million. The differences between these numbers are 9, 10.7, and 12.7. The sequence is increasing. Therefore, we need to look at the ratios of the neighbor terms to see how the sequence grows: 56.5/47.5=1.18947, 67.2/56.5=1.18938, and 79.9/67.2=1.18899. The ratios of the successive terms are close to each other, so we have reason to believe that the number of bacteria in the growing population can be estimated by using the exponential distribution of the model:</span></p>
<p class="cdpaligncenter"><img class="fm-editor-equation190" src="Images/f690933f-84aa-4f42-9cd5-bb9f2493cbf9.png" width="1080" height="170"/></p>
<p class="mce-root">Where <em class="calibre18">n</em> is the number of bacteria in millions, <em class="calibre18">b</em> is a constant (the base), the letter <em class="calibre18">m</em> is the exponent expressing the number of minutes since 10:00, which was the time of the first measurement, and 47.7 is the number of bacteria at that time in millions.</p>
<p class="mce-root">To estimate the constant, <em class="calibre18">b</em>, we use the ratios between the sequence terms. We know that <em class="calibre18">b<sup class="calibre30">5</sup></em> is approximately <em class="calibre18">(56.5/47.5 + 67.2/56.5 + 79.9/67.2)/3=1.18928</em>. Therefore, the constant, <em class="calibre18">b</em>, is approximately <em class="calibre18">b=1.18928<sup class="calibre30">1/5</sup>=1.03528</em>. Thus, the number of bacteria in millions is as follows:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation191" src="Images/d7a4c750-dfdd-46ec-a922-af4ac8ab4ec0.png" width="1610" height="170"/></p>
<p class="mce-root">At 11:00, which is 60 minutes later than 10:00, the estimated number of bacteria is as follows:</p>
<p class="cdpaligncenter"><img class="fm-editor-equation192" src="Images/f26cd4e6-3dad-4109-9fd8-c182cf9c30bf.png" width="4480" height="190"/><br class="calibre10"/>
<br class="calibre10"/>
  </p>


            </article>

            
        </section>
    </div>



  </body></html>
<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Jupyter R Scripting</h1>
                </header>
            
            <article>
                
<p>Jupyter's native language is Python. Once Jupyter (which was essentially IPython before being renamed) became popular for data analysis, a number of people were interested in using the suite of R programming analysis tools that are available in Jupyter Notebook.</p>
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li> Adding R scripting to your installation</li>
<li> Basic R scripting</li>
<li> R dataset access (from a library)</li>
<li> R graphics</li>
<li> R cluster analysis</li>
<li> R forecasting</li>
<li> R predictions</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding R scripting to your installation</h1>
                </header>
            
            <article>
                
<p>Two big installation platforms are macOS and Windows. There are separate but similar steps for making R scripting available in your Jupyter installation.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding R scripts to Jupyter on macOS</h1>
                </header>
            
            <article>
                
<p>If you are operating on macOS, you can add R Scripting using the following command:</p>
<pre><strong>conda install -c r r-essentials</strong> </pre>
<p>This will start off with a large installation of the R environment, which contains a number of common packages:</p>
<pre><strong>bos-mpdc7:~ dtoomey$ conda install -c r r-essentials</strong> 
<strong>Fetching package metadata: ......</strong> 
<strong>Solving package specifications: .........</strong> 
 
<strong>Package plan for installation in environment /Users/dtoomey/miniconda3:</strong> </pre>
<p>The following packages will be downloaded:</p>
<pre><strong>    package                    |            build</strong> 
<strong>    ---------------------------|-----------------</strong> 
<strong>    jbig-2.1                   |                0          31 KB</strong> 
<strong>    jpeg-8d                    |                2         210 KB</strong> 
<strong>    libgcc-4.8.5               |                1         785 KB</strong> 
<strong>... &lt;&lt;many packages&gt;&gt;</strong> 
<strong>    r-caret-6.0_62             |        r3.2.2_0a         4.3 MB</strong> 
<strong>    r-essentials-1.1           |        r3.2.2_1a          726 B</strong> 
<strong>    ------------------------------------------------------------</strong> 
<strong>                                           Total:       101.0 MB</strong> </pre>
<p><span>The following <span class="ItalicsPACKT">new</span> packages will be <span class="ItalicsPACKT">installed</span>:</span></p>
<pre><strong>    jbig:           2.1-0              </strong> 
<strong>    jpeg:           8d-2  </strong> 
<strong>... &lt;&lt;many packages&gt;&gt;</strong> 
<strong>    r-xts:          0.9_7-r3.2.2_0a    </strong> 
<strong>    r-yaml:         2.1.13-r3.2.2_1a   </strong> 
<strong>    r-zoo:          1.7_12-r3.2.2_1a   </strong> 
<strong>    zeromq:         4.1.3-0            </strong> 
 
<strong>Proceed ([y]/n)? y</strong> 
 
<strong>Fetching packages ...</strong> 
<strong>jbig-2.1-0.tar 100% |################################| Time: 0:00:00   1.59 MB/s</strong> 
<strong>jpeg-8d-2.tar. 100% |################################| Time: 0:00:00   2.69 MB/s</strong> 
<strong>... &lt;&lt;many packages&gt;&gt;</strong> 
<strong>r-caret-6.0_62 100% |################################| Time: 0:00:00  11.16 MB/s</strong> 
<strong>r-essentials-1 100% |################################| Time: 0:00:00 537.43 kB/s</strong> 
<strong>Extracting packages ...</strong> 
<strong>[      COMPLETE      ]|###################################################| 100%</strong> 
<strong>Linking packages ...</strong> 
<strong>[      COMPLETE      ]|###################################################| 100%</strong> </pre>
<p>From there, you will invoke your <kbd>notebook</kbd> as you normally would:</p>
<pre><strong>ipython notebook</strong> </pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding R scripts to Jupyter on Windows</h1>
                </header>
            
            <article>
                
<p>The default installation for Anaconda does not include R—I'm not sure why. Once Anaconda is installed, you need to specially install it using the command line. Then, we will take the plunge and add R scripting, which is very similar to what we did for macOS:</p>
<pre><strong>conda install -c r notebook r-irkernel</strong> </pre>
<p>This produces a detailed view of the packages that are updated. In my case, it installed a full set of R packages and runtimes, even though I had used R elsewhere on the machine earlier:</p>
<pre><strong>C:\Users\Dan&gt;conda install -c r notebook r-irkernel</strong><br/><strong>Solving environment: done</strong><br/><strong>==&gt; WARNING: A newer version of conda exists. &lt;==</strong><br/><strong>current version: 4.4.10</strong><br/><strong>latest version: 4.5.4</strong><br/><strong>Please update conda by running</strong><br/><strong>$ conda update -n base conda</strong><br/><strong>## Package Plan ##</strong><br/><strong>environment location: C:\Users\Dan\Anaconda3</strong><br/><strong>added / updated specs:</strong><br/><strong>- notebook</strong><br/><strong>- r-irkernel<br/></strong><strong>The following packages will be downloaded:<br/>package | build</strong><br/><strong>-------------------|-----------------r-pbdzmq-0.2_6 | mro343h889e2dd_0 4.2 MB r</strong><br/><strong>libxml2-2.9.8 | vc14_0 3.2 MB conda-forge</strong><br/><strong>...</strong><br/><strong>r-stringr-1.2.0 | mro343h889e2dd_0 143 KB r</strong><br/><strong>r-repr-0.12.0 | mro343h889e2dd_0 68 KB r</strong><br/><strong>r-irdisplay-0.4.4 | mro343h889e2dd_0 29 KB r</strong><br/><strong>jpeg-9b | vc14_2 314 KB conda-forge</strong><br/><strong>r-r6-2.2.2 | mro343_0 5.4 MB r</strong><br/><strong>r-digest-0.6.13 | mro343h889e2dd_0 168 KB r</strong><br/><strong>------------------------------------------------------------</strong><br/><strong>Total: 140.2 MB<br/>The following NEW packages will be INSTALLED:<br/>mro-base: 3.4.3-0 r</strong><br/><strong>r-crayon: 1.3.4-mro343h889e2dd_0 r</strong><br/><strong>r-digest: 0.6.13-mro343h889e2dd_0 r</strong><br/><strong>r-evaluate: 0.10.1-mro343h889e2dd_0 r</strong><br/><strong>...</strong><br/><strong>r-stringr: 1.2.0-mro343h889e2dd_0 r</strong><br/><strong>r-uuid: 0.1_2-mro343h889e2dd_0 r<br/>The following packages will be UPDATED:</strong><br/><strong>_r-mutex: 1.0.0-anacondar_1 r --&gt; 1.0.0-mro_2 r</strong><br/><strong>jpeg: 9b-hb83a4c4_2 --&gt; 9b-vc14_2 conda-forge [vc14]</strong><br/><strong>libxml2: 2.9.7-h79bbb47_0 --&gt; 2.9.8-vc14_0 conda-forge [vc14]</strong><br/><strong>sqlite: 3.22.0-h9d3ae62_0 --&gt; 3.22.0-vc14_0 conda-forge [vc14]<br/></strong><strong>r-base: 3.4.3-h6bb4b03_0 r --&gt; 3.4.1-1 conda-forge</strong><br/><strong>Proceed ([y]/n)? y</strong><br/><strong>Downloading and Extracting Packages</strong><br/><strong>r-pbdzmq 0.2_6: ########################################## | 100%</strong><br/><strong>libxml2 2.9.8: ########################################### | 100%</strong><br/><strong>r-irkernel 0.8.11: ####################################### | 100%</strong><br/><strong>r-magrittr 1.5: ########################################## | 100%</strong><br/><strong>r-evaluate 0.10.1: ####################################### | 100%</strong><br/><strong>_r-mutex 1.0.0: ########################################## | 100%</strong><br/><strong>...</strong><br/><strong>r-digest 0.6.13: ########################################################## | 100%</strong><br/><strong>Preparing transaction: done</strong><br/><strong>Verifying transaction: done</strong><br/><strong>Executing transaction: done</strong></pre>
<p>Now when you start Jupyter and pull down the kernel menu, you will see <span class="packt_screen">R</span> as a choice:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/d4c94e1f-53fc-476d-a05d-47eeeccb39bd.png" style="width:16.67em;height:23.33em;"/></p>
<p class="mce-root"/>
<p> </p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding R packages to Jupyter</h1>
                </header>
            
            <article>
                
<p>The standard installation for R under Jupyter has many packages that are commonly used in R programming. However, if you do need to add another package, a small number of steps need to be followed:</p>
<ol>
<li>Close down your Notebook (including the server).</li>
<li>In the command-line window, type the following:</li>
</ol>
<pre style="padding-left: 60px"><strong>R</strong> <strong>install.packages("name of the R package you want to add")</strong> <br/><strong>quit()</strong> <br/><strong># answer Yes to save</strong> </pre>
<ol start="3">
<li>Restart your Notebook and the package should be available in your R script, for example, <kbd>library (name of the R package you want to add)</kbd>.</li>
</ol>
<div class="packt_infobox">Note that you may still have problems in R where the core version of R that you have installed is out of date, so you will need to upgrade it to use a particular library.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">R limitations in Jupyter</h1>
                </header>
            
            <article>
                
<p><span>In this chapter, we used a variety of packages, both pre-installed and installed especially for the example. I have exercised a variety of materials that are available in R under Jupyter and have not found any limitations; you can perform most of the steps in Jupyter that you would have done under the standard R implementations. The only limitation appears to be when you are using <em><span class="KeyWordPACKT">Shiny</span></em> or if you are attempting to use extensive markdown:</span></p>
<ul>
<li>For Shiny, I think you are mixing purposes—Jupyter is providing a web experience and so does Shiny—so I'm not sure how to even decide if this should work. This issue is being addressed by the Jupyter development group.</li>
<li>Using extensive markdown does not appear to be a good idea, either. The intent of markdown was to allow Notebook developers to augment the standard output (of R) in a more illustrative manner. I think that if you are adding extensive markdown to your Notebook, you really need to develop a website—maybe using Shiny <span>and </span>then you will have all of the HTML markdown available.</li>
</ul>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Basic R in Jupyter</h1>
                </header>
            
            <article>
                
<p><span>Start a new <span class="ScreenTextPACKT">R</span> Notebook and call it</span> <kbd>R Basics</kbd>. We can enter a small script just so we can see how the steps progress for R script. Enter the following into separate cells of your Notebook:</p>
<pre><span class="packt_screen">myString &lt;- "Hello, World!" <br/>print (myString) </span></pre>
<p>From here, you will end up with a starting screen that looks like this:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/34d93979-d811-4a3c-adcd-63b5e7e75317.png"/></div>
<p>We should note the aspects of the R Notebook view:</p>
<ul>
<li>We have the R logo in the upper-right corner. You will see this logo running in other R installations.</li>
<li><span>There is also the peculiar <span class="ScreenTextPACKT"><span class="packt_screen">R</span></span></span> <span><span class="ScreenTextPACKT"><span class="packt_screen">O</span></span> just below the R icon. If the <span class="packt_screen">O</span> unfilled circle displays, the unfilled circle indicates that the kernel is at rest, and the filled circle indicates that the kernel is working.</span></li>
<li> The rest of the menu items are the same as the ones we saw previously.</li>
</ul>
<p><span>This is a very simple script–set a variable in one cell and then print out its value in another cell. Once executed (<span class="ScreenTextPACKT"><span class="packt_screen">Cell </span></span><span class="packt_screen">|</span> <span class="ScreenTextPACKT"><span class="packt_screen">Run All</span></span>), you will see your results:</span></p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/0d2547f2-9277-4722-91e0-2c7d899e1771.png"/></div>
<p>So, just as if you run the script in an R interpreter, you get your output (with the numerical prefix). Jupyter has counted the statements so that we have incremental numbering of the cells. Jupyter has not done anything special to print out variables for debugging; you will have to do that separately.</p>
<p>If we look at the R server-logging statements (a command-line window was created when we started Jupyter), we will be able to see the actions that took place:</p>
<pre><strong>$ jupyter notebook</strong> 
<strong>[I 11:00:06.965 NotebookApp] Serving notebooks from local directory: /Users/dtoomey/miniconda3/bin</strong> 
<strong>[I 11:00:06.965 NotebookApp] 0 active kernels </strong> 
<strong>[I 11:00:06.965 NotebookApp] The Jupyter Notebook is running at: http://localhost:8888/</strong> 
<strong>[I 11:00:06.965 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).</strong> 
<strong>[I 11:00:17.447 NotebookApp] Creating new notebook in </strong> 
<strong>[I 11:00:18.199 NotebookApp] Kernel started: 518308da-460a-4eb9-9959-1411e31dec69</strong> 
<strong>[1] "Got unhandled msg_type:" "comm_open"              </strong> 
<strong>[I 11:02:18.160 NotebookApp] Saving file at /Untitled.ipynb</strong> 
<strong>[I 11:08:27.340 NotebookApp] Saving file at /R Basics.ipynb</strong> 
<strong>[1] "Got unhandled msg_type:" "comm_open"              </strong> 
<strong>[I 11:14:45.204 NotebookApp] Saving file at /R Basics.ipynb</strong> </pre>
<p>We started the server, created a new Notebook, and saved it as <kbd><span class="CodeInTextPACKT">R</span> <span class="CodeInTextPACKT">Basics</span></kbd>. If we open the IPYNB file on disk (using a text editor), we will be able to see the following:</p>
<pre>{ 
  "cells": [ 
    ...&lt;similar to previously displayed&gt; 
  ], 
  "metadata": { 
    "kernelspec": { 
      "display_name": "R", 
      "language": "R", 
      "name": "ir" 
    }, 
    "language_info": { 
      "codemirror_mode": "r", 
      "file_extension": ".r", 
      "mimetype": "text/x-r-source", 
      "name": "R", 
      "pygments_lexer": "r", 
      "version": "3.4.3" 
    } 
  }, 
  ...&lt;omitted&gt; 
} </pre>
<p>This is a little different than what we saw in the prior chapter on Python Notebook coding. In particular, the metadata clearly targets the script cells to be R script. Note that the actual cells are not specific to a language <span>– </span>they are just scripts that will be executed as per the metadata directives.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">R dataset access</h1>
                </header>
            
            <article>
                
<p><span>For this example, we will use the <span class="KeyWordPACKT">Iris</span> dataset. Iris is built into R installations and is available directly. Let's just pull in the data, gather some simple statistics, and plot the data. This will show R accessing a dataset in Jupyter, using an R built-in package, as well as some available statistics (since we have R), and the interaction with R graphics.</span></p>
<p>The script we will use is as follows:</p>
<pre>data(iris) <br/>summary(iris) <br/>plot(iris) </pre>
<p class="mce-root"/>
<p>If we enter this small script into a new R Notebook, we get an initial display that looks like the following:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/480d5a96-0550-467e-869d-5bc3d99b2698.png"/></div>
<p>I would expect the standard R statistical summary as output, and I know that the Iris plot is pretty interesting. We can see exactly what happened in the following screenshot:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/ff9e8afc-27c0-4da1-8b99-10db79932a59.png"/></div>
<p>The plot continues in the following screenshot, as it wouldn't fit into a single page:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/a8166b67-6e45-4f13-8595-92a6ebeb0515.png"/></div>
<div class="packt_infobox">A feature of Jupyter is to place larger plots, such as this, into a viewport that only shows a part of the image. I was able to drag the image out of the viewport window in its entirety for this shot. You can eliminate the viewport boundaries and have the entire output displayed by clicking in the viewport and dragging it.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">R visualizations in Jupyter</h1>
                </header>
            
            <article>
                
<p>A common use of R is to use several visualizations, which are available depending on the underlying data. In this section, we will go over some of them to see how R interacts with Jupyter.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">R 3D graphics in Jupyter</h1>
                </header>
            
            <article>
                
<p>One of the packages available for 3D graphics is <kbd><span class="CodeInTextPACKT">persp</span></kbd>. The <kbd><span class="CodeInTextPACKT">persp</span></kbd> package draws perspective plots over a 2D space.</p>
<p>We can enter a basic <kbd><span class="CodeInTextPACKT">persp</span></kbd> command in a new Notebook just by using the following command:</p>
<pre>example(persp) </pre>
<p>So, we will have something like this in a Notebook:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/274d678b-b59f-4167-9548-a26049e529f9.png"/></div>
<p><span>Once we run the step (</span><span class="packt_screen">Cell | Run All</span><span>), we will see the display that's shown in the following screenshot. The first part is the script involved in generating the graphic (this is part of the example code):</span></p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/398f181e-7058-4305-a184-c389b7d08455.png"/></div>
<p class="mce-root"/>
<p>Then, we will see the following graphic display:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/b973ab13-75ad-4a6e-8b76-5d2afafa4e46.png" style="width:41.67em;height:34.83em;"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">R 3D scatterplot in Jupyter</h1>
                </header>
            
            <article>
                
<p>The R <kbd>lattice</kbd> package has a Cloud function that will produce 3D scatterplots.</p>
<p>The script we will use is as follows:</p>
<pre># make sure lattice package is installed 
install.packages("lattice") 
 
# in a standalone R script you would have a command to download the lattice library - this is not needed in Jupyter 
 
library("lattice") 
# use the automobile data from ics.edu 
mydata &lt;- read.table("http://archive.ics.uci.edu/ml/machine-learning-databases/auto-mpg/auto-mpg.data") 
 
# define more meaningful column names for the display 
colnames(mydata) &lt;- c("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model.year", "origin", "car.name") 
 
# 3-D plot with number of cylinders on x axis, weight of the vehicle on the y axis and miles per gallon on the z axis. 
cloud(mpg~cylinders*weight, data=mydata) 
 </pre>
<p>Prior to running it, we will have something such as this:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/abac78ac-de21-459e-a1cc-e57cffb85bc6.png"/></div>
<p>Notice that we are using markup type cells for comments about the script steps. They are also denoted without a script line number in the left-hand column.</p>
<div class="packt_infobox">If you are copying R script into a Jupyter window, you may run across an issue where the print copy you are using has non-standard double quote characters (quotes on the left lean to the left, while quotes on the right lean to the right). Once copied into Jupyter, you will need to change this to normal double quotes (they don't lean; instead, they are vertical).</div>
<p>After running this, we will see the following display:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/708da976-2c24-4a97-b1a6-07e356691d2d.png" style="width:40.92em;height:40.67em;"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">R cluster analysis</h1>
                </header>
            
            <article>
                
<p>In this example, we will use R's cluster analysis functions to determine the clustering in the wheat dataset from <a href="https://uci.edu/" target="_blank">https://uci.edu/</a>.</p>
<p>The R script we want to use in Jupyter is as follows:</p>
<pre># load the wheat data set from uci.edu 
wheat &lt;- read.csv("http://archive.ics.uci.edu/ml/machine-learning-databases/00236/seeds_dataset.txt", sep="\t") 
 
# define useful column names 
colnames(wheat) &lt;-c("area", "perimeter", "compactness", "length", "width", "asymmetry", "groove", "undefined") 
 
# exclude incomplete cases from the data 
wheat &lt;- wheat[complete.cases(wheat),] 
 
# calculate the clusters 
set.seed(117) #to make reproducible results 
fit &lt;- kmeans(wheat, 5) 
fit </pre>
<p>Once entered into a Notebook, we will have something such as this:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/c26a8349-6660-4283-ac2a-c011796ce286.png"/></div>
<p>The resulting, generated cluster information is k-means clustering with five clusters of sizes; 39, 53, 47, 29, and 30 (Note that I set the seed value for random number use, so your results will not vary):</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/dc965192-ac2a-4621-ae4a-4b1336300650.png" style="width:42.83em;height:47.08em;"/></p>
<p>So, we generated the information of five clusters (the parameter passed into the <span class="CodeInTextPACKT">fit</span> statement). It is a little bothersome that the cluster sum of squares vary greatly.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">R forecasting</h1>
                </header>
            
            <article>
                
<p>For this example, we will forecast the Fraser River levels, given the data from <a href="https://datamarket.com/data/set/22nm/fraser-river-at-hope-1913-1990#!ds=22nm&amp;display=line" target="_blank"><span class="URLPACKT">https://datamarket.com/data/set/22nm/fraser-river-at-hope-1913-1990#!ds=22nm&amp;display=line</span></a>. I was not able to find a suitable source, so I extracted the data by hand from the site into a local file.</p>
<p>We will be using the R <kbd>forecast</kbd> package. You have to add this package to your setup (as described at the start of this chapter).</p>
<p>The R script we will be using is as follows:</p>
<pre>library(forecast) 
fraser &lt;- scan("fraser.txt") 
plot(fraser) 
fraser.ts &lt;- ts(fraser, frequency=12, start=c(1913,3)) 
fraser.stl = stl(fraser.ts, s.window="periodic") 
monthplot(fraser.stl) 
seasonplot(fraser.ts) </pre>
<p>The output of interest in this example are the three plots: simple plot, monthly, and computed seasonal.</p>
<p>When this is entered into a Notebook, we will get a familiar layout:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/d64e594b-ad91-4b65-b38b-a8cede87ef0c.png" style="width:38.08em;height:22.58em;"/></p>
<p class="mce-root"/>
<p>The simple plot (using the R <kbd>plot</kbd> command) is like the one that's shown in the following screenshot. There is no apparent organization or structure:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/55a97b3a-4e5f-43f6-bb18-57b58053dc99.png"/></div>
<p class="mce-root"/>
<p>The monthly plot (using the <kbd><span class="CodeInTextPACKT">month</span><span class="CodeInTextPACKT">plot</span></kbd> command) is like what's shown in the following screenshot. River flows appear to be very consistent within a month:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/764262d3-8773-4e89-bcfb-9ad3cd93efb7.png"/></div>
<p>Finally, the <kbd>seasonalplot</kbd> shows, quite dramatically, what we have been trying to forecast, that is, definite seasonality to the river flows:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/4e3da6f1-9ae0-48cf-a9ea-a26655bc8dc8.png" style="width:43.17em;height:39.58em;"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">R machine learning</h1>
                </header>
            
            <article>
                
<p>In this section, we will use an approach for machine learning where we will do the following:</p>
<ul>
<li>Partition the dataset into a training and testing set</li>
<li>Generate a model of the data</li>
<li>Test the efficiency of our model</li>
</ul>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Dataset</h1>
                </header>
            
            <article>
                
<p>Machine learning works by featuring a dataset that we will break up into a training section and a testing section. We will use the training data to come up with a model. We can then prove or test that model against the testing dataset.</p>
<p>For a dataset to be usable, we need at least a few hundred observations. I am using the housing data from <span><a href="http://uci.edu">http://uci.edu</a></span>. Let's load the dataset by using the following command:</p>
<pre><strong>housing &lt;- read.table("http://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data") </strong></pre>
<p>The site documents the names of the variables as follows:</p>
<table border="1" style="border-collapse: collapse;width: 100%">
<tbody>
<tr>
<td>
<p><strong>Variables</strong></p>
</td>
<td>
<p><strong>Description</strong></p>
</td>
</tr>
<tr>
<td>
<p>CRIM</p>
</td>
<td>
<p>Per capita crime rate</p>
</td>
</tr>
<tr>
<td>
<p>ZN</p>
</td>
<td>
<p>Residential zone rate percentage</p>
</td>
</tr>
<tr>
<td>
<p>INDUS</p>
</td>
<td>
<p>Proportion of non-retail business in town</p>
</td>
</tr>
<tr>
<td>
<p>CHAS</p>
</td>
<td>
<p>Proximity to Charles River (Boolean)</p>
</td>
</tr>
<tr>
<td>
<p>NOX</p>
</td>
<td>
<p>Nitric oxide concentration</p>
</td>
</tr>
<tr>
<td>
<p>RM</p>
</td>
<td>
<p>Average rooms per dwelling</p>
</td>
</tr>
<tr>
<td>
<p>AGE</p>
</td>
<td>
<p>Proportion of housing built before 1940</p>
</td>
</tr>
<tr>
<td>
<p>DIS</p>
</td>
<td>
<p>Weighted distance to employment center</p>
</td>
</tr>
<tr>
<td>
<p>RAD</p>
</td>
<td>
<p>Accessibility to highway</p>
</td>
</tr>
<tr>
<td>
<p>TAX</p>
</td>
<td>
<p>Tax rate per $10,000</p>
</td>
</tr>
<tr>
<td>
<p>B</p>
</td>
<td>
<p><em>1,000(Bk-0.63)<sup>2</sup> Bk</em> is equal to black population percentage</p>
</td>
</tr>
<tr>
<td>
<p>LSTAT</p>
</td>
<td>
<p>Percent lower status population</p>
</td>
</tr>
<tr>
<td>
<p>MEDV</p>
</td>
<td>
<p>Median value of owner-occupied homes $1,000's</p>
</td>
</tr>
</tbody>
</table>
<p class="mce-root"/>
<p>So, let's apply these so that we can make sense of the data:</p>
<pre>colnames(housing) &lt;- c("CRIM","ZN","INDUS","CHAS","NOX","RM","AGE","DIS","RAD", "TAX", "PRATIO","B","LSTAT", "MDEV") </pre>
<p class="mce-root"/>
<p>Now, we can get a summary so that we can get a feel for the values:</p>
<pre>summary(housing) </pre>
<p>This results in a screen that looks like this when executed:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/c50d3494-5b79-49cf-a85c-8de9951097dc.png"/></p>
<p>So, the data is somewhat dated. The median values are very low compared to current housing prices in the area.</p>
<p>Also, the statistics are not politically correct <span>– </span>the B factor is a measure of the Black population.</p>
<p class="mce-root"/>
<p>Overall, we have a good number of variables. Which ones are likely candidates for our model? I have found that the best tool for this is a simple regression plot of every variable against every other variable. We can use the following command for this:</p>
<pre>plot(housing) </pre>
<p>R does what we want, as shown in the following display:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/bcca8722-e598-4df1-9c2b-ab897625fcb1.png"/></p>
<p>We are looking for either a positive or negative correlation, that is, a somewhat 45-degree line or a negative 45-degree line. Anything that shows a hodgepodge or vertical or horizontal pattern is not going to tell us anything about the data.</p>
<p>The best correlations occurred with RAD (access to highway) and TAX (rate per $1,000). Luckily, most of the variables show a good correlation.</p>
<p>As housing value is our yardstick, let's order the data by it before we partition it, by using the following command:</p>
<pre>housing &lt;- housing[order(housing$MDEV),] </pre>
<p>We will be using the caret package to partition the data, so let's load that in:</p>
<pre>install.packages("caret") 
library("caret") </pre>
<p>Now, we can partition the data:</p>
<pre># set the random seed so we can reproduce results 
set.seed(311) 
 
# take 3/4 of the data for training 
trainingIndices &lt;- createDataPartition(housing$MDEV, p=0.75, list=FALSE) 
 
# split the data 
housingTraining &lt;- housing[trainingIndices,] 
housingTesting &lt;- housing[-trainingIndices,] 
 
# make sure the paritioning is working 
nrow(housingTraining) 
nrow(housingTesting) 
381 
125 </pre>
<p>The split counts appear to be correct. Let's create our model and see what we get:</p>
<pre>linearModel &lt;- lm(MDEV ~ CRIM + ZN + INDUS + CHAS + NOX + RM + AGE + DIS + RAD + TAX + PRATIO + B + LSTAT, data=housingTraining) 
summary(linearModel) </pre>
<p>This is the screenshot of the preceding code:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/4ee8b0a0-9f53-4cdb-aedf-26cd39ec331a.png" style="width:35.92em;height:34.83em;"/></p>
<p>It's interesting that several of the variables do not have much of an effect. These are <kbd>AGE</kbd>, <kbd>TAX</kbd>, and <kbd>B</kbd>.</p>
<p>We have our model, so now we can make predictions:</p>
<pre>predicted &lt;- predict(linearModel,newdata=housingTesting) 
summary(predicted) 
Min. 1st Qu. Median Mean 3rd Qu. Max.  
0.1378 17.4939 21.9724 22.0420 25.6669 40.9981 </pre>
<p>I don't think this summary tells us much. A plot of the two against each other (including an <kbd>abline</kbd> function) is much more informative:</p>
<pre>plot(predicted, housingTesting$MDEV) 
abline(lm(predicted ~ housingTesting$MDEV)) </pre>
<p><span>This is the screenshot of the preceding code:</span></p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/9d5ee7a4-410d-44f1-add2-4831d74e0031.png" style="width:36.17em;height:33.50em;"/></p>
<p>Visually, it looks to be an excellent correlation between the two.</p>
<p>Let's do some math to see how close we got. A sum of squares will give us a good measure. I did not find a built-in method, so I added my own:</p>
<pre>sumOfSquares &lt;- function(x) { 
    return(sum(x^2)) 
} 
 
#make sure it works 
sumOfSquares(1:5) 
15 
Testing our model: 
diff &lt;- predicted - housingTesting$MDEV 
sumOfSquares(diff) 
2487.85072318584 </pre>
<p>Here, we have a sum of the squares of the differences, which is at about 2,500. This sounds significant for just a few hundred observations.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we added the ability to use R scripts in our Jupyter notebook. We added an R library that's not included in the standard R installation, and we made a Hello World script in R. We then saw R data access built-in libraries and some of the simpler graphics and statistics that are automatically generated. We used an R script to generate 3D graphics in a couple of different ways. We then performed a standard cluster analysis (which I think is one of the basic uses of R) and used one of the available forecasting tools. We also built a prediction model and tested its accuracy.</p>
<p>In the next chapter, we will learn all about Julia scripting using a Jupyter notebook.</p>


            </article>

            
        </section>
    </body></html>
- en: Naive Bayes
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A Naive Bayes classification algorithm assigns a class to an element of a set
    that is most probable according to Bayes' theorem.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s say that *A* and *B* are probabilistic events. *P(A)* is the probability
    of *A* being `true`. *P(A|B)* is the conditional probability of *A* being `true`,
    given that *B* is `true`. If this is the case, then Bayes'' theorem states the
    following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/1e3a0961-1ce8-4b33-8295-610932648b72.png)'
  prefs: []
  type: TYPE_IMG
- en: '*P(A)* is the prior probability of *A* being `true` without the knowledge of
    the probability of *P(B)* and *P(B|A)*. *P(A|B)* is the posterior probability
    of *A* being `true`, taking into consideration additional knowledge about the
    probability of *B* being `true`.'
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, you will learn about the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: How to apply Bayes' theorem in a basic way to compute the probability of a medical
    test that is correct in the simple example medical test
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to grasp Bayes' theorem by proving its statement and its extension
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to apply Bayes' theorem differently to independent and dependent variables
    in examples of playing chess
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to apply Bayes' theorem to discrete random variables in examples of medical
    tests and playing chess, and for continuous random variables in an example of
    gender classification using the probability distribution of the continuous random
    variable
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to implement an algorithm in Python to calculate the posterior probabilities
    of using Bayes' theorem
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: By the end of this chapter, you will be able to verify your understanding of
    Naive Bayes by solving problems. You will also be able to discern in which situations
    Bayes' theorem is an appropriate method of analysis, and when it is not.
  prefs: []
  type: TYPE_NORMAL
- en: Medical tests – basic application of Bayes' theorem
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A patient takes a special cancer test that has an accuracy of `test_accuracy=99.9%`—if
    the result is positive, then 99.9% of the patients tested will suffer from that
    particular type of cancer. Conversely, 99.9% of the patients with a negative result
    will not suffer from that particular cancer.
  prefs: []
  type: TYPE_NORMAL
- en: Suppose that a patient is tested and the result is positive. What is the probability
    of that patient suffering from that particular type of cancer?
  prefs: []
  type: TYPE_NORMAL
- en: Analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We will use Bayes'' theorem to ascertain the probability of the patient having
    cancer:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d0bacaf1-2e6b-4b9a-9a18-babfad1b9c73.png)'
  prefs: []
  type: TYPE_IMG
- en: To ascertain the prior probability that a patient has cancer, we have to find
    out how frequently cancer occurs among people. Say that we find out that 1 person
    in 100,000 suffers from this kind of cancer. Therefore, *P(cancer)=1/100,000*.
    So, *P(test_positive|cancer) = test_accuracy=99.9%=0.999* given by the accuracy
    of the test.
  prefs: []
  type: TYPE_NORMAL
- en: '*P(test_positive)* has to be computed as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/fc29a390-e50c-428a-955b-24bd1632f2f5.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/edb7873e-6060-4860-a3d0-b50025907846.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/bddd6d3c-f083-49cd-bb6d-8ecd0b3ae5d3.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Therefore, we can calculate the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/4b5d9b6e-2b40-467d-bb4b-1c1fd4d6252b.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/68db59ff-64f1-42e0-bb56-1725a4861f17.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/fe78ce54-69c9-4861-8a7b-52c216b97539.png)'
  prefs: []
  type: TYPE_IMG
- en: So, even if the result of the test is positive and the test has an accuracy
    of 99.9%, the probability of the patient having the type of cancer tested for
    is only approximately 1%. The probability of someone having cancer after taking
    the test is relatively low when compared to the high accuracy of the test, but
    is much higher than the probability of 1 in 100,000 (0.001%), as was known prior
    to taking the test, based on its occurrence in the population.
  prefs: []
  type: TYPE_NORMAL
- en: Bayes' theorem and its extension
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we will state and prove both Bayes' theorem and its extension.
  prefs: []
  type: TYPE_NORMAL
- en: Bayes' theorem
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Bayes'' theorem states the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ee63b297-ca71-4ec1-97ec-e23e65d8e68a.png)'
  prefs: []
  type: TYPE_IMG
- en: Proof
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We can prove this theorem by using elementary set theory on the probability
    spaces of the events *A* and *B*. In other words, here, a probability event will
    be defined as a set of the possible outcomes in the probability space:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/aa0e5bb6-2353-4a84-8068-1617792a0145.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 2.1: Probability space for the two events'
  prefs: []
  type: TYPE_NORMAL
- en: 'As you can see in the preceding diagram, we can state the following relationships:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/faace8ed-f119-42e8-9bdc-9e8cb7d84d9e.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/43a6b4bc-0020-4e6d-87ea-5e6126ab9dc9.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Rearranging these relationships, we get the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/dec2ce66-426b-4593-94b1-76d8f2faeb19.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/933fce7d-60d9-428e-a4f6-4e1addbeefc0.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/fd66305c-346b-4fd0-bb93-87ce36cab82b.png)'
  prefs: []
  type: TYPE_IMG
- en: 'This is, in fact, Bayes'' theorem:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/be64046f-7f71-41a2-994f-1e6ce0425aa7.png)'
  prefs: []
  type: TYPE_IMG
- en: This concludes the proof.
  prefs: []
  type: TYPE_NORMAL
- en: Extended Bayes' theorem
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We can extend Bayes'' theorem by taking more probability events into consideration.
    Suppose that the events *B1,…,Bn* are conditionally independent given *A*. Let
    *~A* denote the complement of *A*. Then, we have the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/0f87f51c-675b-4c5d-a9a2-83eeb9da4e84.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/84cfe840-b3eb-4fc0-9351-63504b5c5114.png)'
  prefs: []
  type: TYPE_IMG
- en: Proof
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Since the events *B1,…,Bn* are conditionally independent given *A* (and also
    given *~A*), we get the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/8f2b7b8e-dc43-4a01-bb68-4c8d3350135f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Applying the simple form of Bayes'' theorem and this fact, we thus have the
    following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/0483f55a-0137-4da3-9481-f6310c381597.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/7659e200-e263-4048-a432-a4a119a3b01f.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/4f2148c3-8a3f-4b7e-82fc-19733de3b484.png)'
  prefs: []
  type: TYPE_IMG
- en: This completes the proof.
  prefs: []
  type: TYPE_NORMAL
- en: Playing chess – independent events
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Suppose we are given the following table of data. This tells us whether or
    not our friend will play a game of chess with us outside in the park, based on
    a number of weather-related conditions:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Temperature** | **Wind** | **Sunshine** | **Play** |'
  prefs: []
  type: TYPE_TB
- en: '| Cold | Strong | Cloudy | No |'
  prefs: []
  type: TYPE_TB
- en: '| Warm | Strong | Cloudy | No |'
  prefs: []
  type: TYPE_TB
- en: '| Warm | None | Sunny | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Hot | None | Sunny | No |'
  prefs: []
  type: TYPE_TB
- en: '| Hot | Breeze | Cloudy | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Warm | Breeze | Sunny | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Cold | Breeze | Cloudy | No |'
  prefs: []
  type: TYPE_TB
- en: '| Cold | None | Sunny | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Hot | Strong | Cloudy | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Warm | None | Cloudy | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Warm | Strong | Sunny | ? |'
  prefs: []
  type: TYPE_TB
- en: We would like to establish, by using Bayes' theorem, whether our friend would
    like to play a game of chess with us in the park given that the Temperature is
    Warm, the Wind is Strong, and it is Sunny.
  prefs: []
  type: TYPE_NORMAL
- en: Analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this case, we may want to consider *Temperature*, *Wind*, and *Sunshine*
    as the independent random variables. The formula for the extended Bayes'' theorem,
    when adapted, becomes the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/92f1bd4b-20e6-47b0-854f-caab5e54c58e.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/41f48dec-1acc-44c9-82ac-da9cead92eec.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/e4b560ed-d258-4bf4-9c11-4520aa5329db.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/56a1223e-b6d0-4a83-aa29-1dc7c8a24168.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/005c8a30-7590-450e-b9ce-504018db3fce.png)'
  prefs: []
  type: TYPE_IMG
- en: Let's count the number of columns in the table with all known values to determine
    the individual probabilities.
  prefs: []
  type: TYPE_NORMAL
- en: '*P(Play=Yes)=6/10=3/5*, since there are 10 columns with complete data, and
    *6* of them have the value *Yes* for the attribute *Play*.'
  prefs: []
  type: TYPE_NORMAL
- en: '*P(Temperature=Warm|Play=Yes)=3/6=1/2*, since there are *6* columns with the
    value *Yes* for the attribute *Play* and, of those, *3* have the value *Warm*
    for the attribute *Temperature*. Similarly, we have the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '*![](img/18624546-bada-4ea7-9649-ee96875906b4.png)*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*![](img/49dc0bc8-1607-4ac8-bbde-d5d434eb01a7.png)*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*![](img/e59f6029-9102-4629-8a66-bf8327219510.png) *'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*![](img/ca839282-8e05-4444-8dc3-6aeb3033fa2e.png)*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*![](img/f644f2ce-925d-44e3-b8ab-7c7cf88935cb.png)*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*![](img/28d39d67-16b2-4a81-90e6-94e4a234e722.png)*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Thus:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/77863d74-e1c8-41d2-b472-82c68b98a3f9.png)  and ![](img/eecbedd6-3e19-4efb-899a-2792c4a36271.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Therefore, we have the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/997d4964-fab8-47b0-ae81-cb5fc020c85c.png)'
  prefs: []
  type: TYPE_IMG
- en: This means that our friend is likely to be happy to play chess with us in the
    park in the stated weather conditions, with a probability of about *67%*. Since
    this is a majority, we could classify the data vector (*Temperature=Warm, Wind=Strong,
    Sunshine=Sunny*) as being in the *Play=Yes* class.
  prefs: []
  type: TYPE_NORMAL
- en: Implementation of a Naive Bayes classifier
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this section, we will implement a program calculating the probability of
    a data item belonging to a certain class by using Bayes'' theorem:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'We use the dictionary part from the common library:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '**Input**:'
  prefs: []
  type: TYPE_NORMAL
- en: 'We save the data from the table, for example, the data that is related to playing
    chess playing chess, in the following CSV file:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '**Output**:'
  prefs: []
  type: TYPE_NORMAL
- en: 'We provide the `chess.csvfile` as the input to the Python program, calculating
    the probabilities of the data item (*Temperature=Warm, Wind=Strong, Sunshine=Sunny*)
    belonging to the classes present in the file by using `Play=Yes` and `Play=No`.
    As we found out earlier, the data item belongs to the `Play=Yes` class due to
    it having higher probability. Therefore, we classify the data item into that class:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Playing chess – dependent events
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Suppose that we would like to find out whether our friend would like to play
    chess with us in a park in Cambridge, UK. But, this time, we are given different
    input data:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Temperature** | **Wind** | **Season** | **Play** |'
  prefs: []
  type: TYPE_TB
- en: '| Cold | Strong | Winter | No |'
  prefs: []
  type: TYPE_TB
- en: '| Warm | Strong | Autumn | No |'
  prefs: []
  type: TYPE_TB
- en: '| Warm | None | Summer | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Hot | None | Spring | No |'
  prefs: []
  type: TYPE_TB
- en: '| Hot | Breeze | Autumn | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Warm | Breeze | Spring | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Cold | Breeze | Winter | No |'
  prefs: []
  type: TYPE_TB
- en: '| Cold | None | Spring | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Hot | Strong | Summer | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Warm | None | Autumn | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Warm | Strong | Spring | ? |'
  prefs: []
  type: TYPE_TB
- en: So, now we are wondering how the answer to whether our friend would like to
    play in a park in Cambridge, UK, will change with this different data in regard
    to the **Temperature** being **Warm**, the **Wind** being **Strong**, and the
    **Season** being **Spring**.
  prefs: []
  type: TYPE_NORMAL
- en: Analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We may be tempted to use Bayesian probability to calculate the probability of
    our friend playing chess with us in the park. However, we should be careful, and
    ask whether the probability of the events are independent of each other.
  prefs: []
  type: TYPE_NORMAL
- en: In the previous example, where we used Bayesian probability, we were given the
    probability variables **Temperature**, **Wind**, and **Sunshine**. These are reasonably
    independent. Common sense tells us that a specific **Temperature** and **Sunshine**
    do not have a strong correlation to a specific **Wind** speed. It is true that
    sunny weather results in higher temperatures, but sunny weather is common even
    when the temperatures are very low. Hence, we considered even **Sunshine** and
    **Temperature** as being reasonably independent as random variables and applied
    Bayes' theorem.
  prefs: []
  type: TYPE_NORMAL
- en: However, in this example, **Temperature** and **Season** are closely related,
    especially in a location such as the UK, our stated location for the park. Unlike
    countries closer to the equator, temperatures in the UK vary greatly throughout
    the year. Winters are cold and summers are hot. Spring and fall have temperatures
    in between.
  prefs: []
  type: TYPE_NORMAL
- en: Therefore, we cannot apply Bayes' theorem here, as the random variables are
    dependent. However, we could still perform some analysis by using Bayes' theorem
    on the partial data. By eliminating sufficient dependent variables, the remaining
    ones could turn out to be independent. Since **Temperature** is a more specific
    variable than **Season**, and the two variables are dependent, let's keep just
    the **Temperature** variable. The remaining two variables, **Temperature** and
    **Wind**, are independent.
  prefs: []
  type: TYPE_NORMAL
- en: 'Thus, we get the following data:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Temperature** | **Wind** | **Play** |'
  prefs: []
  type: TYPE_TB
- en: '| Cold | Strong | No |'
  prefs: []
  type: TYPE_TB
- en: '| Warm | Strong | No |'
  prefs: []
  type: TYPE_TB
- en: '| Warm | None | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Hot | None | No |'
  prefs: []
  type: TYPE_TB
- en: '| Hot | Breeze | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Warm | Breeze | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Cold | Breeze | No |'
  prefs: []
  type: TYPE_TB
- en: '| Cold | None | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Hot | Strong | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Warm | None | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Warm | Strong | ? |'
  prefs: []
  type: TYPE_TB
- en: We can keep the duplicate rows, as they give us greater evidence of the occurrence
    of that specific data row.
  prefs: []
  type: TYPE_NORMAL
- en: '**Input**:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Saving the table, we get the following CSV file:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '**Output**:'
  prefs: []
  type: TYPE_NORMAL
- en: 'We input the saved CSV file into the `naive_bayes.py` program and we get the
    following result:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: The first class, `Yes`, is going to be true, with a probability of 50%. The
    numerical difference resulted from using Python's non-exact arithmetic on the
    float numerical data type. The second class, `No`, has the same probability, that
    is, 50%, of being true. Thus, we cannot make a reasonable conclusion with the
    data that we have about the class of the vector (`Warm`, `Strong`). However, you
    have probably already noticed that this vector already occurs in the table with
    the resulting class `No`. Hence, our guess would be that this vector should just
    happen to exist in one class, `No`. But, to have greater statistical confidence,
    we would need more data or more independent variables to be involved.
  prefs: []
  type: TYPE_NORMAL
- en: Gender classification – Bayes for continuous random variables
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: So far, we have been given a probability event that belonged to one of a finite
    number of classes, for example, a temperature was classified as cold, warm, or
    hot. But how would we calculate the posterior probability if we were given the
    temperature in °C instead?
  prefs: []
  type: TYPE_NORMAL
- en: 'For this example, we are given the heights of five men and five women, as shown
    in the following table:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Height in cm** | **Gender** |'
  prefs: []
  type: TYPE_TB
- en: '| 180 | Male |'
  prefs: []
  type: TYPE_TB
- en: '| 174 | Male |'
  prefs: []
  type: TYPE_TB
- en: '| 184 | Male |'
  prefs: []
  type: TYPE_TB
- en: '| 168 | Male |'
  prefs: []
  type: TYPE_TB
- en: '| 178 | Male |'
  prefs: []
  type: TYPE_TB
- en: '| 170 | Female |'
  prefs: []
  type: TYPE_TB
- en: '| 164 | Female |'
  prefs: []
  type: TYPE_TB
- en: '| 155 | Female |'
  prefs: []
  type: TYPE_TB
- en: '| 162 | Female |'
  prefs: []
  type: TYPE_TB
- en: '| 166 | Female |'
  prefs: []
  type: TYPE_TB
- en: '| 172 | ? |'
  prefs: []
  type: TYPE_TB
- en: Suppose that the next person has a height of 172 cm. What gender is that person
    more likely to be, and with what probability?
  prefs: []
  type: TYPE_NORMAL
- en: Analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: One approach to solving this problem could be to assign classes to the numerical
    values; for example, the people with a height of between 170 cm and 179 cm would
    be in the same class. With this approach, we may end up with a few classes that
    are very wide, for example, with a high cm range, or with classes that are more
    precise but have fewer members, and so we cannot use the full potential of the
    Bayes classifier. Similarly, using this method, we would not consider the classes
    of height interval (170, 180) and (180, 190) in centimeters, to be closer to each
    other than the classes (170, 180) and (190, 200).
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s remind ourselves of the Bayes'' formula here:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/4065676f-213a-496e-bd48-07eb551ed0ea.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/94706b71-4c4e-4397-8eb0-4b09d25dc2b2.png)'
  prefs: []
  type: TYPE_IMG
- en: Expressing the formula in the final form shown here removes the need to normalize
    the *P(height|male)* and *P(height)* to get the correct probability of a person
    being male based on their height.
  prefs: []
  type: TYPE_NORMAL
- en: 'Assuming that the height of people is distributed normally, we could use a
    normal probability distribution to calculate *P(male|height)*. We assume that *P(male)=0.5*,
    that is, it is equally likely that the person to be measured is of either gender.
    A normal probability distribution is determined by the mean, μ, and the variance, *σ²*,
    of the population:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/9e873050-d211-4beb-a2aa-71d9e92b60d1.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The following table shows the mean height and variance by gender:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Gender** | **Mean height** | **Height variance** |'
  prefs: []
  type: TYPE_TB
- en: '| Male | 176.8 | 37.2 |'
  prefs: []
  type: TYPE_TB
- en: '| Female | 163.4 | 30.8 |'
  prefs: []
  type: TYPE_TB
- en: 'Thus, we could calculate the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/b09b6973-a133-4315-90af-45500ef2010d.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/c217fffa-8ec2-4fcf-9a6c-26ee7e8c1f97.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Note that these are not the probabilities, just the values of the probability
    density function. However, from these values, we can already observe that a person
    with a height of 172 cm is more likely to be male than female because, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d0f50b50-b969-498a-9dd4-cf33f29b3ff2.png)'
  prefs: []
  type: TYPE_IMG
- en: 'To be more precise:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/fb09d676-5919-46b8-a422-726f60fb9607.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/3da3fe22-f207-4c58-a2dd-e775312e98e3.png)'
  prefs: []
  type: TYPE_IMG
- en: Therefore, the probability of a person with a height of *172* cm being male
    is of *68.9%*.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we learned about Naive Bayes and how it can be applied in different
    ways for different purposes.
  prefs: []
  type: TYPE_NORMAL
- en: 'Bayes'' theorem states the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/5d22360b-62a2-4229-b95f-3863b4a71b76.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Here, *P(A|B)* is the conditional probability of *A* being true, given that *B* is
    true. It is used to update the value of the probability that *A* is true given
    the new observations about other probabilistic events. This theorem can be extended
    to a statement with multiple random variables:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7aab5897-71b6-48e3-8cba-88fdbac84ace.png)'
  prefs: []
  type: TYPE_IMG
- en: The random variables *B1,...,Bn* have to be conditionally independent given *A*.
    The random variables can be discrete or continuous and follow a probability distribution,
    for example, normal (Gaussian) distribution.
  prefs: []
  type: TYPE_NORMAL
- en: We also studied the discrete random variable. We learned that it is best to
    ensure that you have a data item for each value of a discrete random variable
    given any of the conditions (with a value of *A*) by collecting sufficient data.
  prefs: []
  type: TYPE_NORMAL
- en: The more independent random variables we have, the more accurately we can determine
    the posterior probability. However, the greater danger is that some of these variables
    could be dependent, resulting in imprecise final results. When variables are dependent,
    we may eliminate some of the dependent variables and consider only mutually independent
    variables, or consider another algorithm as an approach to solving the data science
    problem.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will learn how to classify an element with a decision
    tree algorithm.
  prefs: []
  type: TYPE_NORMAL
- en: Problems
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Problem 1**: A patient is tested for a virus, *V*. The accuracy of the test
    is 98%. This virus, *V*, is currently present in 4 out of 100 people in the region
    the patient lives in:'
  prefs: []
  type: TYPE_NORMAL
- en: a) What is the probability that a patient having the virus, *V*, if they test
    positive?
  prefs: []
  type: TYPE_NORMAL
- en: b) What is the probability of a patient still having the virus if the result
    of the test is negative?
  prefs: []
  type: TYPE_NORMAL
- en: '**Problem 2**: Apart from assessing whether patients are suffering from the
    virus, *V* (in *Problem 1*), by using the test, a doctor usually also checks for
    other symptoms. According to a doctor, about 85% of patients with symptoms such
    as fever, nausea, abdominal discomfort, and malaise have the virus, *V*:'
  prefs: []
  type: TYPE_NORMAL
- en: a) What is the probability of a patient having the virus, *V*, if they have
    the symptoms mentioned previously and their test result for the virus is positive?
  prefs: []
  type: TYPE_NORMAL
- en: b) How likely is it that the patient has the virus if they have the symptoms
    mentioned previously, but the result of the test is negative?
  prefs: []
  type: TYPE_NORMAL
- en: '**Problem 3**: On a certain island, one in two tsunamis is preceded by an earthquake.
    There have been 4 tsunamis and 6 earthquakes in the past 100 years. A seismological
    station recorded an earthquake in the ocean near the island. What is the probability
    that it will result in a tsunami?'
  prefs: []
  type: TYPE_NORMAL
- en: '**Problem 4**: Patients are tested with four independent tests to ascertain
    whether they have a certain illness:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Test1 positive** | **Test2 positive** | **Test3 positive** | **Test4 positive**
    | **Illness** |'
  prefs: []
  type: TYPE_TB
- en: '| Yes | Yes | Yes | No | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Yes | Yes | No | Yes | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| No | Yes | No | No | No |'
  prefs: []
  type: TYPE_TB
- en: '| Yes | No | No | No | No |'
  prefs: []
  type: TYPE_TB
- en: '| No | No | No | No | No |'
  prefs: []
  type: TYPE_TB
- en: '| Yes | Yes | Yes | Yes | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Yes | No | Yes | Yes | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| No | Yes | No | No | No |'
  prefs: []
  type: TYPE_TB
- en: '| No | No | Yes | Yes | No |'
  prefs: []
  type: TYPE_TB
- en: '| Yes | Yes | No | Yes | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Yes | No | Yes | No | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Yes | No | No | Yes | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| No | Yes | Yes | No | ? |'
  prefs: []
  type: TYPE_TB
- en: We have taken a new patient, for whom the second and third tests are positive,
    while the first and fourth tests are negative. What is the probability that they
    suffer from the illness?
  prefs: []
  type: TYPE_NORMAL
- en: '**Problem 5**: We are given the following table of words that have featured
    in emails and whether or not those emails were spam:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Money** | **Free** | **Rich** | **Naughty** | **Secret** | **Spam** |'
  prefs: []
  type: TYPE_TB
- en: '| No | No | Yes | No | Yes | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Yes | Yes | Yes | No | No | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| No | No | No | No | No | No |'
  prefs: []
  type: TYPE_TB
- en: '| No | Yes | No | No | No | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Yes | No | No | No | No | No |'
  prefs: []
  type: TYPE_TB
- en: '| No | Yes | No | Yes | Yes | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| No | Yes | No | Yes | No | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| No | No | No | Yes | No | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| No | Yes | No | No | No | No |'
  prefs: []
  type: TYPE_TB
- en: '| No | No | No | No | Yes | No |'
  prefs: []
  type: TYPE_TB
- en: '| Yes | Yes | Yes | No | Yes | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| Yes | No | No | No | Yes | Yes |'
  prefs: []
  type: TYPE_TB
- en: '| No | Yes | Yes | No | No | No |'
  prefs: []
  type: TYPE_TB
- en: '| Yes | No | Yes | No | Yes | ? |'
  prefs: []
  type: TYPE_TB
- en: a) Create a Naive Bayes algorithm to determine whether or not a given email
    is a spam message. What is the result when given an email that contains the words
    **Money**, **Rich**, and **Secret**, but does not contain the words **Free** and
    **Naughty**?
  prefs: []
  type: TYPE_NORMAL
- en: b) Do you agree with the result of the algorithm? Is the Naive Bayes algorithm,
    as used here, a good method for classifying emails? Justify your answers.
  prefs: []
  type: TYPE_NORMAL
- en: '**Problem 6**: This is a gender classification problem. Let''s assume that
    we are given the following data about ten people:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Height in cm** | **Weight in kg** | **Hair length** | **Gender** |'
  prefs: []
  type: TYPE_TB
- en: '| 180 | 75 | Short | Male |'
  prefs: []
  type: TYPE_TB
- en: '| 174 | 71 | Short | Male |'
  prefs: []
  type: TYPE_TB
- en: '| 184 | 83 | Short | Male |'
  prefs: []
  type: TYPE_TB
- en: '| 168 | 63 | Short | Male |'
  prefs: []
  type: TYPE_TB
- en: '| 178 | 70 | Long | Male |'
  prefs: []
  type: TYPE_TB
- en: '| 170 | 59 | Long | Female |'
  prefs: []
  type: TYPE_TB
- en: '| 164 | 53 | Short | Female |'
  prefs: []
  type: TYPE_TB
- en: '| 155 | 46 | Long | Female |'
  prefs: []
  type: TYPE_TB
- en: '| 162 | 52 | Long | Female |'
  prefs: []
  type: TYPE_TB
- en: '| 166 | 55 | Long | Female |'
  prefs: []
  type: TYPE_TB
- en: '| 172 | 60 | Long | ? |'
  prefs: []
  type: TYPE_TB
- en: What is the probability that the 11th person, with a height of 172 cm, a weight
    of 60 kg, and long hair, is a man?
  prefs: []
  type: TYPE_NORMAL
- en: Analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Problem 1**: Before the patient is given the test, the probability that they
    have the virus is 4%, `P(virus)=4%=0.04`. The accuracy of the test is `test_accuracy=98%=0.98`.
    We apply the formula from the medical test example:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/dc1aa0f8-2719-43ef-b4f2-787caf38b22a.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/28e07d40-bc73-420b-b2d9-f34c6dc01780.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/e3cb7891-2def-442f-a927-7301ec9b898f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Therefore, we have the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/5aed8c3d-b9e3-4b07-9854-b9754706737d.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/b376c15a-2e14-4a7e-9d35-3ca0f8c3fb12.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/9ab31095-5143-42d8-944c-fb99a7237905.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/a4a11a40-2b4e-4508-8238-68ce149be36b.png)'
  prefs: []
  type: TYPE_IMG
- en: 'This means that there is a probability of about 67% that the patient has the
    virus, *V*, if the result of the test is positive:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/8fe1c210-e01c-4767-b2ff-85ff40b2884b.png)  ![](img/1da1d2dc-4191-4858-ad2c-8650ba72ef0e.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/81fada1b-643c-4a6a-b3b1-d40a8af050bf.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/3f8aa57e-59d5-4d3f-8c62-03b4a13d839b.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/42741e2f-5561-4559-a5e4-447886bddd91.png)'
  prefs: []
  type: TYPE_IMG
- en: If the test is negative, a patient can still have the virus, V, with a probability
    of 0.08%.
  prefs: []
  type: TYPE_NORMAL
- en: '**Problem 2**: Here, we can assume that symptoms and a positive test result
    are conditionally independent events given that a patient has the virus, *V*.
    The variables we have are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/f46385f4-8c9d-4542-a64b-26f4f91f5534.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/935aabe7-095c-4dd5-b8c9-0439eb6d2461.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/71046b30-50a7-41ba-9a27-31d49e523af1.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Since we have two independent random variables, we will use an extended Bayes''
    theorem:'
  prefs: []
  type: TYPE_NORMAL
- en: a) ![](img/8906397d-4a1c-4dba-b313-9dede2e3085f.png)
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/c78c1ea1-4431-4b95-9e0a-27b4ef2fa01a.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/621859bc-e83d-4d07-9928-c8f61b01a426.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/74c720e9-7880-48bd-ab49-bf0dc3b6ebd4.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/84f2c052-cd38-4316-9540-bb217c5703c6.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/81037bed-996f-47a3-827e-1b27f69f59bd.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/83aa2fcc-5511-41a8-8533-5fa7651ad7c6.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/afe1c7dd-5163-42aa-a5ab-d14103f8fb43.png)'
  prefs: []
  type: TYPE_IMG
- en: So, a patient with symptoms of the virus, *V*, and a positive test result for
    the virus has the virus with a probability of approximately 92%.
  prefs: []
  type: TYPE_NORMAL
- en: Note that in the previous question, we learned that a patient has the virus
    with a probability of only about 67%, given that the result of the test was positive.
    But after adding another independent random variable, the probability increased
    to 92%, even though the symptom assessment was reliable only on 85% of patients.
    This implies that usually, it is a very good idea to add as many independent random
    variables as possible to calculate the posterior probability with a higher accuracy
    and confidence.
  prefs: []
  type: TYPE_NORMAL
- en: 'b) Here, the patient has symptoms of the virus, *V*, but the result of the
    test is negative. Thus, we have the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/37316f38-35b8-4554-a249-d64fd87d3e2c.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/61381a17-2a9f-467b-aee1-786a38941113.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/e3876435-dc39-4adb-a5a9-b7318b1d5973.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/cb9b5a57-2971-4b5c-b96a-73736ef8f6cb.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/a927d5f6-5c02-4cb5-a8e5-e5c41220ec00.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/d33f112e-aa5c-45f6-bf06-90dc921f53fe.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/33a28454-1784-4cf6-b285-453db7c3d609.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/05029050-7378-4e07-8ca5-f21f8f6950d2.png)'
  prefs: []
  type: TYPE_IMG
- en: Thus, a patient testing negative with regard to the test, but with symptoms
    of the virus, *V*, has a probability of 0.48% of having the virus.
  prefs: []
  type: TYPE_NORMAL
- en: '**Problem 3**: We apply the basic form of Bayes'' theorem:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/35a6fedd-b2a7-4c7f-8ae6-84e76434a3f0.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/d3bc5df0-a7f0-4767-a795-edfdef073037.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/997c5842-638a-40d4-b7f0-c299188fc98f.png)'
  prefs: []
  type: TYPE_IMG
- en: There is a 33% chance that there will be a tsunami following the recorded earthquake.
  prefs: []
  type: TYPE_NORMAL
- en: Note that, here, we set *P(tsunami)* to be the probability of a tsunami happening
    on some particular day in the past 100 years. We used a day as a unit to calculate
    the probability *P(earthquake)* as well. If we changed the unit to an hour, week,
    month, and so on for both *P(tsunami)* and *P(earthquake)*, the result would still
    be the same. What is important in the calculation is the ratio *P(tsunami):P(earthquake)=4:6=2/3:1*,
    that is, that a tsunami is about 66% more likely to happen than an earthquake.
  prefs: []
  type: TYPE_NORMAL
- en: '**Problem 4**: We put the data into the program for calculating the posterior
    probability from the observations and get the following result:'
  prefs: []
  type: TYPE_NORMAL
- en: '*[[''No'', ''Yes'', ''Yes'', ''No'', {''Yes'': 0.0, ''No'': 1.0}]]*'
  prefs: []
  type: TYPE_NORMAL
- en: According to this calculation, a patient tested should not suffer from the virus.
    However, the probability of *'No'* seems quite high. It may be a good idea to
    get more data in order to obtain a more precise estimate of the probability of
    the patient being healthy.
  prefs: []
  type: TYPE_NORMAL
- en: '**Problem 5**:'
  prefs: []
  type: TYPE_NORMAL
- en: 'a) The result of the algorithm is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '*[[''Yes'', ''No'', ''Yes'', ''No'', ''Yes'', {''Yes'': 0.8459918784779665,
    ''No'': 0.15400812152203341}]]*'
  prefs: []
  type: TYPE_NORMAL
- en: So, according to the Naive Bayes algorithm, when applied to the data in the
    table, the email is spam with a probability of about 85%.
  prefs: []
  type: TYPE_NORMAL
- en: b)  This method may not be as good since the occurrence of certain words in
    a spam email is not independent. For example, spam emails containing the word
    "money" would likely try to convince the victim of a spam email that they could
    somehow get money from the spammer, and hence, other words, such as **Rich**,
    **Secret**, or **Free** are more likely to be present in such an email as well.
    The nearest neighbor algorithm would seem to perform better at spam email classification.
    You could verify the actual methods by using cross-validation.
  prefs: []
  type: TYPE_NORMAL
- en: '**Problem 6**: For this problem, we will use the extended Bayes'' theorem for
    both continuous and discrete random variables:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/1dde7a8e-2292-425d-a96e-fc6d4a267b73.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/ff8dcb78-c7fe-4b51-89af-c29cf6119772.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/7e147f51-fd63-49d4-8b98-885ff7da1b5e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Let''s summarize the given information in the following tables:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Gender** | **Mean height** | **Variance in height** |'
  prefs: []
  type: TYPE_TB
- en: '| Male | 176.8 | 37.2 |'
  prefs: []
  type: TYPE_TB
- en: '| Female | 163.4 | 30.8 |'
  prefs: []
  type: TYPE_TB
- en: '| **Gender** | **Mean weight** | **Variance in weight** |'
  prefs: []
  type: TYPE_TB
- en: '| Male | 72.4 | 53.8 |'
  prefs: []
  type: TYPE_TB
- en: '| Female | 53 | 22.5 |'
  prefs: []
  type: TYPE_TB
- en: 'From this data, let''s determine the other values that are needed to determine
    the final probability of the person being male:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/4169d7f0-2b98-4be7-bb83-f93516a68639.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/e930eaca-16dc-4eb5-a4a8-c4480e5c5cdc.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/2ee5daf0-4d30-4011-a807-86ec634c57ca.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/87adbc1d-9167-4ff7-98b0-f69fe0b8f48a.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/34dd87d9-edb2-487a-9db0-91c738e70049.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/d8b4bbc3-a624-4431-b26a-1ddd25b3dcae.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/04f46edb-81e8-4906-b580-791cff84a269.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/82ad2dd2-0646-4fda-846d-2ec00cbbcc9e.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/40791c73-f78d-4f41-ad07-fabbc077a486.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/81644091-b199-4490-8cc2-bf6916acb70b.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/8197cbba-e3fb-45e4-9037-8e1c0d2bfdcb.png)'
  prefs: []
  type: TYPE_IMG
- en: Therefore, the probability of a person with a height of 172 cm, a weight of
    60 kg, and long hair, being a male is 20.3%. Thus, they are more likely to be
    female.
  prefs: []
  type: TYPE_NORMAL

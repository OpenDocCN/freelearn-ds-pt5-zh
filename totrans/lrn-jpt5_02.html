<html><head></head><body>
        

                            
                    <h1 class="header-title">Jupyter Python Scripting</h1>
                
            
            
                
<p>Jupyter was originally IPython, an interactive version of Python to be used as a development environment. As such, most of the features of Python are available to you when developing your Notebook.</p>
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li> Basic Python scripting</li>
<li> Python dataset access (from a library)</li>
<li> Python pandas</li>
<li> Python graphics</li>
<li> Python random numbers</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Basic Python in Jupyter</h1>
                
            
            
                
<p>We must open a Python section of our Notebook to use Python coding. So, start your Notebook, and then in the upper-right menu, select Python 3:</p>
<div><img src="img/c47da8b7-1269-47b6-9750-be5bdea4b51e.png" style="width:14.00em;height:17.25em;"/></div>
<p class="mce-root"/>
<p>This will open a Python window to work in:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/e1bd59aa-a937-47e9-8f25-82c351e44d9e.png" style="width:46.00em;height:12.25em;"/></p>
<p>As mentioned in the previous chapter, the new window shows an empty cell so that you can enter Python code.</p>
<p>Let's give the new work area a name, <kbd>Learning Jupyter 5, Chapter 2</kbd>. Autosave should be on (as you can see next to the title). With an accurate name, we can find this section again easily from the Notebook home page. If you select your browser's Home tab and refresh it, you will see this new window name being displayed:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/a3ef1515-d01b-4f63-9445-b35fb0e27a88.png"/></p>
<p>Note that it has an Notebook icon versus a folder icon. The extension that's automatically assigned is <kbd>.ipynb</kbd> (Python Notebook). And, since the item is in a browser in a Jupyter environment, it is marked as running. There is a file by that name in your directory on the disk as well:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/8fdd1af0-d3a8-4943-9825-0e202a1c0363.png"/></p>
<p class="mce-root"/>
<p>If you open the <kbd>.ipynb</kbd> file in a text editor, you will see the basic contents of a Jupyter node (as mentioned in the <em>Notebook structure</em> section in <a href="5b555482-7a8c-4327-8d4a-b7223db52388.xhtml" target="_blank">Chapter 1</a>, <em>Introduction to Jupyter</em>). We have one empty cell and metadata about the Notebook:</p>
<pre>{ 
 "cells": [ 
 { 
   "cell_type": "code", 
   "execution_count": null, 
   "metadata": {}, 
   "outputs": [], 
   "source": [] 
  } 
 ], 
 "metadata": { 
  "kernelspec": { 
   "display_name": "Python 3", 
   "language": "python", 
   "name": "python3" 
  }, 
  "language_info": { 
   "codemirror_mode": { 
    "name": "ipython", 
    "version": 3 
   }, 
   "file_extension": ".py", 
   "mimetype": "text/x-python", 
   "name": "python", 
   "nbconvert_exporter": "python", 
   "pygments_lexer": "ipython3", 
   "version": "3.6.4" 
  } 
 }, 
 "nbformat": 4, 
 "nbformat_minor": 2 
} </pre>
<p>We can now enter Python coding into the cells. For example:</p>
<ul>
<li>Type in some Python in the first cell</li>
<li>Add another cell to the end (using the Insert Cell Above or Insert Cell Below menu command):</li>
</ul>
<pre style="padding-left: 60px">   name = "Dan" 
   age = 37 </pre>
<p class="mce-root"/>
<ul>
<li>And in the second cell, enter the Python code that references the variables from the first cell:</li>
</ul>
<pre style="padding-left: 90px">print(name + ' is ' + str(age) + ' years old.') </pre>
<ul>
<li> We will then have this display:</li>
</ul>
<p class="CDPAlignCenter CDPAlign"><img src="img/15352f6d-8b7f-4591-a2f9-fa80053525c8.png" style="width:33.00em;height:11.25em;"/></p>
<p>It's important to note that Jupyter color codes your Python (just as a decent editor would), and that we have these empty braces to the left of each code block.</p>
<p>If we execute Run All, the results are displayed inline:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/a5e9e5e1-00b3-4efb-abd8-9d3e20b8bcf0.png"/></p>
<p>We now have the braces filled in with cell numbers, and the output of cells is appended to the bottom of each cell. It's important to note that cell two was able to reference variables that were declared in cell one.</p>
<p>If we either wait for autosave to kick in or hit the save icon (the leftmost icon of a diskette), we will update the <kbd>.pynb</kbd> file on the disk with our results:</p>
<pre>{ 
 "cells": [ 
  { 
   "cell_type": "code", 
   "execution_count": null, 
   "metadata": {}, 
   "outputs": [], 
   "source": [ 
    "name = \"Dan\"\n", 
    "age = 37" 
   ] 
  }, 
  { 
   "cell_type": "code", 
   "execution_count": null, 
   "metadata": {}, 
   "outputs": [], 
   "source": [ 
    "print(name + ' is ' + str(age) + ' years old.')" 
   ] 
  } 
 ], 
 "metadata... as above </pre>
<p>It's interesting that Jupyter keeps track of the output last generated in the saved version of the file. You can also clear the output using the Cell| All Ouput | Clear command.</p>
<p>If you were then to rerun your cells (using Cell | Run All), the output would be regenerated (and saved via autosave). The cell numbering is incremented if you do this – Jupyter is keeping track of the latest version of each cell.</p>
<p>Similarly, if you were to close the browser tab, refresh the display in the Home tab, find the new item we created (<kbd>Learning Jupyter 5, Chapter 2.pynb</kbd>) and click on it, the new tab (as created previously) will be displayed, showing the outputs that we generated when we last run it.</p>
<p>If you open the server command-line window (where the Jupyter service is running), you will see a list of the actions that we have made during our session:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/c0a4138d-c1ea-4ed7-beba-0c1def638dac.png"/></p>
<p>The logging entries are at a high level. There may be a way to increase the logging level if there is some difficulty being encountered.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Python data access in Jupyter</h1>
                
            
            
                
<p>Now that we have seen how Python works in Jupyter, including the underlying encoding, how does Python access a large dataset of work in Jupyter?</p>
<p>I started another view for pandas, using Python data access as the name. From here, we will read in a large dataset and compute some standard statistics on the data. We are interested in seeing how we use pandas in Jupyter, how well the script performs, and what information is stored in the metadata (especially if it is a larger dataset).</p>
<p>Our script accesses the <kbd>iris</kbd> dataset that is built-in to one of the Python packages. All we are looking to do is read in a slightly large number of items and calculate some basic operations on the dataset. We are really interested to see how much of the data is cached in the <kbd>.pynb</kbd> file.</p>
<p>The Python code is as follows: </p>
<pre># import the datasets package 
from sklearn import datasets 
 
# pull in the iris data 
iris_dataset = datasets.load_iris() 
# grab the first two columns of data 
X = iris_dataset.data[:, :2] 
 
# calculate some basic statistics 
x_count = len(X.flat) 
x_min = X[:, 0].min() - .5 
x_max = X[:, 0].max() + .5 
x_mean = X[:, 0].mean() 
 
# display our results 
x_count, x_min, x_max, x_mean </pre>
<p>I broke these steps into a couple of cells in Jupyter:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/04922030-dd2e-46a9-9f64-02eae1c0e6a2.png"/></p>
<p class="mce-root"/>
<p>Now, run the cells (using Cell | Run All) and we will get the following display. The only difference is the last out line where our values are displayed:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/67517812-7148-4a11-8a1c-f2c20abe383d.png" style="width:42.75em;height:28.33em;"/></p>
<p>It seemed to take longer to load the library (the first time I ran the script) than to read the data and calculate the statistics.</p>
<p>If we look in the <kbd>.pynb</kbd> file for this Notebook, we can see that none of the data is cached in the <kbd>.pynb</kbd> file. We simply have code references to the library, our code, and the output from when we last calculated the script:</p>
<pre>{ 
 "cells": [ 
  { 
   "cell_type": "code", 
   "execution_count": 2, 
   "metadata": {}, 
   "outputs": [], 
   "source": [ 
    "# import the datasets package\n", 
    "from sklearn import datasets" 
   ] 
  }, 
  { 
   "cell_type": "code", 
   "execution_count": 3, 
   "metadata": {}, 
   "outputs": [], 
   "source": [ 
    "# pull in the iris data\n", 
    "iris_dataset = datasets.load_iris()\n", 
    "# grab the first two columns of data\n", 
    "X = iris_dataset.data[:, :2]" 
   ] 
  }, 
  { 
   "cell_type": "code", 
   "execution_count": 4, 
   "metadata": {}, 
   "outputs": [], 
   "source": [ 
    "# calculate some basic statistics\n", 
    "x_count = len(X.flat)\n", 
    "x_min = X[:, 0].min() - .5\n", 
    "x_max = X[:, 0].max() + .5\n", 
    "x_mean = X[:, 0].mean()" 
   ] 
  }, 
  { 
   "cell_type": "code", 
   "execution_count": 5, 
   "metadata": {}, 
   "outputs": [ 
    { 
     "data": { 
      "text/plain": [ 
       "(300, 3.8, 8.4, 5.843333333333334)" 
      ] 
     }, 
     "execution_count": 5, 
     "metadata": {}, 
     "output_type": "execute_result" 
    } 
   ], 
   "source": [ 
    "# display our results\n", 
    "x_count, x_min, x_max, x_mean" 
   ] 
  } 
 ]... </pre>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Python pandas in Jupyter</h1>
                
            
            
                
<p>One of the most widely used features of Python is pandas. The pandas are built-in libraries of data analysis packages that can be used freely. In this example, we will develop a Python script that uses pandas to see if there is any affect of using them in Jupyter.</p>
<p>I am using the Titanic dataset from <a href="https://www.kaggle.com/c/titanic/data" target="_blank">https://www.kaggle.com/c/titanic/data</a>. I am sure that the same data is available from a variety of sources.</p>
<p>Note that you have to sign up for <strong>Kaggle</strong> in order to download the data. It's free.</p>
<p>Here is our Python script that we want to run in Jupyter:</p>
<pre>from pandas import * 
training_set = read_csv('train.csv') 
training_set.head() 
male = training_set[training_set.Sex == 'male'] 
female = training_set[training_set.Sex =='female'] 
womens_survival_rate = float(sum(female.Survived))/len(female) 
mens_survival_rate = float(sum(male.Survived))/len(male) <br/>womens_survival_rate, mens_survival_rate</pre>
<p>The result is that we calculate the survival rates of the passengers based on sex.</p>
<p>We create a new Notebook, enter the script into the appropriate cells, include adding displays of calculated data at each point, and produce our results.</p>
<p>Here is our Notebook laid out, where we added displays of calculated data at each cell:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/662c6bd0-e8af-4ab8-8035-7adf3a2e1f88.png"/></p>
<p>When I ran this script, I had two problems:<br/>
<br/>
On Windows, it is common to use a backslash (<kbd>\</kbd>) to separate parts of a filename. However, this coding uses the backslash as a special character. So, I had to change over to using a forward slash (<kbd>/</kbd>) in my <kbd>.csv</kbd> file path.<br/>
<br/>
The dataset column names are taken directly from the file and are case-sensitive. In this case, I was originally using the <kbd>sex</kbd> field in my script, but in the <kbd>.csv</kbd> file, the column is named <kbd>Sex</kbd>. Similarly, I had to change <kbd>survived</kbd> to <kbd>Survived</kbd>.</p>
<p class="mce-root"/>
<p>The final script and results look like this when we run it:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/a7051258-a2c7-4cb3-b5ad-0310a852d356.png"/></p>
<p>I have used the <kbd>head()</kbd> function to display the first few lines of the dataset. It is interesting the amount of detail that is available for all of the passengers.</p>
<p>If you scroll down, you will see the results:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/62b99992-e518-4740-a37b-8c4f95af9d6d.png"/></p>
<p>We can see that 74% of the survivors were women versus just 19% men. I would like to think that chivalry is not dead.</p>
<p>It's curious that the results do not total to 100%. However, like every other dataset I have seen, there is missing and/or inaccurate data present.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Python graphics in Jupyter</h1>
                
            
            
                
<p>How do Python graphics work in Jupyter?</p>
<p>I started another view for this named Python graphic<em>s</em> so as to distinguish the work.</p>
<p>If we were to build a sample dataset of baby names and the number of births in a year of that name, we could then plot the data.</p>
<p>The Python coding is simple:</p>
<pre>import pandas 
import matplotlib 
 
%matplotlib inline 
 
# define our two columns of data 
baby_name = ['Alice','Charles','Diane','Edward'] 
number_births = [96, 155, 66, 272] 
 
# create a dataset from the to sets 
dataset = list(zip(baby_name,number_births)) 
dataset 
 
# create a Python dataframe from the dataset 
df = pandas.DataFrame(data = dataset, columns=['Name', 'Number']) 
df 
 
# plot the data 
df['Number'].plot() </pre>
<p>The steps for the script are as follows:</p>
<ol>
<li>Import the graphics library (and data library) we need</li>
<li>Define our data</li>
<li>Convert the data into a format that allows for an easy graphical display</li>
<li>Plot the data</li>
</ol>
<p>We would expect a resultant graph of the number of births by baby name.</p>
<p>Taking the previous script and placing it into cells of our Jupyter node, we get something that looks like this:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/5798f7b5-1fec-4c5e-820e-d24a2bf3c82b.png" style="width:61.67em;height:35.50em;"/></p>
<ul>
<li>I have broken the script into different cells for easier readability. Having different cells also allows you to develop the script easily, step-by-step, where you can display the values computed so far to validate your results. I have done this in most of the cells by displaying the dataset and dataframe at the bottom of those cells.</li>
<li>When we run this script (Cell | Run All), we can see the results at each step being displayed as the script progresses:</li>
</ul>
<p class="CDPAlignCenter CDPAlign"><img src="img/312b8b3f-503f-449a-91ef-b5b134eefba4.png" style="width:56.25em;height:37.83em;"/></p>
<ul>
<li>And finally, we can see our plot of the births:</li>
</ul>
<p class="CDPAlignCenter CDPAlign"><img src="img/936fed00-074c-40d3-9a76-4c9a7a4fea33.png" style="width:52.67em;height:20.75em;"/></p>
<p class="mce-root"/>
<ul>
<li>I was curious about what metadata was stored for this script. Looking into the <kbd>.ipynb</kbd> file, you can see the expected value for the formula cells.</li>
<li>The tabular data display of the dataframe is stored as HTML convenient:</li>
</ul>
<pre style="padding-left: 60px">...{ 
   "cell_type": "code", 
   "execution_count": 4, 
   "metadata": {}, 
   "outputs": [ 
    { 
     "data": { 
      "text/html": [ 
       "&lt;div&gt;\n", 
       "&lt;style scoped&gt;\n", 
       "    .dataframe tbody tr th:only-of-type {\n", 
       "        vertical-align: middle;\n", 
       "    }\n", 
       "\n", 
       "    .dataframe tbody tr th {\n", 
       "        vertical-align: top;\n", 
       "    }\n", 
       "\n", 
       "    .dataframe thead th {\n", 
       "        text-align: right;\n", 
       "    }\n", 
       "&lt;/style&gt;\n", 
       "&lt;table border=\"1\" class=\"dataframe\"&gt;\n", 
       "  &lt;thead&gt;\n", 
       "    &lt;tr style=\"text-align: right;\"&gt;\n", 
       "      &lt;th&gt;&lt;/th&gt;\n", 
       "      &lt;th&gt;Name&lt;/th&gt;\n", 
       "      &lt;th&gt;Number&lt;/th&gt;\n", 
       "    &lt;/tr&gt;\n",... </pre>
<ul>
<li>The graphic output cell is stored like this:</li>
</ul>
<pre style="padding-left: 60px">  { 
     { 
   "cell_type": "code", 
   "execution_count": 5, 
   "metadata": {}, 
   "outputs": [ 
    { 
     "data": { 
      "text/plain": [ 
       "&lt;matplotlib.axes._subplots.AxesSubplot at 0x1822deb44a8&gt;" 
      ] 
     }, 
     "execution_count": 5, 
     "metadata": {}, 
     "output_type": "execute_result" 
    }, 
    { 
     "data": { 
      "image/png": "iVBORw0... 
"&lt;a hundred lines of hexcodes&gt; 
...VTRitYII=\n", 
      "text/plain": [ 
       "&lt;matplotlib.figure.Figure at 0x1822e26a828&gt;" 
      ] 
     },... </pre>
<p>Where the <kbd>image/png</kbd> tag contains a large hex digit string representation of the graphical image displayed on screen (I abbreviated the display in the coding that's shown). So, the actual generated image is stored in the metadata for the page.</p>
<p>So, rather than a cache, Jupyter is remembering the output from when each cell was last executed.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Python random numbers in Jupyter</h1>
                
            
            
                
<p>For many analyses, we are interested in calculating repeatable results. However, much of this analysis relies on some random numbers being used. In Python, you can set <kbd>seed</kbd> for the random number generator to achieve repeatable results with the <kbd>random.seed()</kbd> function.</p>
<p>In this example, we simulate rolling a pair of dice and look at the outcome. We would expect the average total of the two dice to be six, which is the half-way point between the faces.</p>
<p>The script we are using is as follows:</p>
<pre># using pylab statistics and histogram<br/>import pylab<br/>import random<br/><br/># set random seed so we can reproduce results<br/>random.seed(113)<br/>samples = 1000<br/><br/># declare our dataset store<br/>dice = []<br/><br/># generate and save the samples<br/>for i in range(samples):<br/>    total = random.randint(1,6) + random.randint(1,6)<br/>    dice.append(total)<br/><br/># compute some statistics on the dice throws<br/>print("Throw two dice", samples, "times.")<br/>print("Mean of", pylab.mean(dice))<br/>print("Median of", pylab.median(dice))<br/>print("Std Dev of", pylab.std(dice))<br/><br/># display a histogram of the results<br/>pylab.hist(dice, bins= pylab.arange(1.5,12.6,1.0))<br/>pylab.xlabel("Pips")<br/>pylab.ylabel("Count")<br/>pylab.show()</pre>
<p>Once we have the script in Jupyter and execute it, we will get the following result:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/8691328d-6cb5-48d2-a554-b1a59a303926.png"/></p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>I added some more statistics. I'm not sure that I would have counted on such a high standard deviation. If we increased the number of <kbd>samples</kbd>, this would decrease.</p>
<p>The resulting graph was opened in a new window, much as it would if you ran this script in another Python development environment:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/8b018639-3a67-454b-81c1-a47a5aa9c928.png"/></p>
<p>The graphic looks a little more jagged than I would have expected for a thousand samples.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Summary</h1>
                
            
            
                
<p>In this chapter, we walked through a simple Notebook and the underlying structure. Then, we saw an example of using pandas and looked at a graphics example. Finally, we looked at an example using random numbers in a Python script.</p>
<p>In the next chapter, we will learn about R scripting in a Jupyter Notebook.</p>


            

            
        
    </body></html>
<html><head></head><body>
        

                            
                    <h1 class="header-title">Measuring Healthcare Quality</h1>
                
            
            
                
<p>This chapter is intended for all audiences and will show you how healthcare providers are evaluated and rewarded/penalized under current value-based programs in the US. We will look at examples of actual provider data that's been downloaded from the web and wrangle it all using Python to extract the information we need. By the end of this chapter, you will be able to locate provider-based data on a given program of interest and manipulate it in <kbd>pandas</kbd> to identify those providers who are high-performing and those who could benefit from an analytic solution.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Introduction to healthcare measures</h1>
                
            
            
                
<p>A <strong>healthcare measure</strong> is a calculation made on the care activities of a provider that indicates the level of quality provided by the caregiver. As providers are increasingly being rewarded based on the quality rather than the quantity of services they provide, healthcare measures are playing a more important role in determining which care providers are rewarded or penalized. The <strong>Centers for Medicare and Medicaid Services</strong> (<strong>CMS</strong>) is just one of the federal-level agencies in the United States that publishes standardized measures; in addition, states publish measures as well. Providers calculate the measures using the data of their own patients and then submit their calculations to be audited by the issuing agency. The results partially determine how the providers are reimbursed by the agency.</p>
<p>A typical measure in healthcare is usually a ratio or percentage that correlates with care quality. There are typically two parts that make up a measure: a <strong>numerator</strong> and a <strong>denominator</strong>. The denominator is some quantification of the eligible population or number of encounters that were seen by the provider during a specific time range. Determining the denominator usually involves applying <strong>inclusion criteria</strong> and/or <strong>exclusion criteria</strong> to the overall provider population to reach the desired measurement population or encounter pool. Once the denominator is determined, the numerator is calculated based on the number of items in the denominator that received a certain positive or negative outcome or event.</p>
<p class="mce-root"/>
<p>This outcome or event is usually suggested by basic and/or clinical research as being a recommended part of patient care (or a marker for adverse care). Finally, dividing the numerator by the denominator yields the final percentage. This percentage may be used on a standalone basis or may be integrated into more complex formulas and weighting schemes with other measures to determine an overall quality score.</p>
<p>For example, an agency that wishes to measure the quality of diabetes care provided by outpatient facilities in a state could start composing a measure by surveying the literature for diabetes care recommendations. Among other things, diabetes patients are supposed to receive multiple foot examinations (to check for ulcers and nerve damage) and hemoglobin-A1c tests (to check for elevated blood glucose) during each year. To calculate the denominator, the inclusion criteria are that the patient has received an ICD code diagnosis of diabetes mellitus at least once in the past year. The agency only wants to consider the standard adult population; therefore, children less than 18 years of age and elderly adults greater than 65 years of age will be excluded. One clinic may have 4,000 patients overall, of which 500 meet these criteria; 500 is then the denominator for this measure. There are then two numerators to calculate:</p>
<ul>
<li>The number of these patients who received at least three foot exams in the past year</li>
<li>The number of these patients who received at least two HgbA1c tests during the past year</li>
</ul>
<p>For example, let's say that the numbers for our clinic are 350 and 400, respectively. The final measures are 350/500 = 0.70 for diabetic foot exam performance and 400/500 = 0.80 for diabetic blood work measurement. These can then be averaged together to give an overall rating of 0.75 for diabetes care at this clinic.</p>
<p>Measures have their share of problems; no measure is above loopholes that allow providers to manipulate their measurement scores without really improving care. Also, many measures may unfairly penalize providers who may have had patients act against medical advice or refuse proper treatment. However, if care quality is to be rewarded, then there must be a way to quantify care quality, and measures in healthcare are an important means of achieving that.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">US Medicare value-based programs</h1>
                
            
            
                
<p>In <a href="71c31b0a-fa9e-4b31-8b58-f563a815e338.xhtml" target="_blank">Chapter 2</a>, <em>Healthcare Foundations</em>, we discussed that a <strong>fee-for-service</strong> (<strong>FFS</strong>) reimbursement model has been used in medicine, in which physicians are reimbursed by the volume of care they provided rather than the value of that care. More recently, there has been a push toward rewarding providers based on the quality of care rather than the quantity of care given.</p>
<p>In order to facilitate the movement from FFS reimbursement to value-based reimbursement, the CMS has implemented value-based programs. These programs reward or penalize providers for the quality of care that they provide to Medicare patients. In 2018, there are a total of eight such programs. They are the following:</p>
<ul>
<li><strong>The Hospital Value-Based Purchasing (HVBP) program</strong> </li>
<li><strong>The Hospital Readmission Reduction (HRR) program</strong> </li>
<li><strong>The Hospital Acquired Conditions (HAC) program</strong> </li>
<li><strong>The End-Stage Renal Disease (ESRD) quality initiative  program</strong> </li>
<li><strong>The Skilled Nursing Facility Value-Based Program</strong> (<strong>SNFVBP</strong>)</li>
<li><strong>The Home Health</strong> <strong>Value-Based Program</strong> (<strong>HHVBP</strong>)</li>
<li><strong>Alternative Payment Models</strong> (<strong>APMs</strong>)</li>
<li><strong>The Merit-Based Incentive Payment System</strong> (<strong>MIPS</strong>)</li>
</ul>
<p>In the following sections, we will take a detailed look at these programs.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">The Hospital Value-Based Purchasing (HVBP) program</h1>
                
            
            
                
<p>The HVBP program rewards hospitals with incentive payments for the quality of care they give to Medicare patients. The HVBP program was enacted through the Affordable Care Act in 2010 and began in 2012.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Domains and measures</h1>
                
            
            
                
<p>In 2018, there are approximately 20 measures in the HVBP program that span four different domains of hospital care quality. The list is ever expanding and will include approximately 25 measures by 2023. Let's take a look at each domain and measure here.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">The clinical care domain</h1>
                
            
            
                
<p>The clinical care domain measures clinical care quality predominantly by using mortality measures. The <strong>mortality rate</strong> refers to the patient death rate for a specific disease. There are five mortality measures used in this domain (listed here). The sixth measure is the complications rate for the total hip/knee arthroplasty (a.k.a. replacement) procedure:</p>
<ul>
<li><strong>MORT-30-AMI</strong>: 30-day mortality for patients that have an acute myocardial infarction</li>
<li><strong>MORT-30-HF</strong>: 30-day mortality for patients that have heart failure</li>
<li><strong>MORT-30-PN</strong>: 30-day mortality for patients that have pneumonia</li>
<li><strong>THA/TKA</strong>: The number of THA/TKA procedures with complications</li>
<li><strong>MORT-30-COPD</strong>: 30-day mortality for patients that have COPD</li>
<li><strong>MORT-30-CABG</strong>: 30-day mortality for patients that undergo coronary artery bypass grafting</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">The patient- and caregiver-centered experience of care domain</h1>
                
            
            
                
<p>The measures in the patient- and caregiver-centered experience of care domain are determined using information from the <strong>Hospital Consumer Assessment of Healthcare Providers and Systems</strong> (<strong>HCAHPS</strong>) survey. The HCAHPS survey is administered to a random sample of Medicare patients shortly after they are discharged from the hospital. More than a dozen questions focus on the eight measures listed here:</p>
<ul>
<li>Communication with nurses</li>
<li>Communication with doctors</li>
<li>Responsiveness of hospital staff</li>
<li>Communication about medicines</li>
<li>Cleanliness and quietness of the hospital environment</li>
<li>Discharge information</li>
<li>Overall rating of hospital</li>
<li>Three-item care transition</li>
</ul>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mceNonEditable"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Safety domain</h1>
                
            
            
                
<p>The measures in this domain evaluate the safeness of hospitals for incidents such as adverse events and nosocomial infections. All of the measures in this domain are described in the later section on the HAC program (except for the PC-01 measure, which is described as follows):</p>
<ul>
<li><strong>AHRQ Composite (PSI-90)</strong>: Please see the section on the HAC program for a detailed description.</li>
<li><strong>Catheter-associated urinary tract infection (CAUTI)</strong>: Please see the section on the HAC program for a detailed description.</li>
<li><strong>Central line-associated bloodstream infection (CLABSI)</strong>: Please see the section on the HAC program for a detailed description.</li>
<li><strong>Clostridium difficile infecti</strong>o<strong>n (CDI)</strong>: Please see the section on the HAC program for a detailed description.</li>
<li><strong>Methicillin-resistant Staphylococcus aureus infection (MRSA)</strong>: Please see the section on the HAC program for a detailed description.</li>
<li><strong>Surgical site infection (SSI)</strong>: Please see the section on the HAC program for a detailed description.</li>
<li><strong>PC-01 – Elective delivery prior to 39 weeks completed gestation</strong>: Guidelines recommend that pregnancies are delivered as close as possible to 40 weeks.</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Efficiency and cost reduction domain</h1>
                
            
            
                
<p>The four measures in this domain examine the cost of care associated with each hospital. One measure (MSPB) relates to overall spending per patient; the three remaining measures pertain to spending for three specific conditions:</p>
<ul>
<li><strong>Medicare spending per beneficiary</strong> (<strong>MSPB</strong>)</li>
<li><strong>Acute myocardial infarction</strong> (<strong>AMI</strong>) payment</li>
<li><strong>Heart failure</strong> (<strong>HF</strong>) payment</li>
<li><strong>Pneumonia</strong> (<strong>PN</strong>) payment</li>
</ul>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">The Hospital Readmission Reduction (HRR) program</h1>
                
            
            
                
<p>An alternative way to measure inpatient care quality is by using the readmission rate of hospitals for patients diagnosed with specific conditions during their initial (index) visits. It is expected that if patients are receiving proper care at the facility for those specific conditions, the readmission rate will be at or below an acceptable rate. Rates higher than a baseline rate are subject to lower reimbursements. Accordingly, the HRR program started in 2012. It is a program that provides incentive payments (up to 3% of their prospective inpatient payments from Medicare) to hospitals that reduce their inpatient 30-day readmission rates for the following conditions:</p>
<ul>
<li><strong>Acute myocardial infarction</strong> (<strong>AMI</strong>)</li>
<li><strong>Heart failure</strong> (<strong>HF</strong>)</li>
<li><strong>Pneumonia</strong> (<strong>PN</strong>)</li>
<li><strong>Chronic obstructive pulmonary disease</strong> (<strong>COPD</strong>)</li>
<li><strong>Total hip</strong>/<strong>knee arthoplasty</strong> (replacement) (<strong>THA</strong>/<strong>TKA</strong>)</li>
<li><strong>Coronary artery bypass graft surgery</strong> (<strong>CABG</strong>)</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">The Hospital-Acquired Conditions (HAC) program</h1>
                
            
            
                
<p>Yet another method for measuring inpatient care quality is to consider the number of nosocomial or iatrogenic illnesses at that facility. An <strong>iatrogenic</strong> condition is one that is caused by medical examination or treatment, while a <strong>nosocomial</strong> illness refers to an illness (usually an infection) originating at a hospital. Often, nosocomial infections are resistant to multiple antibiotics and are quite difficult to treat.</p>
<p>Under the HACRP, which started in 2014, hospitals are penalized 1% of their total Medicare payments if their patients are at a high risk of getting hospital-acquired infections. More specifically, hospitals that meet a certain score threshold based on how often their patients get five common healthcare-acquired infections and their AHRQ <strong>Patient Safety Indicator</strong> (<strong>PSI</strong>) 90 composite measure performance are eligible for a 1% reduction in Medicare reimbursement.</p>
<p class="mce-root"/>
<p>There are six measures comprising the HAC program that span two domains of care. Five of the six measures relate to infection rates for patients at hospitals. The sixth measure is a composite measure that looks at a variety of adverse patient safety events.</p>
<p>We will now take a more detailed look at the domains and measures.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">The healthcare-acquired infections domain</h1>
                
            
            
                
<p>The five healthcare-acquired infections are the following:</p>
<ul>
<li><strong>Catheter-associated urinary tract infection (CAUTI)</strong>: A CAUTI occurs when a urinary catheter is inserted into the urethra using the improper (aseptic) technique, causing germs to colonize the urinary tract.</li>
<li><strong>Central line-associated bloodstream infection (CLABSI)</strong>: Similarly, a CLABSI occurs when a central line is improperly inserted into the body, causing germs to colonize the blood (<strong>sepsis</strong>).</li>
<li><strong>Clostridium difficile infection (CDI)</strong>: Sick patients who are being treated at hospitals for infections are highly susceptible to the clostridium difficile bacterium, which colonizes the GI tract after antibiotic therapy wipes out the native GI flora. Poor sanitary conditions and improper washing of hands among medical personnel are additional risk factors for C. difficile infection.</li>
<li><strong>Methicillin-resistant <em>Staphylococcus aureus</em> (MRSA) infection</strong>: MRSA is a common, particularly virulent strain of the S. aureus bacterium that commonly infects the skin and blood and is resistant to multiple antibiotics. It is commonly contracted in hospitals and can be avoided by rapid treatment and care to avoid transmission.</li>
<li><strong>Surgical site infection (SSI)</strong>: This results from improper sterilization techniques during or after surgeries, resulting in infection of the wound or surgical site.</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">The patient safety domain</h1>
                
            
            
                
<p>The PSI 90 is a patient safety/complication measure produced by the <strong>Agency for</strong> <strong>Healthcare Research and Quality</strong> (<strong>AHRQ</strong>). In 2017, it measured the patient safety and complication rates at hospitals using 10 measures:</p>
<ul>
<li><strong>PSI 03: Pressure Ulcer Rate</strong>: Pressure ulcers are skin lesions that form when the patient has been in a bed in the same position for too long. It is commonly used as a measure of hospital care quality/neglect.</li>
<li><strong>PSI 06: Iatrogenic Pneumothorax Rate</strong>: A pneumothorax is a tear in the lung wall that causes air to fill up in the cavity surrounding the lung, preventing the patient from breathing properly. Some pneumothoraces are caused by hospital procedures and these are known as iatrogenic pneumothoraces.</li>
<li><strong>PSI 08: In-Hospital Fall with Hip Fracture Rate</strong>: Falls are common in elderly patients in hospitals, especially following an operation or procedure. There are certain precautions that can be taken to prevent falls in such patients, and hospitals that fail to do so are often labeled as providing poor quality of care.</li>
<li><strong>PSI 09: Perioperative Hemorrhage or Hematoma Rate</strong>: This measure gauges the amount of excessive bleeding that occurs when patients undergo procedures at the hospital.</li>
<li><strong>PSI 10: Postoperative Acute Kidney Injury Rate</strong>: Following procedures or operations, patients are at risk for injury to their kidneys due to decreased blood flow or harmful contrast agents for x-rays.</li>
<li><strong>PSI 11: Postoperative Respiratory Failure Rate</strong>: Following an operation, complications also include respiratory failure, which is a life-threatening condition that requires placing the patient on a ventilator under anesthesia and constant supervision in an <strong>intensive care unit</strong> (<strong>ICU</strong>). Respiratory failure incidents can be reduced by coaching patients to perform proper breathing exercises.</li>
<li><strong>PSI 12: Perioperative Pulmonary Embolism (PE) or Deep Vein Thrombosis (DVT) Rate</strong>: DVT is a blood clot that forms in the veins of the lower leg muscles. Pulmonary embolism is when the clot travels via the bloodstream to the lung and is a life-threatening complication. Many DVTs can be prevented by administering heparin and other treatments during the hospital stay and encouraging the patient to be active.</li>
<li><strong>PSI 13: Postoperative Sepsis Rate</strong>: This measure gauges how often patients that undergo operations at the hospital get infected after the operation. Sepsis is a life-threatening condition in which bacteria have colonized the bloodstream and are affecting organ function.</li>
<li><strong>PSI 14: Postoperative Wound Dehiscence Rate</strong>: Wound dehiscence is the failure of the operative site to close or heal correctly following the surgery. It is a sign of poor surgical procedure and/or poor nutrition following the surgery.</li>
<li>P<strong>SI 15: Unrecognized Abdominopelvic Accidental Puncture/Laceration Rate</strong>: This measure gauges the frequency with which accidental punctures/lacerations occur during abdominal or pelvic surgery.</li>
</ul>
<p>More information can be found at <a href="https://www.qualityindicators.ahrq.gov/News/PSI90_Factsheet_FAQ.pdf">https://www.qualityindicators.ahrq.gov/News/PSI90_Factsheet_FAQ.pdf</a>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">The End-Stage Renal Disease (ESRD) quality incentive program</h1>
                
            
            
                
<p>The ESRD quality incentive program measures the quality of care received at dialysis centers by Medicare ESRD patients. There are a total of 16 measures: 11 clinical and 5 reporting, and they are detailed here:</p>
<ul>
<li><strong>NHSN bloodstream infection in hemodialysis outpatients</strong>: Infections may occur from hemodialysis when the improper sterilization technique is used. This measure examines the number of infections that occur (the numerator) and compares it to the expected amount (the denominator).</li>
<li><strong>ICH CAHPS</strong>: This measure examines the quality of care received at the dialysis center through assessment of patient survey responses.</li>
<li><strong>Standardized readmission ratio</strong>: The standardized readmission ratio is the number of actual unplanned 30-day readmissions divided by the expected unplanned 30-day readmissions.</li>
<li><strong>Kt/V dialysis adequacy measure – hemodialysis</strong>: Kt/V is a formula that quantifies the dialysis treatment adequacy. The four Kt/V measures examine how many treatment sessions met a certain Kt/V threshold for different dialysis patient populations:
<ul>
<li><strong>Kt/V dialysis adequacy measure – Peritoneal dialysis</strong></li>
<li><strong>Kt/V dialysis adequacy measure – Pediatric hemodialysis</strong></li>
<li><strong>Kt/V dialysis adequacy measure – Pediatric peritoneal dialysis</strong></li>
</ul>
</li>
<li class="mce-root"><strong>Standardized transfusion ratio</strong>: This measure compares the number of actual versus expected red blood cell transfusions in dialysis patients (blood transfusions are undesirable consequences of dialysis).</li>
<li><strong>Vascular access – Fistula</strong>: The vascular access measures quantify whether or not proper access was provided to the patient's bloodstream. The Fistula measure evaluates how many arteriovenous fistula sites used two needles for access.</li>
<li><strong>Vascular access – Catheter</strong> - The Catheter measure determines how many of the catheters have been present in the patient for more than 90 days, which is an infection risk.</li>
<li><strong>Hypercalcemia</strong>: This measure looks at how many months for which patients experienced hypercalcemia, an adverse effect of dialysis.</li>
<li><strong>Mineral metabolism reporting</strong>: The five reporting measures examine how well various aspects of the dialysis patient's care were reported by each facility. The measures examine mineral metabolism reporting, anemia management reporting, pain assessment, depression screening, and flu vaccine for personnel reporting:
<ul>
<li>Anemia management reporting</li>
<li>Pain assessment and follow-up reporting</li>
<li>Clinical depression screening and follow-up reporting</li>
<li>Flu vaccine for personnel reporting</li>
</ul>
</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">The Skilled Nursing Facility Value-Based Program (SNFVBP)</h1>
                
            
            
                
<p>The SNFVBP is scheduled to start in 2019. It will base Medicare reimbursement from the government to SNFs partially on two outcome-related measures:</p>
<ul>
<li>The 30-day all-cause readmission rate</li>
<li>The 30-day potentially preventable readmission rate</li>
</ul>
<p>The rates apply to residents of SNFs who are admitted to other hospitals. When this program begins SNFs could benefit from collaborating with machine learning practitioners who predict which patients are at risk for readmission.</p>
<p>More information about the SNFVBP can be found at the following link: <a href="https://www.cms.gov/Medicare/Quality-Initiatives-Patient-Assessment-Instruments/Value-Based-Programs/Other-VBPs/SNF-VBP.html">https://www.cms.gov/Medicare/Quality-Initiatives-Patient-Assessment-Instruments/Value-Based-Programs/Other-VBPs/SNF-VBP.html</a>.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">The Home Health Value-Based Program (HHVBP)</h1>
                
            
            
                
<p>The HHVBP was started in January 2016 in nine of the 50 US states. It provides payment adjustments to Medicare-certified <strong>Home Health Agencies</strong> (<strong>HHAs</strong>) based on the quality of their care. The program will use 22 measures to gauge the quality of care provided by the HHAs. These measures include survey, process, and outcome measures, and include those for ED utilization and unplanned hospitalizations.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">The Merit-Based Incentive Payment System (MIPS)</h1>
                
            
            
                
<p>MIPS is a value-based program for individual and group outpatient physician practices. It is a program that started in 2017, and it was enacted by the MACRA Act of 2015. Together with the APMs program, MIPS comprises Medicare's <strong>Quality Payment Program</strong> (<strong>QPP</strong>). It replaces and consolidates previous value-based programs, such as the <strong>Physician Quality Reporting System</strong> (<strong>PQRS</strong>) and the <strong>Value Modifier (VM) </strong>program. Provider groups are required to participate in MIPS if they bill a certain amount from or have a certain amount of Medicare patients. In MIPS, providers are evaluated based on four categories:</p>
<ul>
<li>Quality</li>
<li>Advancing care information</li>
<li>Improvement activities</li>
<li>Cost</li>
</ul>
<p>The breakdown for determining a practice's final MIPS score for 2017 is the following: 60% quality, 25% advancing care information, and 15% improvement activities. Beginning in 2018, the cost will also determine the final MIPS score.</p>
<p>Let's take a detailed look at the four performance categories.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Quality</h1>
                
            
            
                
<p>For the quality category, providers choose six measures from a list that includes 271 measures as of 2018. Examples of measures include <em>Acute Otitis Externa (ear infection): Topical Therapy</em> and <em>Varicose Vein Treatment with Saphenous Ablation: Outcome Survey</em>. All medical specialties are represented so that providers can choose the measures most suitable for them. The providers then collect and submit the data corresponding to the specifications of the measure.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Advancing care information</h1>
                
            
            
                
<p>This category includes measures that are related to advancing health information technology. There are 15 measures in this category. Examples of measures include reconciling patient information, reporting clinical data to a data registry, and prescribing medication electronically.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Improvement activities</h1>
                
            
            
                
<p>For this category, providers must demonstrate that they have taken steps to improve their practices in the areas of care coordination, patient engagement, and patient safety. Providers must demonstrate that they have completed up to four measures for 3 months.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Cost</h1>
                
            
            
                
<p>For the final category, the cost of care will be determined from claims data, and providers who provide the most efficient care will be rewarded. The inclusion of this category into the MIPS final score will begin in 2018.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Other value-based programs</h1>
                
            
            
                
<p>Aside from the value-based programs discussed above that are administered by the CMS, there are also additional programs that are administered by other agencies. Let's take a look at those here.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">The Healthcare Effectiveness Data and Information Set (HEDIS)</h1>
                
            
            
                
<p>The HEDIS is used to measure the quality of health insurance plans. It is administered by the <strong>National Committee for Quality Assurance</strong> (<strong>NCQA</strong>). The HEDIS includes approximately 90 measures that cover virtually every medical specialty. Many of the measures share features with those already discussed previously, or with the 271 measures found in the clinical care category of MIPS.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">State measures</h1>
                
            
            
                
<p>In 2018, almost every state has some form of value-based programs and incentives. Often, these programs apply to Medicaid patients, since Medicaid is often administered at the state level. Many states also adopt federally published measures and tweak them for their own use. For example, the State of Georgia funds the Georgia Families program (<a href="https://dch.georgia.gov/georgia-families">https://dch.georgia.gov/georgia-families</a>), which allows Georgia Medicaid patients to choose health insurance plans. It sets goals and measures effectiveness by using HEDIS measures.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Comparing dialysis facilities using Python</h1>
                
            
            
                
<p>In the previous section, we outlined the value-based incentive programs implemented by the CMS. One of those programs was the ESRD<strong> </strong>quality incentive program, which financially rewards dialysis facilities based on the quality of care that they provide to Medicare patients with ESRD. We described 16 measures by which each ESRD case is evaluated.</p>
<p>In this section, we will download the data published by the CMS on dialysis center performance across the US. We will use Python commands to wrangle this data to extract the information we can use to find out which centers are performing well and which ones may benefit from an analytic solution. Proper targeting of marketing and sales efforts will increase the efficiency of analytic solutions.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Downloading the data</h1>
                
            
            
                
<p>To download the dialysis facility comparison data, complete the following steps.</p>
<ol>
<li>Navigate to the following URL: <a href="https://data.medicare.gov/">https://data.medicare.gov/data/dialysis-facility-compare</a>. </li>
<li>Locate the blue button on the page that is labeled DOWNLOAD CSV FLAT FILES (REVISED) NOW. (To get the right year, you may have to select the GET ARCHIVED DATA button instead). Click the button. A <kbd>.zip</kbd> file will begin to download.</li>
<li>Extract the <kbd>.zip</kbd> file using the appropriate Windows/Mac program or Linux command.</li>
<li>Take note of the directory and path for the file named <kbd>ESRD QIP - Complete QIP Data - Payment Year 2018.csv</kbd>.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">Importing the data into your Jupyter Notebook session</h1>
                
            
            
                
<p>To import the <kbd>.csv</kbd> file into a Jupyter Notebook session, open the Jupyter Notebook program as we did in <a href="b15b2b73-d2bb-410f-ab55-5f0f1e91730e.xhtml" target="_blank">Chapter 1</a>, <em>Introduction to Healthcare Analytics</em>. Open a new notebook. Then, in the first cell, type the following (substituting in your file path for that which is shown here) and hit the Play button:</p>
<pre>import pandas as pd<br/><br/>df = pd.read_csv(<br/>    'C:\\Users\\Vikas\\Desktop\\Bk\\Data\\DFCompare_Revised_FlatFiles\\' + <br/>    'ESRD QIP - Complete QIP Data - Payment Year 2018.csv', header=0<br/>)</pre>
<p>The preceding code uses the <kbd>read_csv()</kbd> function of the <kbd>pandas</kbd> library to import the <kbd>.csv</kbd> file as a DataFrame. The <kbd>header</kbd> parameter tells the notebook that the first line contains column names.</p>
<p>Notice that the backslashes appear in groups of two. That is because <kbd>\</kbd> is an escape character in Python. Also, notice that the filename was too long to fit in one line. In Python, statements can encompass multiple lines without special treatment as long as the break is enclosed by parentheses and certain other punctuation.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Exploring the data rows and columns</h1>
                
            
            
                
<p>Let's explore the data. In the next cell, type the following:</p>
<pre>print('Number of rows: ' + str(df.shape[0]))<br/>print('Number of columns: ' + str(df.shape[1]))</pre>
<p>The output is as follows:</p>
<pre>Number of rows: 6825
Number of columns: 153</pre>
<p>In the 2018 file, there should be 6,825 rows and 153 columns. Each row corresponds to a dialysis facility in the United States. Here we used the <kbd>shape</kbd> attribute of DataFrames, which returns a tuple containing the number of rows and number of columns.</p>
<p>We can also get a visualization of what the DataFrame looks like by using the <kbd>head()</kbd> function. The <kbd>head()</kbd> function takes a parameter, <kbd>n</kbd>, that tells it how many rows of the DataFrame to print. In the next cell, type the following and press Play:</p>
<pre>print(df.head(n=5))</pre>
<p>The output is as follows:</p>
<pre>                    Facility Name  CMS Certification Number (CCN)  \
0     CHILDRENS HOSPITAL DIALYSIS                           12306   
1                FMC CAPITOL CITY                           12500   
2                GADSDEN DIALYSIS                           12501   
3  TUSCALOOSA UNIVERSITY DIALYSIS                           12502   
4                  PCD MONTGOMERY                           12505   
<br/>...</pre>
<p>You should see some of the columns for the first five rows, such as facility name, address, and measure scores. The <kbd>head()</kbd> function prints an abbreviated list of columns, selecting some from the beginning of the <kbd>.csv</kbd> file and some from the end, separated by an ellipsis.</p>
<p>Let's get a complete list of all <kbd>153</kbd> columns. Type the following and press <em>Enter</em>:</p>
<pre>print(df.columns)</pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mceNonEditable"/>
<p>The output is as follows:</p>
<pre>Index(['Facility Name', 'CMS Certification Number (CCN)', 'Alternate CCN 1',
       'Address 1', 'Address 2', 'City', 'State', 'Zip Code', 'Network',
       'VAT Catheter Measure Score',
       ...
       'STrR Improvement Measure Rate/Ratio',
       'STrR Improvement Period Numerator',
       'STrR Improvement Period Denominator', 'STrR Measure Score Applied',
       'National Avg STrR Measure Score', 'Total Performance Score',
       'PY2018 Payment Reduction Percentage', 'CMS Certification Date',
       'Ownership as of December 31, 2016', 'Date of Ownership Record Update'],
      dtype='object', length=153)</pre>
<p>Here, we use the <kbd>columns</kbd> attribute of a DataFrame, which gives us access to the column names of the DataFrame as a list. Unfortunately, again, <kbd>pandas</kbd> abbreviates the output so we can't see all <kbd>153</kbd> columns. To do so, we need to be more explicit and print each column using a <kbd>for</kbd> loop:</p>
<pre>for column in df.columns:<br/>    print(column)</pre>
<p>The output is as follows:</p>
<pre>Facility Name
CMS Certification Number (CCN)
Alternate CCN 1
Address 1
Address 2
City
State
Zip Code
Network
VAT Catheter Measure Score<br/>...</pre>
<p>Now you'll see all <kbd>153</kbd> column names. Use the scrollbar to skim through all of them. You'll notice that each of the 16 measures has several columns associated with it, and there are also additional columns like demographic data and total performance scores.</p>
<p>Now that we have gained a rough overview of our dataset, we can move on to more in-depth analysis.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Exploring the data geographically</h1>
                
            
            
                
<p>For the remainder of this section, we will be using a lot of SQL-like operations in <kbd>pandas</kbd> to manipulate the data. Here is a conversion table between SQL and <kbd>pandas</kbd> for some basic operations:</p>
<table border="1" style="border-collapse: collapse;width: 100%">
<tbody>
<tr>
<td style="width: 162px"><strong>Action</strong></td>
<td style="width: 96.3333px"><strong>SQL syntax</strong></td>
<td style="width: 99.6667px"><strong><kbd>pandas</kbd> function</strong></td>
<td style="width: 230px"><strong>SQL example</strong></td>
<td style="width: 191px"><strong><kbd>pandas</kbd> example</strong></td>
</tr>
<tr>
<td style="width: 162px">
<p class="mce-root">Selecting columns</p>
</td>
<td style="width: 96.3333px"><kbd>SELECT</kbd></td>
<td style="width: 99.6667px"><kbd>[[]]</kbd></td>
<td style="width: 230px"><kbd>SELECT col1, col2, FROM df;</kbd></td>
<td style="width: 191px"><kbd>df[['col1','col2']]</kbd></td>
</tr>
<tr>
<td style="width: 162px">
<p class="mce-root">Selecting rows</p>
</td>
<td style="width: 96.3333px"><kbd>WHERE</kbd></td>
<td style="width: 99.6667px"><kbd>loc()</kbd>, <kbd>iloc()</kbd></td>
<td style="width: 230px">
<p class="mce-root"><kbd>SELECT * FROM df WHERE age=50;</kbd></p>
</td>
<td style="width: 191px"><kbd>df.loc[df['age']==50]</kbd></td>
</tr>
<tr>
<td style="width: 162px">Sorting by a column</td>
<td style="width: 96.3333px"><kbd>ORDER BY</kbd></td>
<td style="width: 99.6667px"><kbd>sort_values()</kbd></td>
<td style="width: 230px"><kbd>SELECT * FROM df ORDER BY col1;</kbd></td>
<td style="width: 191px"><kbd>df.sort_values('col1')</kbd></td>
</tr>
<tr>
<td style="width: 162px">Aggregating by a column</td>
<td style="width: 96.3333px"><kbd>GROUP BY</kbd></td>
<td style="width: 99.6667px"><kbd>groupby()</kbd></td>
<td style="width: 230px"><kbd>SELECT COUNT(*) FROM df GROUP BY col1;</kbd></td>
<td style="width: 191px"><kbd>df.groupby('col1').size()</kbd></td>
</tr>
<tr>
<td style="width: 162px">Limiting the number of rows</td>
<td style="width: 96.3333px"><kbd>LIMIT</kbd></td>
<td style="width: 99.6667px"><kbd>head()</kbd></td>
<td style="width: 230px"><kbd>SELECT * FROM df LIMIT 5;</kbd></td>
<td style="width: 191px"><kbd>df.head(n=5)</kbd></td>
</tr>
</tbody>
</table>
<p> </p>
<p>With these conversions in mind, we can begin to explore the data geographically.</p>
<p>For starters, 6,825 dialysis facilities is a lot. Let's try narrowing that down by state. First, we count the dialysis facilities in each state:</p>
<pre>"""Equivalent SQL: SELECT COUNT(*) <br/>                   FROM df <br/>                   GROUP BY State;<br/>"""<br/>df_states = df.groupby('State').size()<br/>print(df_states)</pre>
<p>The output is as follows:</p>
<pre>State
AK      9
AL    170
AR     69
AS      1
AZ    120
CA    625
CO     75
CT     49
DC     23
DE     27<br/>...</pre>
<p>You should see a table containing 50 rows (one per state, each containing the associated count).</p>
<p class="mce-root"/>
<p>Let's now sort the rows in descending order:</p>
<pre>"""Equivalent SQL: SELECT COUNT(*) AS Count <br/>                   FROM df <br/>                   GROUP BY State <br/>                   ORDER BY Count ASC;<br/>"""<br/>df_states = df.groupby('State').size().sort_values(ascending=False)<br/>print(df_states)</pre>
<p>The output is as follows:</p>
<pre>State
CA    625
TX    605
FL    433
GA    345
OH    314
IL    299
PA    294
NY    274
NC    211
MI    211<br/>...</pre>
<p>Let's further refine our query by limiting the output to 10 states:</p>
<pre>"""Equivalent SQL: SELECT COUNT(*) AS Count <br/>                   FROM df <br/>                   GROUP BY State <br/>                   ORDER BY Count DESC<br/>                   LIMIT 10;<br/>"""<br/>df_states = df.groupby('State').size().sort_values(ascending=False).head(n=10)<br/>print(df_states)</pre>
<p>According to the results, California is the state with the most dialysis centers, followed by Texas. If we wanted to filter dialysis facilities based on state, we could do that by selecting the appropriate rows:</p>
<pre>"""Equivalent SQL: SELECT *<br/>                   FROM df<br/>                   WHERE State='CA';<br/>"""<br/>df_ca = df.loc[df['State'] == 'CA']<br/>print(df_ca)</pre>


            

            
        
    

        

                            
                    <h1 class="header-title">Displaying dialysis centers based on total performance</h1>
                
            
            
                
<p>Almost every exploration of such provider-centered data will include analyzing facilities based on their quality scores. We will dive into that next.</p>
<p>First, let's get a count on the different scores received by the dialysis facilities:</p>
<pre>print(df.groupby('Total Performance Score').size())</pre>
<p>The output is as follows:</p>
<pre>Total Performance Score
10           10
100          30
11            2
12            2
13            1
14            3
15            1
...
95           15
96            2
97           11
98            8
99           12
No Score    276
Length: 95, dtype: int64</pre>
<p>One thing to notice is that the <kbd>Total Performance Score</kbd> column is in a string rather than integer format, and so to do numerical sorting, we must first convert the column to integer format. Second, after running the preceding code, you'll notice that 276 dialysis facilities have a value of <kbd>No Score</kbd> for the <kbd>Total Performance Score</kbd> column. These rows must be eliminated before converting to integer format to avoid throwing an error.</p>
<p>In the following code, we first eliminate the <kbd>No Score</kbd> rows, and then we use the <kbd>to_numeric()</kbd> function of <kbd>pandas</kbd> to convert the string column to an integer column:</p>
<pre>df_filt= df.loc[df['Total Performance Score'] != 'No Score']<br/>df_filt['Total Performance Score'] = pd.to_numeric(<br/>    df_filt['Total Performance Score']<br/>)</pre>
<p class="mce-root"/>
<p>Now, we create a new DataFrame that selects just a few columns that we are interested in and sorts them, with the worst performing centers at the top. Such a code block would be helpful for identifying the worst performing dialysis centers, for example. We display the first five results:</p>
<pre>df_tps = df_filt[[<br/>    'Facility Name',<br/>    'State', <br/>    'Total Performance Score'<br/>]].sort_values('Total Performance Score')<br/>print(df_tps.head(n=5))</pre>
<p>The output is as follows:</p>
<pre>                                   Facility Name State  \
5622   462320 PRIMARY CHILDREN'S DIALYSIS CENTER    UT   
698              PEDIATRIC DIALYSIS UNIT AT UCSF    CA   
6766                  VITAL LIFE DIALYSIS CENTER    FL   
4635  BELMONT COURT DIALYSIS - DOYLESTOWN CAMPUS    PA   
3763                       WOODMERE DIALYSIS LLC    NY   

      Total Performance Score  
5622                        5  
698                         7  
6766                        8  
4635                        8  
3763                        9</pre>
<p>Alternatively, if we wished to analyze the mean total performance of each state's dialysis centers, we could do that by using <kbd>numpy.mean()</kbd> in conjunction with <kbd>groupby()</kbd>:</p>
<pre>import numpy as np<br/><br/>df_state_means = df_filt.groupby('State').agg({<br/>    'Total Performance Score': np.mean<br/>})<br/>print(df_state_means.sort_values('Total Performance Score', ascending=False))</pre>
<p>The output is as follows:</p>
<pre>       Total Performance Score
State                         
ID                   73.178571
WY                   71.777778
HI                   70.500000
UT                   70.421053
CO                   70.173333
WA                   70.146067
ME                   70.058824
OR                   70.046154
KS                   69.480769
AZ                   68.905983<br/>...</pre>
<p>According to the results of this query, Idaho and Wyoming have the nation's best performing dialysis centers. You could also add a column including the number of dialysis centers in each state using the following modification:</p>
<pre>import numpy as np<br/><br/>df_state_means = df_filt.groupby('State').agg({<br/>    'Total Performance Score': np.mean,<br/>    'State': np.size<br/>})<br/>print(df_state_means.sort_values('Total Performance Score', ascending=False))</pre>
<p>The output is as follows:</p>
<pre>       Total Performance Score  State
State                                
ID                   73.178571     28
WY                   71.777778      9
HI                   70.500000     26
UT                   70.421053     38
CO                   70.173333     75
WA                   70.146067     89
ME                   70.058824     17
OR                   70.046154     65
KS                   69.480769     52
AZ                   68.905983    117<br/>...</pre>
<p>The results indicate that when considering only states that have at least 100 dialysis centers, Arizona has the best total performance.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Alternative analyses of dialysis centers</h1>
                
            
            
                
<p>The code introduced in this section can be adjusted to conduct all different types of analyses on dialysis centers. For example, instead of measuring mean performance by <kbd>State</kbd>, perhaps you wish to measure mean performance by dialysis center owner. This can be done by changing the column by which you group in the most recent example. Or maybe you wish to look at an individual measure instead of <kbd>Total Performance Score</kbd>, which again can be accomplished by just changing a column in the code.</p>
<p>Now that we have analyzed provider performance using dialysis centers in our first example, we will take a look at a more complex dataset, the inpatient hospital performance dataset.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Comparing hospitals</h1>
                
            
            
                
<p>In the previous example, we analyzed the performance of dialysis centers using Python. Dialysis centers are just one small part of the healthcare provider pool – a pool which also includes hospitals, outpatient offices, nursing homes, inpatient rehabilitation facilities, and hospice providers, for example. As you were downloading the dialysis facility comparison data from <a href="https://data.medicare.gov">https://data.medicare.gov</a>, you might have noticed the presence of performance data for these other facilities. We are going to now examine the data for a more complex facility type: the inpatient hospital. The Hospital Compare dataset includes data for three of the eight CMS value-based programs. It is a large dataset, and we are going to demonstrate some advanced Python and <kbd>pandas</kbd> features using this data.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Downloading the data</h1>
                
            
            
                
<p>To download the Hospital Compare dataset, complete the following steps:</p>
<ol>
<li>Navigate to <a href="https://data.medicare.gov/data/hospital-compare">https://data.medicare.gov/data/hospital-compare</a>.</li>
<li>Locate the blue button on the page that is labeled DOWNLOAD CSV FLAT FILES (REVISED) NOW. (To get the right year, you may have to select the GET ARCHIVED DATA button instead). Click the button. A <kbd>.zip</kbd> file will begin to download.</li>
<li>Extract the <kbd>.zip</kbd> file using the appropriate Windows/Mac program or Linux command.</li>
<li>Take note of the path containing the extracted <kbd>.csv</kbd> files.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">Importing the data into your Jupyter Notebook session</h1>
                
            
            
                
<p>Notice that the extracted Hospital Compare folder includes 71 files, the vast majority of which are <kbd>.csv</kbd> files. That's a lot of tables! Let's import some of the tables into a Jupyter Notebook:</p>
<pre>import pandas as pd<br/><br/>pathname = 'C:\\Users\\Vikas\\Desktop\\Bk\\Data\\Hospital_Revised_Flatfiles\\'<br/><br/>files_of_interest = [<br/>    'hvbp_tps_11_07_2017.csv', <br/>    'hvbp_clinical_care_11_07_2017.csv',<br/>    'hvbp_safety_11_07_2017.csv',<br/>    'hvbp_efficiency_11_07_2017.csv',<br/>    'hvbp_hcahps_11_07_2017.csv'<br/>]<br/><br/>dfs = {<br/>    foi: pd.read_csv(pathname + foi, header=0) for foi in files_of_interest<br/>}</pre>
<p>The preceding code loads the tables pertaining to the HVBP measure into the Python session. There are five total tables, with four of the tables corresponding to the four domains of the measure, and one table representing the overall scores.</p>
<p>Note that instead of explicitly creating and importing five dataframes, we created a dictionary of dataframes using a comprehension. We covered dictionaries, lists, and comprehensions in the Python chapter. This saves a lot of typing in this cell and in upcoming cells.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Exploring the tables</h1>
                
            
            
                
<p>Next, let's explore the tables and check the numbers of rows and columns in each:</p>
<pre>for k, v in dfs.items():<br/>    print(<br/>        k + ' - Number of rows: ' + str(v.shape[0]) + <br/>        ', Number of columns: ' + str(v.shape[1]) <br/>    )   </pre>
<p>The output is as follows:</p>
<pre>hvbp_tps_11_07_2017.csv -  Number of rows: 2808, Number of columns: 16
hvbp_clinical_care_11_07_2017.csv -  Number of rows: 2808, Number of columns: 28
hvbp_safety_11_07_2017.csv -  Number of rows: 2808, Number of columns: 64
hvbp_efficiency_11_07_2017.csv -  Number of rows: 2808, Number of columns: 14
hvbp_hcahps_11_07_2017.csv -  Number of rows: 2808, Number of columns: 73</pre>
<p>For the preceding cell, we used the <kbd>items()</kbd> method of dictionaries to iterate over each key-DataFrame pair in the dictionary of DataFrames.</p>
<p>The tables all have the same number of rows. Since each row corresponds to a hospital, it is safe to assume that the hospitals in all of the tables are the same (we will test that assumption shortly).</p>
<p>Any analysis we perform is limited due to the separation of the tables. Since all the hospitals are (assumed to be) the same, we can combine all the columns into one table. We will do that using the <kbd>merge()</kbd> function of <kbd>pandas</kbd>. Using <kbd>pandas</kbd> <kbd>merge()</kbd> is akin to using <kbd>SQL JOIN</kbd> (you learned about <kbd>SQL JOIN</kbd> in <a href="e1b89921-e75b-4b16-a567-8970a173db53.xhtml" target="_blank">Chapter 4</a>, <em>Computing Foundations – Databases</em>). The merge is performed by specifying a common ID column present in both of the tables on which the rows will be matched. To see whether there is a common ID column in the five HVBP tables, we can print out the column names of each table:</p>
<pre>for v in dfs.values():<br/>    for column in v.columns:<br/>        print(column)<br/>    print('\n')</pre>
<p>If you scroll through the results, you'll notice the presence of the <kbd>Provider Number</kbd> column in all of the tables. <kbd>Provider Number</kbd> is a unique identifier that can be used to link the tables.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Merging the HVBP tables</h1>
                
            
            
                
<p>Let's try joining two of the tables:</p>
<pre>df_master = dfs[files_of_interest[0]].merge(<br/>    dfs[files_of_interest[1]], <br/>    on='Provider Number', <br/>    how='left',</pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mceNonEditable"/>
<pre>    copy=False<br/>)<br/><br/>print(df_master.shape)</pre>
<p>The output is as follows:</p>
<pre>(2808, 43)</pre>
<p>Our merge appears to have worked since the number of columns in <kbd>df_master</kbd> is the sum of the columns of first two DataFrames, minus one (the <kbd>on</kbd> column is not copied). Let's look at the columns of the new DataFrame:</p>
<pre>print(df_master.columns)</pre>
<p>The output is as follows:</p>
<pre>Index(['Provider Number', 'Hospital Name_x', 'Address_x', 'City_x', 'State_x',
       'Zip Code', 'County Name_x',
       'Unweighted Normalized Clinical Care Domain Score',
       'Weighted Normalized Clinical Care Domain Score',
       'Unweighted Patient and Caregiver Centered Experience of Care/Care Coordination Domain Score',
       'Weighted Patient and Caregiver Centered Experience of Care/Care Coordination Domain Score',
       'Unweighted Normalized Safety Domain Score',
       'Weighted Safety Domain Score',
       'Unweighted Normalized Efficiency and Cost Reduction Domain Score',
       'Weighted Efficiency and Cost Reduction Domain Score',
       'Total Performance Score', 'Hospital Name_y', 'Address_y', 'City_y',
       'State_y', 'ZIP Code', 'County Name_y',
       'MORT-30-AMI Achievement Threshold', 'MORT-30-AMI Benchmark',
       'MORT-30-AMI Baseline Rate', 'MORT-30-AMI Performance Rate',
       'MORT-30-AMI Achievement Points', 'MORT-30-AMI Improvement Points',
       'MORT-30-AMI Measure Score', 'MORT-30-HF Achievement Threshold',
       'MORT-30-HF Benchmark', 'MORT-30-HF Baseline Rate',
       'MORT-30-HF Performance Rate', 'MORT-30-HF Achievement Points',
       'MORT-30-HF Improvement Points', 'MORT-30-HF Measure Score',
       'MORT-30-PN Achievement Threshold', 'MORT-30-PN Benchmark',
       'MORT-30-PN Baseline Rate', 'MORT-30-PN Performance Rate',
       'MORT-30-PN Achievement Points', 'MORT-30-PN Improvement Points',
       'MORT-30-PN Measure Score'],
      dtype='object')</pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mceNonEditable"/>
<p class="mceNonEditable"/>
<p>The duplicate columns (<kbd>Hospital Name</kbd>, <kbd>Address</kbd>, <kbd>City</kbd>, and so on) had suffixes <kbd>_x</kbd> and <kbd>_y</kbd> added to their names in the joined table, to indicate which table they are from, confirming that the merge worked.</p>
<p>Let's use a <kbd>for</kbd> loop to join the three remaining tables to <kbd>df_master</kbd>:</p>
<pre>for df in dfs.values():<br/>    df.columns = [col if col not in ['Provider_Number'] else 'Provider Number' <br/>        for col in df.columns]<br/><br/>for num in [2,3,4]:<br/>    df_master = df_master.merge(<br/>        dfs[files_of_interest[num]],<br/>        on='Provider Number',<br/>        how='left',<br/>        copy=False<br/>    )<br/>        <br/>print(df_master.shape)</pre>
<p>The output is as follows:</p>
<pre>(2808, 191)</pre>
<p>In this cell, first we use a loop to rename all columns from <kbd>Provider_Number</kbd> to <kbd>Provider Number</kbd>, so we can join the tables cleanly.</p>
<p>Then we use a loop to join each remaining table to <kbd>df_master</kbd>. The number of columns in the resulting table equals the sum of the columns of the tables, minus four.</p>
<p>To confirm that the merge worked, we can print the columns of our new table:</p>
<pre>for column in df_master.columns:<br/>    print(column)</pre>
<p>Scrolling through the output confirms that all of the columns from the five tables are present.</p>
<p>We leave it to you to perform additional analyses on the dataset, using the code examples from the <em>Comparing dialysis facilities</em> section.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Summary</h1>
                
            
            
                
<p>In this chapter, we have taken a look at some prominent value-based programs that are shaping the US healthcare industry today. We have seen how these programs quantify provider performance through the use of measures. Additionally, we have downloaded the data for comparing dialysis facilities and hospitals and worked through some code examples in Python to see how to analyze this data.</p>
<p>One might argue that the analysis in this chapter could be accomplished by using a spreadsheet application such as Microsoft Excel rather than programming. In <a href="d029d858-9c6e-4bf0-b793-87cdc4395e86.xhtml" target="_blank">Chapter 7</a>, <em>Making Predictive Models in Healthcare</em>, we will train predictive models on a healthcare dataset to predict discharge status in the ED. As you will see, this type of analysis almost certainly requires writing code.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">References</h1>
                
            
            
                
<p>Data.Medicare.gov (2018). Retrieved April 28, 2018 from <a href="https://data.medicare.gov">https://data.medicare.gov</a>.</p>
<p>MIPS Overview (2018). Retrieved April 28, 2018, from <a href="https://qpp.cms.gov/mips/overview">https://qpp.cms.gov/mips/overview</a>.</p>
<p>What are the value-based programs? (2017, November 9th). <em>Centers for Medicare and Medicaid Services</em>. Retrieved April 28, 2018, from <a href="https://www.cms.gov/Medicare/Quality-Initiatives-Patient-Assessment-Instruments/Value-Based-Programs/Value-Based-Programs.html">https://www.cms.gov/Medicare/Quality-Initiatives-Patient-Assessment-Instruments/Value-Based-Programs/Value-Based-Programs.html</a>.</p>


            

            
        
    </body></html>
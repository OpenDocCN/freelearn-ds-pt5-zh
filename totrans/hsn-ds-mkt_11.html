<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Exploratory Analysis for Customer Behavior</h1>
                </header>
            
            <article>
                
<p>In this chapter, as the first step toward future topics in the following chapters, we are going to discuss what customer analytics is, the importance and benefits of analyzing and having a better understanding of the customer base, and the use cases of customer analytics in different aspects of marketing. As we gather and track more data on customers and their behavior regarding individual sales, marketing platforms, and channels, it becomes easier for marketers to analyze and understand how different customers react to different marketing strategies. Customer analytics helps marketers understand their customers better by utilizing this data. Furthermore, it can help marketers to form better marketing strategies that can improve engagement, retention, and conversion rates.</p>
<p>I<span>n this chapte</span><span>r, we will cover the following topics:</span></p>
<ul>
<li>Customer analytics: understanding customer behavior</li>
<li>Conducting customer analytics with Python</li>
<li>Conducting customer analytics with R</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Customer analytics – understanding customer behavior</h1>
                </header>
            
            <article>
                
<p><strong>Customer analytics</strong> is a process of understanding and gaining insights into customer behavior through analyzing customer behavior data. It ranges from simple data analysis and visualization to more advanced customer segmentation and predictive analytics. The information and insights gained through customer analytics can then be utilized in forming marketing strategies, optimizing sales channels, and making other key business decisions.</p>
<p>The importance of customer analytics is rising. Because access to customer data became easier for many businesses and also because customers now have easier access to data and information on similar products and contents provided by other competitors, it is critical to many businesses to be able to understand and predict what their customers are likely to purchase or view. The deeper the understanding you have about your customers, the better competitive power you will have against your competitors.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Customer analytics use cases</h1>
                </header>
            
            <article>
                
<p>Customer analytics can be used at any point of the marketing process. It can be used to monitor and track how customers interact with the products or react to different marketing strategies. This typically requires using data analysis and visualization techniques to build reports or dashboards that can easily show <strong>key performance indicators</strong> (<strong>KPIs</strong>). </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Sales funnel analytics</h1>
                </header>
            
            <article>
                
<p>One of the common use cases of customer analytics is <strong>sales funnel analytics</strong>. By analyzing sales funnel data, we can monitor and track the life cycle of customers, gaining insights such as through which marketing channel they sign up, how often they log into the system, what types of products they browsed and purchased, or how they fall off from each step of the funnel.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Customer segmentation</h1>
                </header>
            
            <article>
                
<p>Customer analytics can also be used to identify different groups of customers based on their behavior. <strong>Customer segmentation</strong> is a good example and outcome of customer analytics. Through identifying subgroups of similar customers, you can better understand the target populations. For example, the marketing strategy for low-engagement customers should be different from the marketing strategy for high-engagement customers. By effectively segmenting the customer base by the level of engagement, you can have a deeper understanding of how different groups of customers behave and react to different marketing strategies. This further helps you better target certain subgroups of customers.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Predictive analytics</h1>
                </header>
            
            <article>
                
<p>Another good use case of customer analytics is using <strong>predictive analytics</strong> on customer data. With customer data, you can have a deeper understanding of what attributes and characteristics of customers are highly correlated with the outcomes of your interest. For example, if you'd like to improve the response and engagement rates, you can analyze the data to identify those characteristics of customers that result in higher responses and engagement rates. Then, you can build predictive models that predict how likely it is that your customers are going to respond to your marketing messages. </p>
<p>Another example of the usage of predictive analytics can be for marketing channel optimization. With the insights gained from customer analytics, you can build predictive models to optimize marketing channels. The customers are going to respond differently to different marketing channels. For instance, younger cohorts, who use smartphones more heavily than the rest of the population, are more likely to respond to marketing via smartphones. On the other hand, more senior cohorts are more likely to respond better to marketing on more traditional media, such as TV or newspaper advertisements. With customer analytics, you can identify correlations between certain attributes of customers and the performances of different marketing channels.</p>
<p>As we have discussed so far, the applications of customer analytics are broad and can be used at any point of the marketing process. In the following programming exercises, we are going to discuss how we can use customer analytics to monitor and track different marketing strategies and see some of the ways to segment and analyze the customer base to gain insights. Then, <span>in the following chapters, </span><span>we are going to explore other use cases of customer analytics, such as optimizing engagement and retention rates, and customer segmentation.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Conducting customer analytics with Python</h1>
                </header>
            
            <article>
                
<p>In this section, we are going to discuss how to conduct customer analytics using Python. We will be mainly using the <kbd>pandas</kbd> and <kbd>matplotlib</kbd> packages to analyze and visualize the customer behavior observed in the dataset. F<span>or those readers who would like to use R instead of Python for this exercise, you can skip to the next section. </span><span>We will start this section by analyzing and understanding the behaviors of engaged customers and then discuss a simple way to segment the customer base by certain criteria.</span></p>
<p><span>For this exercise, we will be using one of the publicly available datasets f</span>rom IBM, w<span>hich can be found at this link: <a href="https://www.ibm.com/communities/analytics/watson-analytics-blog/marketing-customer-value-analysis/">https://www.ibm.com/communities/analytics/watson-analytics-blog/marketing-customer-value-analysis/</a></span><span>. You can follow this link and download the data that is available in CSV format, named <kbd>WA_Fn UseC_ Marketing Customer Value Analysis.csv</kbd>. Once you have downloaded this data, you can load it into your Jupyter Notebook by running the following command:</span></p>
<pre>import pandas as pd<br/><br/>df = pd.read_csv('../data/WA_Fn-UseC_-Marketing-Customer-Value-Analysis.csv')</pre>
<p>Similar to <a href="d3ba7047-2873-4b03-9a44-4c1d55b84178.xhtml" target="_blank">Chapter 6</a>, <em>Recommending the Right Products</em>, we are using the<span> </span><kbd>read_csv</kbd><span> </span>function in the<span> </span><kbd>pandas</kbd><span> </span>package to load the data in CSV format. <span>Once you have loaded this data into a </span><kbd>pandas</kbd><span> </span><kbd>DataFrame</kbd><span>, it should look as in the following:</span></p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1190 image-border" src="assets/b23d93a6-8144-45cc-8396-3a9ba57edc9c.png" style="width:162.50em;height:85.75em;"/></p>
<p>As you can see from this data, there is a column named <kbd>Response</kbd>, which contains information about whether a customer responded to the marketing efforts. Also, the <kbd>Renew Offer Type</kbd> and <kbd>Sales Channel</kbd> columns represent the type of the renewal offer presented to the customer and which sales channel was used to contact the customer. There are numerous other columns that represent the socio-economic backgrounds of the customers and types of insurance coverage that the customers currently have. We will be utilizing this information to analyze and understand the customer behavior better, especially in regards to their responses and engagement with the marketing and sales efforts.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Analytics on engaged customers</h1>
                </header>
            
            <article>
                
<p>Now that we have loaded the data into our Python environment, we are going to analyze it to understand how different customers behave and react to different marketing strategies. We are going to follow these steps:</p>
<ol>
<li>Overall engagement rate</li>
<li>Engagement rates by offer type</li>
<li>Engagement rates by offer type and vehicle class</li>
<li>Engagement rates by sales channel</li>
<li>Engagement rates by sales channel and vehicle size</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Overall engagement rate</h1>
                </header>
            
            <article>
                
<p>The first thing we are going to need to understand is the overall marketing response or engagement rate. We can use the following code to get the total number of customers who have responded:</p>
<pre>df.groupby('Response').count()['Customer']</pre>
<p>As you have seen from the data, the <kbd>Response</kbd> <span>column </span>contains information about whether a customer responded to the marketing call or not (<kbd>Yes</kbd> for those who have responded and <kbd>No</kbd> for those who have not). We are simply grouping by this column by using the <kbd>groupby</kbd> function in a <kbd>pandas</kbd> DataFrame and counting the number of customers in each category with the <kbd>count</kbd> function in the <kbd>pandas</kbd> package. </p>
<p>The result looks as in the following:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1191 image-border" src="assets/b1213d1b-3be9-42ef-a946-1b689515836d.png" style="width:27.08em;height:6.17em;"/></p>
<p>In order to visualize this in a plot, you can use the following code:</p>
<pre>ax = df.groupby('Response').count()['Customer'].plot(<br/>    kind='bar',<br/>    color='skyblue',<br/>    grid=True,<br/>    figsize=(10, 7),<br/>    title='Marketing Engagment'<br/>)<br/><br/>ax.set_xlabel('Engaged')<br/>ax.set_ylabel('Count')<br/><br/>plt.show()</pre>
<p>The plot looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1192 image-border" src="assets/951a86d2-84f1-47a2-8284-ab730249da2e.png" style="width:34.67em;height:25.50em;"/></p>
<p class="mce-root"/>
<p>As you can see from these results, the majority of the customers did not respond to the marketing calls. Let's take a look at these numbers in percentages, using the following code:</p>
<pre>df.groupby('Response').count()['Customer']/df.shape[0]</pre>
<p>When you run this code, the result looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1193 image-border" src="assets/c845dafb-2535-41bd-b5af-b1bc15418860.png" style="width:31.33em;height:6.67em;"/></p>
<p>From these results, we can see that only about 14% of the customers responded to the marketing calls. Let's dive deeper into the customers who responded and get a better understanding of what worked best for them.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Engagement rates by offer type</h1>
                </header>
            
            <article>
                
<p>Different types of offers will work differently for the customers. In this section, we are going to look into what types of offers worked best for the engaged customers. Take a look at the following code:</p>
<pre>by_offer_type_df = df.loc[<br/>    df['Response'] == 'Yes'<br/>].groupby([<br/>    'Renew Offer Type'<br/>]).count()['Customer'] / df.groupby('Renew Offer Type').count()['Customer']</pre>
<p class="mce-root"/>
<p>As you can see from this code, we are grouping by the <kbd>Renew Offer Type</kbd> column, where we have four different types of offers. We count the number of engaged customers for each type of these renewal offers first by filtering for those with <kbd>Yes</kbd> values in the <kbd>Response</kbd> column. Then, we are dividing these numbers by the total number of customers in each renewal offer type to get the engagement rates per renewal offer type. The result looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1194 image-border" src="assets/6efa9588-98e0-4073-979a-a07bfbadd141.png" style="width:37.50em;height:12.92em;"/></p>
<p>We can visualize these results in a bar plot, using the following code:</p>
<pre>ax = (by_offer_type_df*100.0).plot(<br/>    kind='bar',<br/>    figsize=(7, 7),<br/>    color='skyblue',<br/>    grid=True<br/>)<br/><br/>ax.set_ylabel('Engagement Rate (%)')<br/><br/>plt.show()</pre>
<p>The bar plot looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1195 image-border" src="assets/f27b321b-e08a-4fe8-b359-88624355263a.png" style="width:29.25em;height:29.83em;"/></p>
<p>As you can easily notice from this plot, <kbd>Offer2</kbd> had the highest engagement rate among the customers. When conducting customer analytics, as discussed earlier, we often want to know the demographics and attributes of customers for each event, so that we can understand what works best for which type of customers. This can lead to further improvements in the next marketing campaign by better targeting those subgroups of customers. Let's take a step further into this data.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Engagement rates by offer type and vehicle class</h1>
                </header>
            
            <article>
                
<p>In the previous section, we have learned that <kbd>Renewal Offer Type 2</kbd> worked best for the customers. The marketers can benefit from this information itself, as this finding provides a useful insight into which type of offer worked best and had the highest response rate from customers. However, we can gain more insights on how different customers with different backgrounds or characteristics react differently to each offer types. In this section, we will show an example of what you can do as a marketer to understand how customers with different attributes respond differently to different marketing messages.</p>
<p>Let's see whether there is any noticeable difference in the response rates for each offer type for customers with different vehicle classes. We are going to look at the engagement rates by each offer type and <kbd>Vehicle Class</kbd> using the following code:</p>
<pre>by_offer_type_df = df.loc[<br/>    df['Response'] == 'Yes'<br/>].groupby([<br/>    'Renew Offer Type', 'Vehicle Class'<br/>]).count()['Customer']/df.groupby('Renew Offer Type').count()['Customer']</pre>
<p>As you can see from this code, we are grouping the data by two columns, <kbd>Renew Offer Type</kbd> and <kbd>Vehicle Class</kbd>, and computing the engagement rates for each group. </p>
<p>The result looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1196 image-border" src="assets/e6ead66a-c793-4307-858d-e586838d92b5.png" style="width:40.25em;height:22.25em;"/></p>
<p>To make this more readable, we can transform this data by using the following code:</p>
<pre>by_offer_type_df = by_offer_type_df.unstack().fillna(0)</pre>
<p>As you can see from this code, we are using the <kbd>unstack</kbd> function in a <kbd>pandas</kbd> <kbd>DataFrame</kbd> to pivot the data and extract and transform the inner-level group to columns. It will be easier to look at the result. The result looks as in the following:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1197 image-border" src="assets/1d7cf33a-516b-485f-a369-1139a3edb001.png" style="width:57.42em;height:16.75em;"/></p>
<p>As you can see here, <kbd>Vehicle Class</kbd> now becomes the columns after applying the <kbd>unstack</kbd> function. We can visualize this data as a bar plot, using the following code:</p>
<pre>ax = (by_offer_type_df*100.0).plot(<br/>    kind='bar',<br/>    figsize=(10, 7),<br/>    grid=True<br/>)<br/><br/>ax.set_ylabel('Engagement Rate (%)')<br/><br/>plt.show()</pre>
<p><span>The plot looks as follows:</span></p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1198 image-border" src="assets/9cdd184b-44bb-40d2-b89d-dea10a29310d.png" style="width:43.33em;height:31.92em;"/></p>
<p>Let's take a closer look at this chart. We have seen that <kbd>Offer2</kbd> had the highest response rate among the customers in the previous section. Here, we can see how customers with different vehicle classes engage differently with other types of renewal offers. For example, customers with <kbd>Four-Door Car</kbd> respond the most frequently for all offer types. However, customers with <kbd>SUV</kbd> respond with a higher chance to <kbd>Offer1</kbd> than to <kbd>Offer2</kbd>. As you can see from these results, we can gain more insights by breaking down the customer demographics further. If we see any significant difference in the response rates among different customer segments, we can fine-tune who to target for different sets of offers. In our example, if we believe customers with <kbd>SUV</kbd> respond to <kbd>Offer1</kbd> with a significantly higher degree of engagement than to <kbd>Offer2</kbd>, then we can target <kbd>SUV</kbd> customers with <kbd>Offer1</kbd>. On the other hand, if we believe customers with <kbd>Two-Door Car</kbd> respond to <kbd>Offer2</kbd> with a significantly higher degree of engagement than to other offer types, then we can target <kbd>Two-Door Car</kbd> owners with <kbd>Offer2</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Engagement rates by sales channel</h1>
                </header>
            
            <article>
                
<p>Let's take a look at another example. We will analyze how engagement rates differ by different sales channels. Take a look at the following code:</p>
<pre>by_sales_channel_df = df.loc[<br/>    df['Response'] == 'Yes'<br/>].groupby([<br/>    'Sales Channel'<br/>]).count()['Customer']/df.groupby('Sales Channel').count()['Customer']</pre>
<p>The result looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1199 image-border" src="assets/74f2b1af-c6d4-4c11-9946-a38c64ee8e71.png" style="width:46.08em;height:15.83em;"/></p>
<p>It will be easier to look at this result with a visualization. You can use the following code to visualize this data:</p>
<pre>ax = (by_sales_channel_df*100.0).plot(<br/>    kind='bar',<br/>    figsize=(7, 7),<br/>    color='skyblue',<br/>    grid=True<br/>)<br/><br/>ax.set_ylabel('Engagement Rate (%)')<br/><br/>plt.show()</pre>
<p>The plot looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1200 image-border" src="assets/1fa55aa5-5ab3-4730-9a47-3d0a9007cfc5.png" style="width:29.00em;height:30.33em;"/></p>
<p><span>As you can see from this plot, <kbd>Agent</kbd> works the best in terms of getting responses from the customers. Then, sales through <kbd>Web</kbd> works the second best. As before, let's break down this result deeper and analyze to see whether the behavior change among customers with different characteristics.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Engagement rates by sales channel and vehicle size</h1>
                </header>
            
            <article>
                
<p>In this section, we will take a look at whether customers with various vehicle sizes respond differently to different sales channels. Take a look at the following code to compute the engagement rates per sales channel and vehicle size:</p>
<pre>by_sales_channel_df = df.loc[<br/>    df['Response'] == 'Yes'<br/>].groupby([<br/>    'Sales Channel', 'Vehicle Size'<br/>]).count()['Customer']/df.groupby('Sales Channel').count()['Customer']</pre>
<p>The result looks as in the following:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1201 image-border" src="assets/03e1f43c-f151-4c55-9219-f9f9e1d6e624.png" style="width:33.58em;height:18.25em;"/></p>
<p>As before, we can <kbd>unstack</kbd> this data into a more visible format, using the following code:</p>
<pre>by_sales_channel_df = by_sales_channel_df.unstack().fillna(0)</pre>
<p>The result looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1202 image-border" src="assets/afe21b5d-805d-483f-814c-e96f6b1eec0d.png" style="width:30.00em;height:10.75em;"/></p>
<p class="mce-root"/>
<p>We can visualize these results into a bar chart, using the following code:</p>
<pre>ax = (by_sales_channel_df*100.0).plot(<br/>    kind='bar',<br/>    figsize=(10, 7),<br/>    grid=True<br/>)<br/><br/>ax.set_ylabel('Engagement Rate (%)')<br/><br/>plt.show()</pre>
<p>The plot now looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1203 image-border" src="assets/d713eff8-a1e8-4e4c-a0e3-87f26ecb5770.png" style="width:35.92em;height:27.83em;"/></p>
<p>As you can see from this plot, customers with <kbd>Medsize</kbd> vehicles respond the best to all sales channels. The engagement rates across different sales channels differ slightly between <kbd>Large</kbd> and <kbd>Small</kbd> vehicle owners. For example, <kbd>Small</kbd> vehicle owners respond better through <kbd>Agent</kbd> and <kbd>Call Center</kbd> channels, while on the other hand, <kbd>Large</kbd> vehicle owners respond better through the <kbd>Branch</kbd> and <kbd>Web</kbd> channels. As discussed previously, we can utilize this insight in the next marketing efforts. For example, as <kbd>Small</kbd> car owners respond with a higher chance through <kbd>Agent</kbd> and <kbd>Call Center</kbd>, we can utilize those two channels more heavily for <kbd>Small</kbd> car owners.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Segmenting customer base</h1>
                </header>
            
            <article>
                
<p><span>We are going to briefly discuss how we can segment the customer base in this section. We are going to expand this concept and discuss further how we can utilize machine learning for customer segmentation in <a href="5955002d-2a75-4d5a-aa6a-86710a3bf00e.xhtml" target="_blank">Chapter 10</a>, <em>Data-Driven Customer Segmentation</em>, but this section will give you some basic idea on what customer segmentation is and what it looks like.</span></p>
<p class="CDPAlignLeft CDPAlign">In this section, we will be segmenting our customer base by <kbd>Customer Lifetime Value</kbd> and <kbd>Months Since Policy Inception</kbd>. Feel free to try different features for segmenting the customer base. Take a look at the following distribution of the <kbd>Customer Lifetime Value</kbd> column:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1204 image-border" src="assets/c5fc27ea-09e8-48f4-8d69-6c9f8aacb4e3.png" style="width:28.92em;height:12.58em;"/></p>
<p><span>Based on this information, we are going to define those customers with a <kbd>Customer Lifetime Value</kbd> higher than the median as high-CLV customers and those with a CLV below the median as low-CLV customers. You can use the following code for encoding:</span></p>
<pre>df['CLV Segment'] = df['Customer Lifetime Value'].apply(<br/>    lambda x: 'High' if x &gt; df['Customer Lifetime Value'].median() else 'Low'<br/>)</pre>
<p>We are going to go through the same process for the <kbd>Months Since Policy Inception</kbd> field. Take a look at the following distribution for <kbd>Months Since Policy Inception</kbd>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1205 image-border" src="assets/7299d079-1270-4c64-aced-2d8172e44ec2.png" style="width:36.92em;height:12.75em;"/></p>
<p>Similarly, <span>we are going to define those customers with </span><kbd>Months Since Policy Inception</kbd><span> higher than the median as high <kbd>Policy Age Segment</kbd> customers and those below the median as low <kbd>Policy Age Segment</kbd> customers. You can use the following code for encoding:</span></p>
<pre>df['Policy Age Segment'] = df['Months Since Policy Inception'].apply(<br/>    lambda x: 'High' if x &gt; df['Months Since Policy Inception'].median() else 'Low'<br/>)</pre>
<p>We can visualize these segments using the following code:</p>
<pre>ax = df.loc[<br/>    (df['CLV Segment'] == 'High') &amp; (df['Policy Age Segment'] == 'High')<br/>].plot.scatter(<br/>    x='Months Since Policy Inception',<br/>    y='Customer Lifetime Value',<br/>    logy=True,<br/>    color='red'<br/>)<br/><br/>df.loc[<br/>    (df['CLV Segment'] == 'Low') &amp; (df['Policy Age Segment'] == 'High')<br/>].plot.scatter(<br/>    ax=ax,<br/>    x='Months Since Policy Inception',<br/>    y='Customer Lifetime Value',<br/>    logy=True,<br/>    color='blue'<br/>)<br/><br/>df.loc[<br/>    (df['CLV Segment'] == 'High') &amp; (df['Policy Age Segment'] == 'Low')<br/>].plot.scatter(<br/>    ax=ax,<br/>    x='Months Since Policy Inception',<br/>    y='Customer Lifetime Value',<br/>    logy=True,<br/>    color='orange'<br/>)<br/><br/>df.loc[<br/>    (df['CLV Segment'] == 'Low') &amp; (df['Policy Age Segment'] == 'Low')<br/>].plot.scatter(<br/>    ax=ax,<br/>    x='Months Since Policy Inception',<br/>    y='Customer Lifetime Value',<br/>    logy=True,<br/>    color='green',<br/>    grid=True,<br/>    figsize=(10, 7)<br/>)<br/><br/>ax.set_ylabel('CLV (in log scale)')<br/>ax.set_xlabel('Months Since Policy Inception')<br/><br/>ax.set_title('Segments by CLV and Policy Age')<br/><br/>plt.show()</pre>
<p>Let's take a closer look at this code. In the first code block, we are creating a scatter plot using the <kbd>plot.scatter</kbd> function in the <kbd>pandas</kbd> package for those customers in the <kbd>High CLV</kbd> and <kbd>High Policy Age</kbd> segments. By using the <kbd>logy=True</kbd> flag, we can easily transform the scale to log scale. Log scale is often used for monetary values, as they often have high skewness in their values. We repeat this process four times for the four segments we have created previously. </p>
<p>The resulting scatter plot looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1206 image-border" src="assets/d1193fdc-9dd2-45e9-9f2b-1b791ca21712.png" style="width:43.67em;height:31.42em;"/></p>
<p><span>As you can see from this scatter plot, the data points in red represent those customers in the <kbd>High CLV</kbd> and <kbd>High Policy Age</kbd> segment. Those in orange represent the <kbd>High CLV</kbd> and <kbd>Low Policy Age</kbd> group, those in blue represent the <kbd>Low CLV</kbd> and <kbd>High Policy Age</kbd> group, and lastly, those in green represent the <kbd>Low CLV</kbd> and <kbd>Low Policy Age</kbd> group. </span></p>
<p><span>Now that we have created these four segments, let's see whether there is any noticeable difference in the engagement rates among these four segments. Take a look at the following code:</span></p>
<pre>engagment_rates_by_segment_df = df.loc[<br/>    df['Response'] == 'Yes'<br/>].groupby(<br/>    ['CLV Segment', 'Policy Age Segment']<br/>).count()['Customer']/df.groupby(<br/>    ['CLV Segment', 'Policy Age Segment']<br/>).count()['Customer']</pre>
<p>As you can see from this code, we are grouping by the two newly-created columns, <kbd>CLV Segment</kbd> and <kbd>Policy Age Segment</kbd>, and computing the engagement rates for these four segments. The result looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1207 image-border" src="assets/7cccfc52-40b2-48ca-8ebf-8e230e1361aa.png" style="width:25.25em;height:16.67em;"/></p>
<p>It will be easier to look at the differences in a chart. You can use the following code to create a bar plot for this data:</p>
<pre>ax = (engagment_rates_by_segment_df.unstack()*100.0).plot(<br/>    kind='bar',<br/>    figsize=(10, 7),<br/>    grid=True<br/>)<br/><br/>ax.set_ylabel('Engagement Rate (%)')<br/>ax.set_title('Engagement Rates by Customer Segments')<br/><br/>plt.show()</pre>
<p>Now the plot looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1208 image-border" src="assets/490c82bd-8555-4258-b807-c44faf44fc07.png" style="width:47.58em;height:36.00em;"/></p>
<p>As you can notice from this plot, <kbd>High Policy Age Segment</kbd> has higher engagement than the <kbd>Low Policy Age Segment</kbd>. This suggests that those customers who have been insured by this company longer respond better. It is also noticeable that the <kbd>High Policy Age</kbd> and <kbd>Low CLV</kbd> segment has the highest engagement rate among the four segments. By creating different customer segments based on customer attributes, we can better understand how different groups of customers behave differently. We are going to further expand and experiment the concept of customer segmentation in <span>more</span><span> </span><span>depth in</span> <a href="9b3d36ba-d690-491c-9a6f-b8c00f59cfb4.xhtml" target="_blank"/><a href="9b3d36ba-d690-491c-9a6f-b8c00f59cfb4.xhtml" target="_blank">Chapter 9</a>, <em>Customer Lifetime Value</em>.</p>
<div class="packt_infobox">The full code for this Python exercise can be found in this link: <a href="https://github.com/yoonhwang/hands-on-data-science-for-marketing/blob/master/ch.7/python/CustomerBehaviors.ipynb">https://github.com/yoonhwang/hands-on-data-science-for-marketing/blob/master/ch.7/python/CustomerBehaviors.ipynb</a></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Conducting customer analytics with R</h1>
                </header>
            
            <article>
                
<p>In this section, we are going to discuss how to conduct customer analytics using R. We will be mainly using the<span> </span><kbd>dplyr</kbd><span> </span>and<span> </span><kbd>ggplot2</kbd><span> </span>libraries to analyze and visualize the customer behavior observed in the dataset. <span>For those readers who would like to use Python instead of R for this exercise, you can refer to the previous section. </span><span>We will start this section by analyzing and understanding the behaviors of engaged customers and then discuss a simple way to segment the customer base by certain criteria.</span></p>
<p><span>For this exercise, we will be using one of the publicly available datasets from </span><strong>IBM</strong><span>, which can be found at this link: <a href="https://www.ibm.com/communities/analytics/watson-analytics-blog/marketing-customer-value-analysis/">https://www.ibm.com/communities/analytics/watson-analytics-blog/marketing-customer-value-analysis/</a></span><span>. You can follow this link and download the data that is available in CSV format named <kbd>WA_Fn UseC_ Marketing Customer Value Analysis.csv</kbd>. Once you have downloaded this data, you can load it into your RStudio by running the following command:</span></p>
<pre>library(dplyr)<br/>library(ggplot2)<br/><br/>#### 1. Load Data ####<br/>df &lt;- read.csv(<br/>  file="~/Documents/data-science-for-marketing/ch.7/data/WA_Fn-UseC_-Marketing-Customer-Value-Analysis.csv", <br/>  header=TRUE<br/>)</pre>
<p>Similar to the previous chapter, we are using the<span> </span><kbd>read.csv</kbd><span> </span>function in R to load the data in CSV format. <span>Once you have loaded this data into a</span><span> </span><kbd>DataFrame</kbd><span>, it should look as in the following:</span></p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1209 image-border" src="assets/04ca623a-2f0b-4784-83b4-46c6fb656e33.png" style="width:64.08em;height:22.42em;"/></p>
<p>As you can see from this data, there is a column named<span> </span><kbd>Response</kbd>, which contains information about whether a customer responded to the marketing efforts. Also, the <kbd>Renew.Offer.Type</kbd> and<span> <kbd>Sales.Channel</kbd> columns represent the type of renewal offer presented to the customer and which sales channel was used to contact the customer. There are numerous other columns that represent the socio-economic backgrounds of the customers and types of insurance coverages that the customers currently have. We will be utilizing this information to analyze and understand the customer behavior better, especially in regards to their responses and engagements with the marketing and sales efforts.</span></p>
<p>Before we dive into the data, we will encode the <kbd>Response</kbd> <span>column </span>into numeric values—<kbd>0</kbd> <span>for</span> <kbd>No</kbd> <span>and</span> <kbd>1</kbd> <span>for</span> <kbd>Yes</kbd><span>. This will make our computations easier for future analyses. You can use the following code for encoding:</span></p>
<pre># Encode engaged customers as 0s and 1s<br/>df$Engaged &lt;- as.integer(df$Response) - 1</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Analytics on engaged customers</h1>
                </header>
            
            <article>
                
<p>Now that we have loaded the data into our environment, we are going to analyze it to understand how different customers behave and react to different marketing strategies. We are going to follow these steps:</p>
<ol>
<li>Overall engagement rate</li>
<li>Engagement rates by offer type</li>
<li>Engagement rates by offer type and vehicle class</li>
<li>Engagement rates by sales channel</li>
<li>Engagement rates by sales channel and vehicle size</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Overall engagement rate</h1>
                </header>
            
            <article>
                
<p>The first thing we are going to need to understand is the overall marketing response or engagement rate. We can use the following code to get the total number of customers who have responded:</p>
<pre>## - Overall Engagement Rates ##<br/>engagementRate &lt;- df %&gt;% group_by(Response) %&gt;%<br/>  summarise(Count=n()) %&gt;%<br/>  mutate(EngagementRate=Count/nrow(df)*100.0)</pre>
<p>As you have seen from the data, the <kbd>Response</kbd> <span>column</span><span> </span>contains information about whether a customer responded to the marketing call or not (<kbd>Yes</kbd><span> </span>for those who have responded and<span> </span><kbd>No</kbd><span> </span>for those who have not). We are simply grouping by this column by using the<span> </span><kbd>group_by</kbd><span> </span>function in the<span> </span><kbd>dplyr</kbd><span> library </span>and counting the number of customers in each category with the<span> </span><kbd>n()</kbd><span> </span>function. Then, using the <kbd>mutate</kbd> function, we compute the engagement rate by dividing <kbd>Count</kbd> by the total number of records in the <kbd>DataFrame</kbd>.</p>
<p>The result looks as in the following:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1210 image-border" src="assets/f85d9bff-c9dd-4bb7-aa93-5a5052eff192.png" style="width:21.75em;height:4.92em;"/></p>
<p>In order to visualize this in a plot, you can use the following code:</p>
<pre>ggplot(engagementRate, aes(x=Response, y=EngagementRate)) +<br/>  geom_bar(width=0.5, stat="identity") +<br/>  ggtitle('Engagement Rate') +<br/>  xlab("Engaged") +<br/>  ylab("Percentage (%)") +<br/>  theme(plot.title = element_text(hjust = 0.5)) </pre>
<p>The plot looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1211 image-border" src="assets/be920818-b631-4019-9ac3-09be8d7da43f.png" style="width:33.08em;height:26.92em;"/></p>
<p>As you can see from these results, the majority of the customers did not respond to the marketing calls. As shown from the data, only about 14% of the customers responded to the marketing calls. We are going to now dive deeper into the customers who responded and get a better understanding of what worked best for them.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Engagement rates by offer type</h1>
                </header>
            
            <article>
                
<p>Different types of offers will work differently for different customers. In this section, we are going to look into what types of offers worked best for the engaged customers. Take a look at the following code:</p>
<pre>## - Engagement Rates by Offer Type ##<br/>engagementRateByOfferType &lt;- df %&gt;% <br/>  group_by(Renew.Offer.Type) %&gt;%<br/>  summarise(Count=n(), NumEngaged=sum(Engaged)) %&gt;%<br/>  mutate(EngagementRate=NumEngaged/Count*100.0)</pre>
<p>As you can see from this code, we are grouping by the <kbd>Renew.Offer.Type</kbd>  column, where we have four different types of offers. Then, in the <kbd>summarise</kbd> function, we count the total number of records using the <kbd>n()</kbd> function, and we count the number of engaged customers by summing over the encoded column, <kbd>Engaged</kbd>. Lastly, in the <kbd>mutate</kbd> function, we compute <kbd>EngagementRate</kbd> by dividing <kbd>NumEngaged</kbd> by <kbd>Count</kbd> and multiplying it by <kbd>100.0</kbd>.</p>
<p>The result looks as in the following:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1212 image-border" src="assets/5a4e6b82-dd04-41d9-8fec-16cc97cedf30.png" style="width:20.42em;height:5.08em;"/></p>
<p>We can visualize these results in a bar plot, using the following code:</p>
<pre>ggplot(engagementRateByOfferType, aes(x=Renew.Offer.Type, y=EngagementRate)) +<br/>  geom_bar(width=0.5, stat="identity") +<br/>  ggtitle('Engagement Rates by Offer Type') +<br/>  xlab("Offer Type") +<br/>  ylab("Engagement Rate (%)") +<br/>  theme(plot.title = element_text(hjust = 0.5)) </pre>
<p>The bar plot now looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1213 image-border" src="assets/8f482d83-3bc8-459a-bb62-6f432933a81a.png" style="width:25.67em;height:21.42em;"/></p>
<p>As you can easily notice from this plot,<span> </span><kbd>Offer 2</kbd><span> </span>had the highest engagement rate among the customers. When conducting customer analytics, as discussed earlier, we often want to know the demographics and attributes of customers for each event, so that we can understand what works best for which type of customers. This can lead to further improvements in the next marketing campaign by better targeting those subgroups of customers. Let's take a step further into this data.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Engagement rates by offer type and vehicle class</h1>
                </header>
            
            <article>
                
<p>In the previous section, we have learned that<span> </span><kbd>Renewal Offer Type 2</kbd><span> </span>worked best for the customers. The marketers can benefit from this information itself, as this finding provides a useful insight into which type of offer worked best and had the highest response rate from customers. However, we can gain more insights on how different customers with different backgrounds or characteristics react differently to each offer types. In this section, we will show an example of what you can do as a marketer to understand how customers with different attributes respond differently to different marketing messages.</p>
<p>Let's see whether there is any noticeable difference in the response rates for each offer type for customers with different vehicle classes. We are going to look at the engagement rates by each offer type and vehicle class, using the following code:</p>
<pre>## - Offer Type &amp; Vehicle Class ##<br/>engagementRateByOfferTypeVehicleClass &lt;- df %&gt;% <br/>  group_by(Renew.Offer.Type, Vehicle.Class) %&gt;%<br/>  summarise(NumEngaged=sum(Engaged)) %&gt;%<br/>  left_join(engagementRateByOfferType[,c("Renew.Offer.Type", "Count")], by="Renew.Offer.Type") %&gt;%<br/>  mutate(EngagementRate=NumEngaged/Count*100.0)</pre>
<p>As you can see from this code, we are grouping the data by two columns,<span> </span><kbd>Renew.Offer.Type</kbd><span> </span>and<span> </span><kbd>Vehicle.Class</kbd>, and counting the number of engaged customers for each group. Then, we join this data with the <kbd>engagementRateByOfferType</kbd> variable by the <kbd>Renew.Offer.Type</kbd> column to get the total number of engaged customers for each offer type. Lastly, we compute the engagement rate in the <kbd>mutate</kbd> function.</p>
<p>The result looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1214 image-border" src="assets/9035c50e-b457-4a6e-9090-26d64ae45a4c.png" style="width:36.67em;height:36.67em;"/></p>
<p>To make this more readable, we can visualize this data using bar plots. Take a look at the following code:</p>
<pre>ggplot(engagementRateByOfferTypeVehicleClass, aes(x=Renew.Offer.Type, y=EngagementRate, fill=Vehicle.Class)) +<br/>  geom_bar(width=0.5, stat="identity", position = "dodge") +<br/>  ggtitle('Engagement Rates by Offer Type &amp; Vehicle Class') +<br/>  xlab("Offer Type") +<br/>  ylab("Engagement Rate (%)") +<br/>  theme(plot.title = element_text(hjust = 0.5)) </pre>
<p><span>Using this code, we can build a bar plot that looks as follows:</span></p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1215 image-border" src="assets/fcbb8d90-9491-454f-86cb-671af0b8eaeb.png" style="width:33.75em;height:28.17em;"/></p>
<p>Let's take a closer look at this chart. We have seen that <kbd>Offer2</kbd><span> </span>had the highest response rate among the customers in the previous section. Here, we can see how customers with different vehicle classes engage differently with other types of renewal offers. For example, customers with<span> </span><kbd>Four-Door Car</kbd><span> </span>respond the most frequently for all offer types. However, customers with<span> </span><kbd>SUV</kbd><span> </span>respond with a higher chance to <kbd>Offer1</kbd> than to <kbd>Offer2</kbd>. As you can see from these results, we can gain more insights by breaking down the customer demographics further. If we see any significant difference in the response rates among different customer segments, we can fine-tune who to target for different sets of offers. In our example, if we believe customers with<span> </span><kbd>SUV</kbd><span> </span>respond to<span> </span><kbd>Offer1</kbd><span> </span>with a significantly higher chance than to<span> </span><kbd>Offer2</kbd>, then we can target<span> </span><kbd>SUV</kbd><span> </span>customers with<span> </span><kbd>Offer1</kbd>. On the other hand, if we believe customers with<span> </span><kbd>Two-Door Car</kbd><span> </span>respond to<span> </span><kbd>Offer2</kbd><span> </span>with a significantly higher chance than to other offer types, then we can target<span> </span><kbd>Two-Door Car</kbd><span> </span>owners with<span> </span><kbd>Offer2</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Engagement rates by sales channel</h1>
                </header>
            
            <article>
                
<p>Let's take a look at another example. We will analyze how engagement rates differ by different sales channels. Take a look at the following code:</p>
<pre>## - Engagement Rates by Sales Channel ##<br/>engagementRateBySalesChannel &lt;- df %&gt;% <br/>  group_by(Sales.Channel) %&gt;%<br/>  summarise(Count=n(), NumEngaged=sum(Engaged)) %&gt;%<br/>  mutate(EngagementRate=NumEngaged/Count*100.0)</pre>
<p>The result looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1216 image-border" src="assets/ebbba6a4-96a6-4acb-8d62-3b079deb960b.png" style="width:28.50em;height:7.42em;"/></p>
<p>It will be easier to understand this result with a visualization. You can use the following code to visualize this data:</p>
<pre>ggplot(engagementRateBySalesChannel, aes(x=Sales.Channel, y=EngagementRate)) +<br/>  geom_bar(width=0.5, stat="identity") +<br/>  ggtitle('Engagement Rates by Sales Channel') +<br/>  xlab("Sales Channel") +<br/>  ylab("Engagement Rate (%)") +<br/>  theme(plot.title = element_text(hjust = 0.5)) </pre>
<p>The plot looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1217 image-border" src="assets/f8d131db-9772-4dfa-a8a3-c688bc8012e5.png" style="width:35.25em;height:28.58em;"/></p>
<p><span>As you can see from this plot, <kbd>Agent</kbd> works best in terms of getting responses from the customers. Then, sales through <kbd>Web</kbd> works the second best. As before, let's break down this result deeper and analyze it to see whether the behavior changes among customers with different characteristics.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Engagement rates by sales channel and vehicle size</h1>
                </header>
            
            <article>
                
<p>In this section, we will take a look at whether customers with various vehicle sizes respond differently to different sales channels. Take a look at the following code to compute the engagement rates per sales channel and vehicle size:</p>
<pre>## - Sales Channel &amp; Vehicle Size ##<br/>engagementRateBySalesChannelVehicleSize &lt;- df %&gt;% <br/>  group_by(Sales.Channel, Vehicle.Size) %&gt;%<br/>  summarise(NumEngaged=sum(Engaged)) %&gt;%<br/>  left_join(engagementRateBySalesChannel[,c("Sales.Channel", "Count")], by="Sales.Channel") %&gt;%<br/>  mutate(EngagementRate=NumEngaged/Count*100.0)</pre>
<p>The result looks as in the following:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1218 image-border" src="assets/ab0cb4cb-5593-42e6-bcbb-11fedf3e33c7.png" style="width:41.50em;height:23.00em;"/></p>
<p>As before, we can visualize this data in a bar plot to make it easier to read. You can use the following code to visualize this data:</p>
<pre>ggplot(engagementRateBySalesChannelVehicleSize, aes(x=Sales.Channel, y=EngagementRate, fill=Vehicle.Size)) +<br/>  geom_bar(width=0.5, stat="identity", position = "dodge") +<br/>  ggtitle('Engagement Rates by Sales Channel &amp; Vehicle Size') +<br/>  xlab("Sales Channel") +<br/>  ylab("Engagement Rate (%)") +<br/>  theme(plot.title = element_text(hjust = 0.5)) </pre>
<p>The plot now looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1219 image-border" src="assets/7a7d9766-077a-408c-bee1-f99e71666807.png" style="width:34.33em;height:28.25em;"/></p>
<p>As you can see from this plot, customers with<span> </span><kbd>Medsize</kbd><span> </span>vehicles respond best to all sales channels. The engagement rates across different sales channels differ slightly between<span> </span><kbd>Large</kbd><span> </span>and<span> </span><kbd>Small</kbd><span> </span>vehicle owners. For example,<span> </span><kbd>Small</kbd><span> </span>vehicle owners respond better through<span> </span><kbd>Agent</kbd><span> </span>and<span> </span><kbd>Call Center</kbd><span> </span>channels, while on the other hand,<span> </span><kbd>Large</kbd><span> </span>vehicle owners respond better through the<span> </span><kbd>Branch</kbd><span> </span>and<span> </span><kbd>Web</kbd><span> </span>channels. As discussed previously, we can utilize this insight in the next marketing efforts. For example, as<span> </span><kbd>Small</kbd><span> </span>car owners respond with a higher degree of engagement through<span> </span><kbd>Agent</kbd><span> </span>and<span> </span><kbd>Call Center</kbd>, we can utilize those two channels more heavily for<span> </span><kbd>Small</kbd><span> </span>car owners.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Segmenting customer base</h1>
                </header>
            
            <article>
                
<p>We are going to briefly discuss how we can segment the customer base in this section. We are going to expand this concept and discuss further how we can utilize machine learning for customer segmentation in <a href="9b3d36ba-d690-491c-9a6f-b8c00f59cfb4.xhtml" target="_blank">Chapter 9</a>, <em>Customer Lifetime Value</em>, but this section will give you some basic ideas on what customer segmentation is and what it looks like.</p>
<p>In this section, we will be segmenting our customer base by <kbd>Customer.Lifetime.Value</kbd><span> </span>and<span> </span><kbd>Months.Since.Policy.Inception</kbd>. Feel free to try different features for segmenting the customer base. Let's first take a look at the following distribution of the <kbd>Customer.Lifetime.Value</kbd> column:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1221 image-border" src="assets/1c7412fa-3581-4066-b761-2830664bdb3f.png" style="width:25.50em;height:4.00em;"/></p>
<ul>
<li><span>Based on this information, we are going to define custom</span>ers with a CLV higher than the median as high-CLV customers and those with a CLV below the median as low-CLV customers. You can <span>use the following code for encoding:</span></li>
</ul>
<pre>clv_encode_fn &lt;- function(x) {if(x &gt; median(df$Customer.Lifetime.Value)) "High" else "Low"}<br/>df$CLV.Segment &lt;- sapply(df$Customer.Lifetime.Value, clv_encode_fn)</pre>
<p>As you can see from this code, we have defined the <kbd>clv_encode_fn</kbd> function, which encodes those customers with a CLV higher than the median as <kbd>High</kbd> and those with a CLV lower than the median as <kbd>Low</kbd>. Then, using the <kbd>sapply</kbd> function, we encode the values in the <kbd>Customer.Lifetime.Value</kbd> column and store those encoded values as a new column named <kbd>CLV.Segment</kbd>.</p>
<p>We are going to go through the same process for the <kbd>Months.Since.Policy.Inception</kbd> field. Take a look at the following distribution for<span> </span><kbd>Months.Since.Policy.Inception</kbd>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1222 image-border" src="assets/fb159b82-5b9b-483e-97f6-94b144ea0cec.png" style="width:27.08em;height:4.25em;"/></p>
<p>Similarly, <span>we are going to define those customers with a </span><kbd>Months.Since.Policy.Inception</kbd><span> value higher than the median as high <kbd>Policy.Age.Segment</kbd> customers and those with a value below the median as low <kbd>Policy.Age.Segment</kbd> customers. You can use the following code for encoding:</span></p>
<pre>policy_age_encode_fn &lt;- function(x) {if(x &gt; median(df$Months.Since.Policy.Inception)) "High" else "Low"}<br/>df$Policy.Age.Segment &lt;- sapply(df$Months.Since.Policy.Inception, policy_age_encode_fn)</pre>
<p>We can visualize these segments, using the following code:</p>
<pre>ggplot(<br/>  df[which(df$CLV.Segment=="High" &amp; df$Policy.Age.Segment=="High"),], <br/>  aes(x=Months.Since.Policy.Inception, y=log(Customer.Lifetime.Value))<br/>) +<br/>  geom_point(color='red') +<br/>  geom_point(<br/>    data=df[which(df$CLV.Segment=="High" &amp; df$Policy.Age.Segment=="Low"),], <br/>    color='orange'<br/>  ) +<br/>  geom_point(<br/>    data=df[which(df$CLV.Segment=="Low" &amp; df$Policy.Age.Segment=="Low"),], <br/>    color='green'<br/>  ) +<br/>  geom_point(<br/>    data=df[which(df$CLV.Segment=="Low" &amp; df$Policy.Age.Segment=="High"),], <br/>    color='blue'<br/>  ) +<br/>  ggtitle('Segments by CLV and Policy Age') +<br/>  xlab("Months Since Policy Inception") +<br/>  ylab("CLV (in log scale)") +<br/>  theme(plot.title = element_text(hjust = 0.5)) </pre>
<p>Let's take a closer look at this code. We plot the High <kbd>CLV</kbd> and High <kbd>Policy Age</kbd> segment first in red. Then, we repeat the same process to building scatter plots for the High <kbd>CLV</kbd> and Low <kbd>Policy Age</kbd> group in orange, the Low <kbd>CLV</kbd> and Low <kbd>Policy Age</kbd> group in green, and lastly, the Low <kbd>CLV</kbd> and High <kbd>Policy Age</kbd> group in blue. One thing to note here is how we define the <kbd>y</kbd> values in the <kbd>aes</kbd> function. As you can see from this code, <kbd>y=log(Customer.Lifetime.Value)</kbd>, we are transforming the CLV values into log scale. Log scale is often used for monetary values, as they often have high skewness in their values.</p>
<p>The resulting scatter plot looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1223 image-border" src="assets/bae4fa4d-8a79-4fc1-bbb5-7c5105c06f77.png" style="width:33.83em;height:28.25em;"/></p>
<p><span>As you can see from this scatter plot, the data points in red represent those customers in the <kbd>High CLV</kbd> and <kbd>High Policy Age</kbd> segment. Those in orange represent the <kbd>High CLV</kbd> and <kbd>Low Policy Age</kbd> group, those in blue represent the <kbd>Low CLV</kbd> and <kbd>High Policy Age</kbd> group, and lastly, those in green represent the <kbd>Low CLV</kbd> and <kbd>Low Policy Age</kbd> group. </span></p>
<p><span>Now that we have created these four segments, let's see whether there is any noticeable difference in engagement rates among these four segments. Take a look at the following code:</span></p>
<pre>engagementRateBySegment &lt;- df %&gt;% <br/>  group_by(CLV.Segment, Policy.Age.Segment) %&gt;%<br/>  summarise(Count=n(), NumEngaged=sum(Engaged)) %&gt;%<br/>  mutate(EngagementRate=NumEngaged/Count*100.0)</pre>
<p>As you can see from this code, we are grouping by the two newly-created columns,<span> </span><kbd>CLV.Segment</kbd><span> </span>and<span> </span><kbd>Policy.Age.Segment</kbd>,<span> </span>and computing the engagement rates for these four segments. The result looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1224 image-border" src="assets/4537f69b-2617-4b3b-b376-d86cb5b0e817.png" style="width:41.17em;height:8.08em;"/></p>
<p>It will be easier to understand the differences in a chart. You can use the following code to create a bar plot for this data:</p>
<pre>ggplot(engagementRateBySegment, aes(x=CLV.Segment, y=EngagementRate, fill=Policy.Age.Segment)) +<br/>  geom_bar(width=0.5, stat="identity", position = "dodge") +<br/>  ggtitle('Engagement Rates by Customer Segments') +<br/>  ylab("Engagement Rate (%)") +<br/>  theme(plot.title = element_text(hjust = 0.5)) </pre>
<p>Now the plot looks as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1225 image-border" src="assets/2596b8f1-3a46-4dc5-acb0-1946a0023dec.png" style="width:33.17em;height:27.08em;"/></p>
<p>As you can notice from this plot, <kbd>High Policy.Age.Segment</kbd><span> </span>has a higher engagement than <kbd>Low Policy.Age.Segment</kbd>. This suggests that those customers who have been insured by this company longer respond better. It is also noticeable that the<span> </span><kbd>High Policy Age</kbd><span> </span>and<span> </span><kbd>Low CLV</kbd><span> </span>segment has the highest engagement rate among the four segments. By creating different customer segments based on customer attributes, we can better understand how different groups of customers behave differently. We are going to further expand and experiment the concept of customer segmentation <span>in</span><span> </span><span>more depth in</span> <a href="9b3d36ba-d690-491c-9a6f-b8c00f59cfb4.xhtml" target="_blank">Chapter 9</a><span>,</span> <em>Customer Lifetime Value</em><span>.</span></p>
<div class="packt_infobox">The full code for this R exercise can be found at the following link: <a href="https://github.com/yoonhwang/hands-on-data-science-for-marketing/blob/master/ch.7/R/CustomerBehaviors.R">https://github.com/yoonhwang/hands-on-data-science-for-marketing/blob/master/ch.7/R/CustomerBehaviors.R</a>.<a href="https://github.com/yoonhwang/hands-on-data-science-for-marketing/blob/master/ch.7/R/CustomerBehaviors.R"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we have discussed customer analytics. We have learned about what customer analytics is and the importance and benefits of conducting customer analytics, as well as different use cases of customer analytics. We have discussed how the rising accessibility of customer data to businesses and the abundance of data available about customers is resulting in higher competition, and we emphasized the importance of having a good understanding of what customers like. Conducting customer analytics is an important step to gain insights on the behavior of customers, which helps in forming better marketing strategies, <span>optimizing sales channels, and making other key business decisions. Using customer analytics, you can monitor and track KPIs on how customers react to different products and marketing strategies, effectively build segments of similar customers, and build predictive models to improve engagement and retention rates, as well as optimize marketing channels.</span></p>
<p>In the next chapter, we are going to learn how we can use predictive analytics to forecast the likelihood of marketing engagements. We will discuss some of the machine learning algorithms that are frequently used to build predictive models and experiment with their prediction performances on the dataset.</p>


            </article>

            
        </section>
    </body></html>